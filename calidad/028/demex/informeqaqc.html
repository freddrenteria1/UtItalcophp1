<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QAQC - UT ITALCO</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
        integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous" />

    <script src="weldbook/jquery.min.js"></script>
    <script src="weldbook/jquery-ui.min.js"></script>
    <script src="weldbook/jquery.jqGrid.min.js"></script>
    <script src="weldbook/grid.locale-en.js"></script>
    <link rel="stylesheet" href="weldbook/jquery-ui.css" />
    <link rel="stylesheet" href="weldbook/ui.jqgrid_4.min.css" />
    <!-- <link rel="stylesheet" href="ui.jqgrid.css"> -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat+Alternates:wght@100;500;700&family=Roboto:wght@100;300;400;500&display=swap"
        rel="stylesheet" />

    <script type="text/javascript" src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/highcharts-3d.js"></script>
    <script src="https://code.highcharts.com/modules/cylinder.js"></script>
    <script src="https://code.highcharts.com/modules/funnel3d.js"></script>
    <script src="https://code.highcharts.com/modules/pyramid3d.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.2.61/jspdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.svg.js"></script>




    <style>
        .ui-th-div {
            vertical-align: top !important;
        }

        .ui-jqgrid-title {
            vertical-align: top;
        }

        body {
            /* background-image: url("img/fondo.jpg");
            background-size: cover;
            background-repeat: no-repeat;
            background-attachment: fixed; */
            height: 100hv;
            font-family: "Montserrat Alternates", sans-serif;
            font-family: "Roboto", sans-serif;
            font-weight: normal;
        }

        video {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            object-fit: cover;
            z-index: -9999;
        }

        .cab {
            margin-top: 30px;
            background-color: rgb(218, 255, 255);
            padding: 20px;
            border-radius: 15px;
        }

        .titulop {
            padding: 15px;
            padding-top: 20px;
            align-items: center;
            vertical-align: middle;
            text-align: center;
        }

        .mnubotones {
            position: relative;
        }

        .cajones {
            float: left;
            margin: 10px;
        }

        .mbt {
            height: 100px;
        }

        .card {
            box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
            width: 21rem;
        }

        .cuerpo {
            position: relative;
            margin-top: 20px;
            border-radius: 10px;
            background-color: rgb(243, 243, 243);
            padding: 15px;
        }

        .padre {
            display: flex;
            align-items: center;
        }

        .micontainer {
            margin: 0 auto;
            width: 97%;
        }

        table thead td {
            vertical-align: middle;
        }

        th.ui-th-column {
            border-width: 1px;
            border-style: solid;
            border-color: #b1b1b1;
        }

        @media only screen and (max-width: 600px) {
            .mnubotones {
                margin-top: 30px;
                display: block;
                justify-content: center;
                align-items: center;
            }

            .card {
                box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="#"><img src="img/logo_m.png" width="100px" alt="" /></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <h5>
                    INFORME DIARIO DE AVANCE DE QA/QC ODS 028 VISCORREDUCTORA - DEMEX
                    <br />
                    Fecha Informe: <span id="fecha"></span> | Fecha de Corte

                    <input type="date" id="fechac" placeholder="Fecha">
                    <button id="export" onclick="cargarFecha()" class="btn btn-success">Cargar Datos</button>
                </h5>
            </div>
        </div>
    </nav>

    <div class="micontainer">
        <div class="cuerpo">


            <div class="card-header bg-primary text-center mt-2" style="color: #fff">
                <h5>AVANCE DIARIO JUNTAS Y PULGADAS DIAMETRALES</h5>
            </div>
            <div class="card-header bg-info">
                U-2500 DEMEX
            </div>

            <div class="mt-2" id="fig5">
                <h5>Total Juntas Realizadas | <span id="totjuntasDemex"></span> | Total Pulgadas Realizadas | <span
                        id="totpulgDemex"></span>
                    | # Soldadores | <span id="cantsoldDemex"></span>
                    | Rendimiento por Soldador | <span id="rendDemex"></span> |
                </h5>
                <hr>
            </div>
            <div class="mt-2">
                <h4>Resumen por Especialidad</h4>
                <table class="table table-striped" id="tabla10"></table>
            </div>
            <div class="mt-2">
                <h4>Resumen por Equipo</h4>
                <table class="table table-striped" id="tabla11"></table>
            </div>

            <div class="card-header bg-info">
                U-2800 VISCORREDUCTORA
            </div>

            <div class="mt-2" id="fig6">
                <h5>Total Juntas Realizadas | <span id="totjuntasVisco"></span> | Total Pulgadas Realizadas | <span
                        id="totpulgVisco"></span>
                    | # Soldadores | <span id="cantsoldVisco"></span>
                    | Rendimiento por Soldador | <span id="rendVisco"></span> |
                </h5>
                <hr>
            </div>
            <div class="mt-2">
                <h4>Resumen por Especialidad</h4>
                <table class="table table-striped" id="tabla12"></table>
            </div>
            <div class="mt-2">
                <h4>Resumen por Equipo</h4>
                <table class="table table-striped" id="tabla13"></table>
            </div>

            <div class="card-header bg-primary text-center mt-2" style="color: #fff">
                <h5>INFORME DE SOLDADURA</h5>
            </div>
            <div class="card-header bg-info">
                JUNTAS SOLDADAS Y PULGADAS DIAMETRALES POR EQUIPOS U-2500 DEMEX


            </div>
            <div class="mt-2">
                <table class="table table-striped" id="tablaSold"></table>

            </div>

            <div class="row">
                <div class="col-sm-8">
                    <div class="mt-2" id="figsoldDemex">

                    </div>
                </div>

                <div class="col-sm-4">
                    <div class="mt-2" id="figavancediarioDemex">

                    </div>
                </div>
            </div>

            <div class="card-header bg-info">
                JUNTAS SOLDADAS Y PULGADAS DIAMETRALES POR EQUIPOS U-2800
                VISCORREDUCTORA
            </div>
            <div class="mt-2">
                <table class="table table-striped" id="tabla8"></table>

            </div>



            <div class="card-header bg-primary text-center" style="color: #fff">
                <h5>SEGUIMIENTO PUNTOS DE INSPECCIÓN</h5>
            </div>
            <!-- <div class="card-header bg-info">U-2500 DEMEX</div>

            <div class="mt-2" id="fig1"></div>
            <div class="mt-2">
                <table class="table table-striped" id="tabla1"></table>
            </div> -->

            <div class="card-header bg-info mt-2">U-2800 VISCORREDUCTORA</div>

            <div class="mt-2" id="fig2"></div>
            <div class="mt-2">
                <table class="table table-striped" id="tabla2"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notaccpuntosvisco"> </span>
                <hr>
            </div>

            <div class="card-header bg-primary text-center mt-2" style="color: #fff">
                <h5>SEGUIMIENTO LAZOS DE CORROSIÓN</h5>
            </div>

            <div class="card-header bg-info">U-2500 DEMEX</div>

            <div class="mt-2" id="fig8"></div>
            <div class="mt-2">
                <table class="table table-striped" id="tabla15"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notacclazosdemex"> </span>
                <hr>
            </div>

            <div class="card-header bg-info">U-2800 VISCORREDUCTORA</div>

            <div class="mt-2" id="fig3"></div>
            <div class="mt-2">
                <table class="table table-striped" id="tabla3"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notacclazosvisco"> </span>
                <hr>
            </div>

            <div class="card-header bg-primary text-center mt-2" style="color: #fff">
                <h5>SEGUIMIENTO MISCELANEOS</h5>
            </div>

            <div class="card-header bg-info">U-2500 DEMEX</div>

            <div class="mt-2" id="fig9"></div>
            <div class="mt-2">
                <table class="table table-striped" id="tabla16"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notaccmiscdemex"> </span>
                <hr>
            </div>




            <div class="card-header bg-primary text-center mt-2" style="color: #fff">
                <h5>SEGUIMIENTO DE EQUIPOS ESTÁTICOS</h5>
            </div>


            <div class="card-header bg-info mt-2">VÁLVULAS DE SEGURIDAD U-2500 DEMEX</div>

            <div class="mt-2" id="fig10"></div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla17"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notaccvalvulasdemex"> </span>
                <hr>
            </div>

            <div class="card-header bg-info mt-2">VÁLVULAS DE SEGURIDAD U-2800 VISCORREDUCTORA II</div>

            <div class="mt-2" id="fig11"></div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla18"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notaccvalvulasvisco"> </span>
                <hr>
            </div>

            <div class="card-header bg-info mt-2">TORRES U-2500 DEMEX</div>

            <div class="mt-2" id="fig12"></div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla19"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notatorresdemex"> </span>
                <hr>
            </div>

            <div class="card-header bg-info mt-2">TORRES U-2800 VISCORREDUCTORA II </div>

            <div class="mt-2" id="fig13"></div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla20"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notatorresvisco"> </span>
                <hr>
            </div>




            <div class="card-header bg-info mt-2">TAMBORES U-2500 DEMEX</div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla5"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notacctamboresdemex"> </span>
                <hr>
            </div>

            <div class="card-header bg-info mt-2">TAMBORES U-2800 VISCORREDUCTORA II</div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla6"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notacctamboresvisco"> </span>
                <hr>
            </div>

            <div class="card-header bg-info">
                INDICADORES DE NIVEL LG U-2500 DEMEX
            </div>

            <div class="mt-2">
                <table class="table table-striped" id="tablalg"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notacclgsdemex"> </span>
                <hr>
            </div>

            <div class="card-header bg-info">
                INDICADORES DE NIVEL LG U-2800 VISCORREDUCTORA
            </div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla7"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notacclgsvisco"> </span>
                <hr>
            </div>

            <div class="card-header bg-info">RESÚMEN INTERCAMBIADORES U-2500 DEMEX</div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla4"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notainterdemex"> </span>
                <hr>
            </div>

            <div class="card-header bg-info">RESÚMEN INTERCAMBIADORES U-2800 VISCORREDUCTORA II </div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla21"></table>

                <hr>
                <b>NOTAS: </b>
                <span id="notaintervisco"> </span>
                <hr>
            </div>

            <div class="card-header bg-info">HORNOS U-2500 DEMEX</div>

            <div class="mt-2">
                <table class="table table-striped" id="tablaHD"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notahornosdemex"> </span>
                <hr>
            </div>





            <div class="card-header bg-primary text-center mt-2" style="color: #fff">
                <h5>INFORME DE BRIDAS</h5>
            </div>

            <div class="card-header bg-info">
                U-2500 DEMEX
            </div>

            <div class="mt-2" id="fig7"></div>
            <div class="mt-2">
                <table class="table table-striped" id="tabla14"></table>
                <hr>
                <b>NOTAS: </b>
                <span id="notaccbridasdemex"> </span>
                <hr>
            </div>

            <div class="card-header bg-info">
                U-2800 VISCORREDUCTORA
            </div>

            <div class="mt-2" id="fig4"></div>
            <div class="mt-2">
                <table class="table table-striped" id="tabla9"></table>
            </div>


            <div class="card-header bg-primary text-center mt-2" style="color: #fff">
                <h5>RECOMENDACIONES TÉCNICAS </h5>
            </div>

            <div class="card-header bg-info">
                U-2500 DEMEX
            </div>


            <div class="mt-2">
                <div class="row">
                    <div class="col-sm-12">
                        <table class="table table-striped" id="tabla22"></table>
                    </div>
                    <div class="col-sm-6 mt-2">
                        <h4>Estado por RT</h4>
                        <table class="table table-striped" id="tabla23"></table>
                    </div>
                    <div class="col-sm-6 mt-2">
                        <h4>Estado por Diagnóstico</h4>
                        <table class="table table-striped" id="tabla24"></table>
                    </div>
                </div>
            </div>

            <div class="mt-2" id="fig14"></div>
            <div class="mt-2" id="fig15"></div>

            <hr>
            <b>NOTAS: </b>
            <span id="notaccrtdemex"> </span>
            <hr>


            <div class="card-header bg-info">
                U-2800 VISCORREDUCTORA II
            </div>


            <div class="mt-2">
                <div class="row">
                    <div class="col-sm-12">
                        <table class="table table-striped" id="tabla25"></table>
                    </div>
                    <div class="col-sm-6 mt-2">
                        <h4>Estado por RT</h4>
                        <table class="table table-striped" id="tabla26"></table>
                    </div>
                    <div class="col-sm-6 mt-2">
                        <h4>Estado por Diagnóstico</h4>
                        <table class="table table-striped" id="tabla27"></table>
                    </div>
                </div>
            </div>

            <div class="mt-2" id="fig16"></div>
            <div class="mt-2" id="fig17"></div>






        </div>
    </div>

    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous">
        </script>
    <script type="text/javascript" language="javascript"
        src="//cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"></script>

    <script>
        var odsq = null;
        var datos = [];
        var url = "https://utitalco.com/calidad/028/demex/weldbook/server/";

        var user = sessionStorage.getItem("usercal");
        var tipouser = sessionStorage.getItem("tipouser");

        var arrayFechas = []
        var arrayProg = []
        var arrayEje = []

        var arrayProgAcum = null
        var arrayEjeAcum = null

        var ventana_ancho = $(window).width();
        var ventana_alto = $(window).height();
        ventana_ancho = ventana_ancho - 80;
        ventana_alto = ventana_alto - 220;

        var esp = []
        var est1 = []
        var est2 = []
        var est3 = []
        var est4 = []
        var stot = []



        if (ventana_ancho > 1300) {
            ventana_alto = ventana_alto - 220;
        } else {
            ventana_alto = 330;
        }

        let date = new Date();
        let output =
            String(date.getDate()).padStart(2, "0") +
            "-" +
            String(date.getMonth() + 1).padStart(2, "0") +
            "-" +
            date.getFullYear();

        let outputf =
            date.getFullYear() +
            "-" +
            String(date.getMonth() + 1).padStart(2, "0") +
            "-" +
            String(date.getDate()).padStart(2, "0");




        $("#fecha").html(output);

        var fechab = sessionStorage.getItem('fechab');


        if (fechab == null) {
            fechab = outputf;
        }

        var fechabuscar = fechab


        $('#fechac').val(fechab)

        //cargarDatos();

        function cargando() {
            let timerInterval;
            Swal.fire({
                title: "Cargando indicadores...!",
                timer: 120000,
                timerProgressBar: true,
                didOpen: () => {
                    Swal.showLoading();
                    const b = Swal.getHtmlContainer().querySelector("b");
                    timerInterval = setInterval(() => {
                        // b.textContent = Swal.getTimerLeft()
                    }, 100);
                },
                willClose: () => {
                    clearInterval(timerInterval);
                },
            }).then((result) => {
                /* Read more about handling dismissals below */
                if (result.dismiss === Swal.DismissReason.timer) {
                    console.log("I was closed by the timer");
                }
            });
        }

        function cargandoPag() {
            let timerInterval;
            Swal.fire({
                title: "Procesando datos...!",
                timer: 120000,
                timerProgressBar: true,
                didOpen: () => {
                    Swal.showLoading();
                    const b = Swal.getHtmlContainer().querySelector("b");
                    timerInterval = setInterval(() => {
                        // b.textContent = Swal.getTimerLeft()
                    }, 100);
                },
                willClose: () => {
                    clearInterval(timerInterval);
                },
            }).then((result) => {
                /* Read more about handling dismissals below */
                if (result.dismiss === Swal.DismissReason.timer) {
                    console.log("I was closed by the timer");
                }
            });
        }

        //cargarInformePuntosDemex();
        cargarInformePuntosVisco();
        cargarInformeLazosVisco();
        cargarInformeLazosDemex();
        cargarInformeInterDemex();
        cargarInformeInterVisco()
        cargarInformeTamboresDemex();
        cargarInformeTamboresVisco()
        cargarInformeLgsDemex()
        cargarInformeLgsVisco();
        cargarInformeSoldaduraEquiposDemex();
        cargarInformeSoldaduraEquiposVisco();
        cargarInformeBridasVisco()
        cargarInformeBridasDemex()
        cargarAvanceDiarioDemex()
        cargarAvanceDiarioVisco()
        cargarInformeHornosDemex()
        cargarInformeMiscDemex()
        cargarInformeValvulasDemex()
        cargarInformeValvulasVisco()
        cargarInformeTorresDemex()
        cargarInformeTorresVisco()
        cargarInformeRTDemex()
        cargarInformeRTVisco()
        cargarNotasDemex()
        cargarNotasVisco()
        cargarInformeSoldaduraDemex()

        function cargarNotasDemex() {
            $.post(
                "https://utitalco.com/calidad/028/demex/weldbook/server/cargarNotas.php", { fecha: fechabuscar },
                function (resp) {
                    console.log('NOTAS::::::::::::::::::::::::::::::')
                    console.log(resp)
                    if (resp != null) {
                        for (var i = 0; i < resp.length; i++) {
                            if (resp[i].cuadro == 'ccinter') {
                                $('#notainterdemex').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'ccbridas') {
                                $('#notaccbridasdemex').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'ccpuntos') {
                                $('#notaccpuntosdemex').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'cclazos') {
                                $('#notacclazosdemex').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'ccmisc') {
                                $('#notaccmiscdemex').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'ccrt') {
                                $('#notaccrtdemex').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'cctambores') {
                                $('#notacctamboresdemex').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'cctorres') {
                                $('#notatorresdemex').html(resp[i].nota)
                            }

                            if (resp[i].cuadro == 'cchornos') {
                                $('#notahornosdemex').html(resp[i].nota)
                            }

                            if (resp[i].cuadro == 'cclgs') {
                                $('#notacclgsdemex').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'ccvalvulas') {
                                $('#notaccvalvulasdemex').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'general') {
                                $('#notageneral').html(resp[i].nota)
                            }
                        }

                    }
                })
        }

        function cargarNotasVisco() {
            $.post(
                "https://utitalco.com/calidad/028/vbk/weldbook/server/cargarNotas.php", { fecha: fechabuscar },
                function (resp) {
                    console.log('NOTAS::::::::::::::::::::::::::::::')
                    console.log(resp)
                    if (resp != null) {
                        for (var i = 0; i < resp.length; i++) {




                            if (resp[i].cuadro == 'ccinter') {
                                $('#notaintervisco').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'ccbridas') {
                                $('#notaccbridasvisco').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'ccpuntos') {
                                $('#notaccpuntosvisco').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'cclazos') {
                                $('#notacclazosvisco').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'ccmisc') {
                                $('#notaccmiscvisco').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'ccrt') {
                                $('#notaccrtvisco').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'cctambores') {
                                $('#notacctamboresvisco').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'cctorres') {
                                $('#notatorresvisco').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'cclgs') {
                                $('#notacclgsvisco').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'ccvalvulas') {
                                $('#notaccvalvulasvisco').html(resp[i].nota)
                            }
                            if (resp[i].cuadro == 'general') {
                                $('#notageneral').html(resp[i].nota)
                            }
                        }

                    }
                })
        }

        function cargarFecha() {
            fechabuscar = $('#fechac').val()
            sessionStorage.setItem('fechab', fechabuscar)
            location.reload()
        }

        function cargarInformePuntosDemex() {
            cargandoPag();
            $.post(
                "https://utitalco.com/calidad/028/demex/weldbook/server/repCCPuntos.php",
                function (resp) {
                    datos = resp;

                    $("#tabla1").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: datos,
                        colModel: [{
                            name: "lazo",
                            label: "LAZO CORROSIÓN",
                            width: 120,
                        },
                        {
                            name: "isometrico",
                            label: "ISOMETRICO",
                            width: 90,
                        },
                        {
                            name: "cmls",
                            label: "CML'S",
                            width: 50,
                            align: "center",
                        },

                        {
                            name: "limpiezaprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "limpiezaeje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "alimpieza",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["limpiezaprog"]) {
                                    value.totalAmount += parseFloat(record["limpiezaprog"]);
                                }
                                if (record["limpiezaeje"]) {
                                    value.totalTax += parseFloat(record["limpiezaeje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "insputespprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "insputespeje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "ainsputesp",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["insputespprog"]) {
                                    value.totalAmount += parseFloat(record["insputespprog"]);
                                }
                                if (record["insputespeje"]) {
                                    value.totalTax += parseFloat(record["insputespeje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "rtpostinspprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "rtpostinspeje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "artpostinsp",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["rtpostinspprog"]) {
                                    value.totalAmount += parseFloat(record["rtpostinspprog"]);
                                }
                                if (record["rtpostinspeje"]) {
                                    value.totalTax += parseFloat(record["rtpostinspeje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "ejertprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "ejerteje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "aejert",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["ejertprog"]) {
                                    value.totalAmount += parseFloat(record["ejertprog"]);
                                }
                                if (record["ejerteje"]) {
                                    value.totalTax += parseFloat(record["ejerteje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "vobocieprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "vobocieeje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "avobocie",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["vobocieprog"]) {
                                    value.totalAmount += parseFloat(record["vobocieprog"]);
                                }
                                if (record["vobocieeje"]) {
                                    value.totalTax += parseFloat(record["vobocieeje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "pinturaprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "pinturaeje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "apintura",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["pinturaprog"]) {
                                    value.totalAmount += parseFloat(record["pinturaprog"]);
                                }
                                if (record["pinturaeje"]) {
                                    value.totalTax += parseFloat(record["pinturaeje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "aislamientoprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "aislamientoeje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "aaislamiento",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["aislamientoprog"]) {
                                    value.totalAmount += parseFloat(
                                        record["aislamientoprog"]
                                    );
                                }
                                if (record["aislamientoeje"]) {
                                    value.totalTax += parseFloat(record["aislamientoeje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 200,
                        rowNum: 1000,
                        pager: "#jqGridPager",

                        grouping: true,
                        groupingView: {
                            groupField: ["lazo"],
                            groupColumnShow: [true],
                            groupText: ["<b>{0}</b>"],
                            groupOrder: ["asc"],
                            groupSummary: [true],
                            groupSummaryPos: ["header"],
                            groupCollapse: true,
                        },
                    });

                    $("#tabla1").jqGrid("setGroupHeaders", {
                        useColSpanStyle: true,
                        groupHeaders: [{
                            startColumnName: "limpiezaprog",
                            numberOfColumns: 3,
                            titleText: "LIMPIEZA",
                        },
                        {
                            startColumnName: "insputespprog",
                            numberOfColumns: 3,
                            titleText: "INSPECCIÓN <br> CIE",
                        },
                        {
                            startColumnName: "rtpostinspprog",
                            numberOfColumns: 3,
                            titleText: "EMISIÓN RT <br> POST <br>INSPECCIÓN",
                        },
                        {
                            startColumnName: "ejertprog",
                            numberOfColumns: 3,
                            titleText: "EJECUCIÓN <br> RECOMENDA.",
                        },
                        {
                            startColumnName: "vobocieprog",
                            numberOfColumns: 3,
                            titleText: "VoBo CIE",
                        },
                        {
                            startColumnName: "pinturaprog",
                            numberOfColumns: 3,
                            titleText: "PINTURA",
                        },
                        {
                            startColumnName: "aislamientoprog",
                            numberOfColumns: 3,
                            titleText: "AISLAMIENTO",
                        },
                        ],
                    });

                    cargarGraficasPuntosDemex();

                }
            );
        }

        function cargarInformePuntosVisco() {
            $.post(
                "https://utitalco.com/calidad/028/vbk/weldbook/server/repCCPuntos.php",
                function (resp) {
                    datos = resp;

                    $("#tabla2").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: datos,
                        colModel: [{
                            name: "lazo",
                            label: "LAZO CORROSIÓN",
                            width: 120,
                        },
                        {
                            name: "isometrico",
                            label: "ISOMETRICO",
                            width: 90,
                        },
                        {
                            name: "cmls",
                            label: "CML'S",
                            width: 50,
                            align: "center",
                        },

                        {
                            name: "limpiezaprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "limpiezaeje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "alimpieza",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["limpiezaprog"]) {
                                    value.totalAmount += parseFloat(record["limpiezaprog"]);
                                }
                                if (record["limpiezaeje"]) {
                                    value.totalTax += parseFloat(record["limpiezaeje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "insputespprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "insputespeje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "ainsputesp",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["insputespprog"]) {
                                    value.totalAmount += parseFloat(record["insputespprog"]);
                                }
                                if (record["insputespeje"]) {
                                    value.totalTax += parseFloat(record["insputespeje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "rtpostinspprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "rtpostinspeje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "artpostinsp",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["rtpostinspprog"]) {
                                    value.totalAmount += parseFloat(record["rtpostinspprog"]);
                                }
                                if (record["rtpostinspeje"]) {
                                    value.totalTax += parseFloat(record["rtpostinspeje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "ejertprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "ejerteje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "aejert",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["ejertprog"]) {
                                    value.totalAmount += parseFloat(record["ejertprog"]);
                                }
                                if (record["ejerteje"]) {
                                    value.totalTax += parseFloat(record["ejerteje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "vobocieprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "vobocieeje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "avobocie",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["vobocieprog"]) {
                                    value.totalAmount += parseFloat(record["vobocieprog"]);
                                }
                                if (record["vobocieeje"]) {
                                    value.totalTax += parseFloat(record["vobocieeje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "pinturaprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "pinturaeje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "apintura",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["pinturaprog"]) {
                                    value.totalAmount += parseFloat(record["pinturaprog"]);
                                }
                                if (record["pinturaeje"]) {
                                    value.totalTax += parseFloat(record["pinturaeje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "aislamientoprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "aislamientoeje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "aaislamiento",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["aislamientoprog"]) {
                                    value.totalAmount += parseFloat(
                                        record["aislamientoprog"]
                                    );
                                }
                                if (record["aislamientoeje"]) {
                                    value.totalTax += parseFloat(record["aislamientoeje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "regcontrolprog",
                            label: "TOT",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "regcontroleje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },

                        {
                            name: "aregcontrol",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["regcontrolprog"]) {
                                    value.totalAmount += parseFloat(
                                        record["regcontrolprog"]
                                    );
                                }
                                if (record["regcontroleje"]) {
                                    value.totalTax += parseFloat(record["regcontroleje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },


                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 200,
                        rowNum: 1000,
                        pager: "#jqGridPager",

                        grouping: true,
                        groupingView: {
                            groupField: ["lazo"],
                            groupColumnShow: [true],
                            groupText: ["<b>{0}</b>"],
                            groupOrder: ["asc"],
                            groupSummary: [true],
                            groupSummaryPos: ["header"],
                            groupCollapse: true,
                        },
                    });

                    $("#tabla2").jqGrid("setGroupHeaders", {
                        useColSpanStyle: true,
                        groupHeaders: [{
                            startColumnName: "limpiezaprog",
                            numberOfColumns: 3,
                            titleText: "LIMPIEZA",
                        },
                        {
                            startColumnName: "insputespprog",
                            numberOfColumns: 3,
                            titleText: "INSPECCIÓN <br> CIE",
                        },
                        {
                            startColumnName: "rtpostinspprog",
                            numberOfColumns: 3,
                            titleText: "EMISIÓN RT <br> POST <br>INSPECCIÓN",
                        },
                        {
                            startColumnName: "ejertprog",
                            numberOfColumns: 3,
                            titleText: "EJECUCIÓN <br> RECOMENDA.",
                        },
                        {
                            startColumnName: "vobocieprog",
                            numberOfColumns: 3,
                            titleText: "VoBo CIE",
                        },
                        {
                            startColumnName: "pinturaprog",
                            numberOfColumns: 3,
                            titleText: "PINTURA",
                        },
                        {
                            startColumnName: "aislamientoprog",
                            numberOfColumns: 3,
                            titleText: "AISLAMIENTO",
                        },
                        {
                            startColumnName: "regcontrolprog",
                            numberOfColumns: 3,
                            titleText: "RCA",
                        },
                        ],
                    });

                    cargarGraficasPuntosVisco();
                }
            );
        }

        function cargarGraficasPuntosDemex() {
            armandamioprog = 0;
            armandamioeje = 0;

            retaislamientoprog = 0;
            retaislamientoeje = 0;

            limpiezaprog = 0;
            limpiezaeje = 0;

            insputespprog = 0;
            insputespeje = 0;

            rtpostinspprog = 0;
            rtpostinspeje = 0;

            ejertprog = 0;
            ejerteje = 0;

            vobocieprog = 0;
            vobocieeje = 0;

            pinturaprog = 0;
            pinturaeje = 0;

            aislamientoprog = 0;
            aislamientoeje = 0;

            desarmandamioprog = 0;
            desarmandamioeje = 0;

            regcontrolprog = 0;
            regcontroleje = 0;

            for (var i = 0; i < datos.length; i++) {
                armandamioprog += datos[i].armandamioprog;
                armandamioeje += datos[i].armandamioeje;

                retaislamientoprog += datos[i].retaislamientoprog;
                retaislamientoeje += datos[i].retaislamientoeje;

                limpiezaprog += datos[i].limpiezaprog;
                limpiezaeje += datos[i].limpiezaeje;

                insputespprog += datos[i].insputespprog;
                insputespeje += datos[i].insputespeje;

                rtpostinspprog += datos[i].rtpostinspprog;
                rtpostinspeje += datos[i].rtpostinspeje;

                ejertprog += datos[i].ejertprog;
                ejerteje += datos[i].ejerteje;

                vobocieprog += datos[i].vobocieprog;
                vobocieeje += datos[i].vobocieeje;

                pinturaprog += datos[i].pinturaprog;
                pinturaeje += datos[i].pinturaeje;

                aislamientoprog += datos[i].aislamientoprog;
                aislamientoeje += datos[i].aislamientoeje;

                desarmandamioprog += datos[i].desarmandamioprog;
                desarmandamioeje += datos[i].desarmandamioeje;

                regcontrolprog += datos[i].regcontrolprog;
                regcontroleje += datos[i].regcontroleje;
            }

            Highcharts.chart("fig1", {
                colors: [
                    "#7cb5ec",
                    "#90ed7d",
                    "#9a9a9c",
                    "#f7a35c",
                    "#8085e9",
                    "#f15c80",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",

                },
                title: {
                    text: "<b>AVANCE PUNTOS DE INSPECCIÓN U-2500 DEMEX</b>",
                },

                xAxis: {
                    categories: [
                        "LIMPIEZA",
                        "INSPECCIÓN CIE",
                        "EMISIÓN RT POST INSP.",
                        "EJECUCIÓN RECOMENDA.",
                        "VoBo CIE",
                        "PINTURA",
                        "AISLAMIENTO",
                    ],
                    crosshair: true,
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        stacking: 'normal',
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                    name: "TOTALES",
                    data: [
                        limpiezaprog,
                        insputespprog,
                        rtpostinspprog,
                        ejertprog,
                        vobocieprog,
                        pinturaprog,
                        aislamientoprog,
                    ],
                },
                {
                    name: "EJECUTADAS",
                    data: [
                        limpiezaeje,
                        insputespeje,
                        rtpostinspeje,
                        ejerteje,
                        vobocieeje,
                        pinturaeje,
                        aislamientoeje,
                    ],
                    stack: 'PRO'
                },
                {
                    name: "PENDIENTES",
                    data: [
                        limpiezaprog - limpiezaeje,
                        insputespprog - insputespeje,
                        rtpostinspprog - rtpostinspeje,
                        ejertprog - ejerteje,
                        vobocieprog - vobocieeje,
                        pinturaprog - pinturaeje,
                        aislamientoprog - aislamientoeje,
                    ],
                    stack: 'PRO'
                },
                ],
            });
        }

        function cargarGraficasPuntosVisco() {
            armandamioprog = 0;
            armandamioeje = 0;

            retaislamientoprog = 0;
            retaislamientoeje = 0;

            limpiezaprog = 0;
            limpiezaeje = 0;

            insputespprog = 0;
            insputespeje = 0;

            rtpostinspprog = 0;
            rtpostinspeje = 0;

            ejertprog = 0;
            ejerteje = 0;

            vobocieprog = 0;
            vobocieeje = 0;

            pinturaprog = 0;
            pinturaeje = 0;

            aislamientoprog = 0;
            aislamientoeje = 0;

            desarmandamioprog = 0;
            desarmandamioeje = 0;

            regcontrolprog = 0;
            regcontroleje = 0;

            for (var i = 0; i < datos.length; i++) {
                armandamioprog += datos[i].armandamioprog;
                armandamioeje += datos[i].armandamioeje;

                retaislamientoprog += datos[i].retaislamientoprog;
                retaislamientoeje += datos[i].retaislamientoeje;

                limpiezaprog += datos[i].limpiezaprog;
                limpiezaeje += datos[i].limpiezaeje;

                insputespprog += datos[i].insputespprog;
                insputespeje += datos[i].insputespeje;

                rtpostinspprog += datos[i].rtpostinspprog;
                rtpostinspeje += datos[i].rtpostinspeje;

                ejertprog += datos[i].ejertprog;
                ejerteje += datos[i].ejerteje;

                vobocieprog += datos[i].vobocieprog;
                vobocieeje += datos[i].vobocieeje;

                pinturaprog += datos[i].pinturaprog;
                pinturaeje += datos[i].pinturaeje;

                aislamientoprog += datos[i].aislamientoprog;
                aislamientoeje += datos[i].aislamientoeje;

                desarmandamioprog += datos[i].desarmandamioprog;
                desarmandamioeje += datos[i].desarmandamioeje;

                regcontrolprog += datos[i].regcontrolprog;
                regcontroleje += datos[i].regcontroleje;
            }

            Highcharts.chart("fig2", {
                colors: [
                    "#7cb5ec",
                    "#90ed7d",
                    "#9a9a9c",
                    "#f7a35c",
                    "#8085e9",
                    "#f15c80",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",

                },
                title: {
                    text: "<b>AVANCE PUNTOS DE INSPECCIÓN U-2800 VISCORREDUCTORA</b>",
                },

                xAxis: {
                    categories: [
                        "LIMPIEZA",
                        "INSPECCIÓN CIE",
                        "EMISIÓN RT POST INSP.",
                        "EJECUCIÓN RECOMENDA.",
                        "VoBo CIE",
                        "PINTURA",
                        "AISLAMIENTO",
                        "REGISTRO CONTROL"
                    ],
                    crosshair: true,
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        stacking: 'normal',
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                    name: "TOTALES",
                    data: [
                        limpiezaprog,
                        insputespprog,
                        rtpostinspprog,
                        ejertprog,
                        vobocieprog,
                        pinturaprog,
                        aislamientoprog,
                        regcontrolprog
                    ],
                },
                {
                    name: "EJECUTADAS",
                    data: [
                        limpiezaeje,
                        insputespeje,
                        rtpostinspeje,
                        ejerteje,
                        vobocieeje,
                        pinturaeje,
                        aislamientoeje,
                        regcontroleje
                    ],
                    stack: 'PRO'
                },
                {
                    name: "PENDIENTES",
                    data: [
                        limpiezaprog - limpiezaeje,
                        insputespprog - insputespeje,
                        rtpostinspprog - rtpostinspeje,
                        ejertprog - ejerteje,
                        vobocieprog - vobocieeje,
                        pinturaprog - pinturaeje,
                        aislamientoprog - aislamientoeje,
                        regcontrolprog - regcontroleje
                    ],
                    stack: 'PRO'
                },
                ],
            });
        }


        function cargarInformeLazosDemex() {
            $.post(
                "https://utitalco.com/calidad/028/demex/weldbook/server/repCCLazos.php",
                function (resp) {
                    datos = resp;

                    $("#tabla15").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: datos,
                        colModel: [{
                            name: "lazo",
                            label: "LAZO CORROSIÓN",
                            width: 120,
                            frozen: true,
                        },
                        {
                            name: "isometrico",
                            label: "ISOMÉTRICO",
                            width: 90,
                            frozen: true,
                        },

                        {
                            name: "act1p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act1e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact1",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act1p"]) {
                                    value.totalAmount += parseFloat(record["act1p"]);
                                }
                                if (record["act1e"]) {
                                    value.totalTax += parseFloat(record["act1e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "act2p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act2e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact2",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act2p"]) {
                                    value.totalAmount += parseFloat(record["act2p"]);
                                }
                                if (record["act2e"]) {
                                    value.totalTax += parseFloat(record["act2e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "act3p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act3e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact3",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act3p"]) {
                                    value.totalAmount += parseFloat(record["act3p"]);
                                }
                                if (record["act3e"]) {
                                    value.totalTax += parseFloat(record["act3e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "act4p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act4e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact4",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act4p"]) {
                                    value.totalAmount += parseFloat(record["act4p"]);
                                }
                                if (record["act4e"]) {
                                    value.totalTax += parseFloat(record["act4e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "act5p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act5e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact5",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act5p"]) {
                                    value.totalAmount += parseFloat(record["act5p"]);
                                }
                                if (record["act5e"]) {
                                    value.totalTax += parseFloat(record["act5e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "act6p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act6e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact6",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act6p"]) {
                                    value.totalAmount += parseFloat(record["act6p"]);
                                }
                                if (record["act6e"]) {
                                    value.totalTax += parseFloat(record["act6e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "act7p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act7e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact7",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act7p"]) {
                                    value.totalAmount += parseFloat(record["act7p"]);
                                }
                                if (record["act7e"]) {
                                    value.totalTax += parseFloat(record["act7e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "sprog",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "seje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avtot",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["sprog"]) {
                                    value.totalAmount += parseFloat(record["sprog"]);
                                }
                                if (record["seje"]) {
                                    value.totalTax += parseFloat(record["seje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 300,
                        rowNum: 1000,
                        pager: "#jqGridPager",

                        grouping: true,
                        groupingView: {
                            groupField: ["lazo"],
                            groupColumnShow: [true],
                            groupText: ["<b>{0}</b>"],
                            groupOrder: ["asc"],
                            groupSummary: [true],
                            groupSummaryPos: ["header"],
                            groupCollapse: true,
                        },
                    });

                    $("#tabla15").jqGrid("setGroupHeaders", {
                        useColSpanStyle: true,
                        groupHeaders: [{
                            startColumnName: "act1p",
                            numberOfColumns: 3,
                            titleText: "CAMBIAR TRACING",
                        },
                        {
                            startColumnName: "act2p",
                            numberOfColumns: 3,
                            titleText: "CAMBIAR VALVULA <br> BRIDADA",
                        },
                        {
                            startColumnName: "act3p",
                            numberOfColumns: 3,
                            titleText: "CAMBIAR VENTEO",
                        },
                        {
                            startColumnName: "act4p",
                            numberOfColumns: 3,
                            titleText: "CAMBIO DE LINEA",
                        },
                        {
                            startColumnName: "act5p",
                            numberOfColumns: 3,
                            titleText: "ELIMINACION DE <br> VENTEO",
                        },
                        {
                            startColumnName: "act6p",
                            numberOfColumns: 3,
                            titleText: "MANTENIMIENTO DE <br> VALVULA BRIDADA",
                        },
                        {
                            startColumnName: "act7p",
                            numberOfColumns: 3,
                            titleText: "SOLDADURA DE SELLO",
                        },
                        {
                            startColumnName: "sprog",
                            numberOfColumns: 3,
                            titleText: "AVANCE GENERAL",
                        },
                        ],
                    });

                    // $("#grid1b2").jqGrid('filterToolbar',
                    // {autoSearch: true, searchOnEnter: false,});

                    $("#tabla15").jqGrid("setFrozenColumns");

                    cargarGraficasLazosDemex();
                }
            );
        }

        function cargarGraficasLazosDemex() {
            act1p = 0;
            act2p = 0;
            act3p = 0;
            act4p = 0;
            act5p = 0;
            act6p = 0;
            act7p = 0;
            sprog = 0;

            act1e = 0;
            act2e = 0;
            act3e = 0;
            act4e = 0;
            act5e = 0;
            act6e = 0;
            act7e = 0;
            seje = 0;

            for (var i = 0; i < datos.length; i++) {
                act1p += datos[i].act1p;
                act1e += datos[i].act1e;
                act2p += datos[i].act2p;
                act2e += datos[i].act2e;
                act3p += datos[i].act3p;
                act3e += datos[i].act3e;
                act4p += datos[i].act4p;
                act4e += datos[i].act4e;
                act5p += datos[i].act5p;
                act5e += datos[i].act5e;
                act6p += datos[i].act6p;
                act6e += datos[i].act6e;
                act7p += datos[i].act7p;
                act7e += datos[i].act7e;
                sprog += datos[i].sprog;
                seje += datos[i].seje;
            }

            Highcharts.chart("fig8", {
                colors: [
                    "#7cb5ec",
                    "#90ed7d",
                    "#9a9a9c",
                    "#f7a35c",
                    "#8085e9",
                    "#f15c80",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",

                },
                title: {
                    text: "<b>AVANCE LAZOS DE CORROSIÓN U-2500 DEMEX</b>",
                },

                xAxis: {
                    categories: [
                        "CAMBIAR TRACING",
                        "CAMBIAR VALVULA BRIDADA",
                        "CAMBIAR VENTEO",
                        "CAMBIO DE LINEA",
                        "ELIMINACION DE VENTEO",
                        "MANTENIMIENTO DE VALVULA BRIDADA",
                        "SOLDADURA DE SELLO",
                        "AVANCE GENERAL",
                    ],
                    crosshair: true,
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        stacking: 'normal',
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                    name: "PROG",
                    data: [act1p, act2p, act3p, act4p, act5p, act6p, act7p, sprog],
                },
                {
                    name: "EJECUTADAS",
                    data: [act1e, act2e, act3e, act4e, act5e, act6e, act7e, seje],
                    stack: 'PRO'
                },
                {
                    name: "PENDIENTES",
                    data: [act1p - act1e, act2p - act2e, act3p - act3e, act4p - act4e, act5p - act5e, act6p - act6e, act7p - act7e, sprog - seje],
                    stack: 'PRO'
                },
                ],
            });
        }




        function cargarInformeLazosVisco() {
            $.post(
                "https://utitalco.com/calidad/028/vbk/weldbook/server/repCCLazos.php",
                function (resp) {
                    datos = resp;

                    $("#tabla3").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: datos,
                        colModel: [{
                            name: "lazo",
                            label: "LAZO CORROSIÓN",
                            width: 120,
                            frozen: true,
                        },
                        {
                            name: "isometrico",
                            label: "ISOMÉTRICO",
                            width: 90,
                            frozen: true,
                        },

                        {
                            name: "act1p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act1e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact1",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act1p"]) {
                                    value.totalAmount += parseFloat(record["act1p"]);
                                }
                                if (record["act1e"]) {
                                    value.totalTax += parseFloat(record["act1e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "act2p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act2e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact2",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act2p"]) {
                                    value.totalAmount += parseFloat(record["act2p"]);
                                }
                                if (record["act2e"]) {
                                    value.totalTax += parseFloat(record["act2e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "act3p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act3e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact3",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act3p"]) {
                                    value.totalAmount += parseFloat(record["act3p"]);
                                }
                                if (record["act3e"]) {
                                    value.totalTax += parseFloat(record["act3e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "act4p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act4e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact4",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act4p"]) {
                                    value.totalAmount += parseFloat(record["act4p"]);
                                }
                                if (record["act4e"]) {
                                    value.totalTax += parseFloat(record["act4e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "act5p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act5e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact5",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act5p"]) {
                                    value.totalAmount += parseFloat(record["act5p"]);
                                }
                                if (record["act5e"]) {
                                    value.totalTax += parseFloat(record["act5e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "act6p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act6e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact6",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act6p"]) {
                                    value.totalAmount += parseFloat(record["act6p"]);
                                }
                                if (record["act6e"]) {
                                    value.totalTax += parseFloat(record["act6e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "act7p",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "act7e",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avact7",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["act7p"]) {
                                    value.totalAmount += parseFloat(record["act7p"]);
                                }
                                if (record["act7e"]) {
                                    value.totalTax += parseFloat(record["act7e"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },

                        {
                            name: "sprog",
                            label: "PLAN",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "seje",
                            label: "EJE",
                            width: 50,
                            align: "center",
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: "sum",
                        },
                        {
                            name: "avtot",
                            label: "AVANCE",
                            width: 50,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["sprog"]) {
                                    value.totalAmount += parseFloat(record["sprog"]);
                                }
                                if (record["seje"]) {
                                    value.totalTax += parseFloat(record["seje"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 300,
                        rowNum: 1000,
                        pager: "#jqGridPager",

                        grouping: true,
                        groupingView: {
                            groupField: ["lazo"],
                            groupColumnShow: [true],
                            groupText: ["<b>{0}</b>"],
                            groupOrder: ["asc"],
                            groupSummary: [true],
                            groupSummaryPos: ["header"],
                            groupCollapse: true,
                        },
                    });

                    $("#tabla3").jqGrid("setGroupHeaders", {
                        useColSpanStyle: true,
                        groupHeaders: [{
                            startColumnName: "act1p",
                            numberOfColumns: 3,
                            titleText: "CAMBIAR TRACING",
                        },
                        {
                            startColumnName: "act2p",
                            numberOfColumns: 3,
                            titleText: "CAMBIAR VALVULA <br> BRIDADA",
                        },
                        {
                            startColumnName: "act3p",
                            numberOfColumns: 3,
                            titleText: "CAMBIAR VENTEO",
                        },
                        {
                            startColumnName: "act4p",
                            numberOfColumns: 3,
                            titleText: "CAMBIO DE LINEA",
                        },
                        {
                            startColumnName: "act5p",
                            numberOfColumns: 3,
                            titleText: "ELIMINACION DE <br> VENTEO",
                        },
                        {
                            startColumnName: "act6p",
                            numberOfColumns: 3,
                            titleText: "MANTENIMIENTO DE <br> VALVULA BRIDADA",
                        },
                        {
                            startColumnName: "act7p",
                            numberOfColumns: 3,
                            titleText: "SOLDADURA DE SELLO",
                        },
                        {
                            startColumnName: "sprog",
                            numberOfColumns: 3,
                            titleText: "AVANCE GENERAL",
                        },
                        ],
                    });

                    // $("#grid1b2").jqGrid('filterToolbar',
                    // {autoSearch: true, searchOnEnter: false,});

                    $("#tabla3").jqGrid("setFrozenColumns");

                    cargarGraficasLazosVisco();
                }
            );
        }

        function cargarGraficasLazosVisco() {
            act1p = 0;
            act2p = 0;
            act3p = 0;
            act4p = 0;
            act5p = 0;
            act6p = 0;
            act7p = 0;
            sprog = 0;

            act1e = 0;
            act2e = 0;
            act3e = 0;
            act4e = 0;
            act5e = 0;
            act6e = 0;
            act7e = 0;
            seje = 0;

            for (var i = 0; i < datos.length; i++) {
                act1p += datos[i].act1p;
                act1e += datos[i].act1e;
                act2p += datos[i].act2p;
                act2e += datos[i].act2e;
                act3p += datos[i].act3p;
                act3e += datos[i].act3e;
                act4p += datos[i].act4p;
                act4e += datos[i].act4e;
                act5p += datos[i].act5p;
                act5e += datos[i].act5e;
                act6p += datos[i].act6p;
                act6e += datos[i].act6e;
                act7p += datos[i].act7p;
                act7e += datos[i].act7e;
                sprog += datos[i].sprog;
                seje += datos[i].seje;
            }

            Highcharts.chart("fig3", {
                colors: [
                    "#7cb5ec",
                    "#90ed7d",
                    "#9a9a9c",
                    "#f7a35c",
                    "#8085e9",
                    "#f15c80",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",

                },
                title: {
                    text: "<b>AVANCE LAZOS DE CORROSIÓN U-2800 VISCORREDUCTORA</b>",
                },

                xAxis: {
                    categories: [
                        "CAMBIAR TRACING",
                        "CAMBIAR VALVULA BRIDADA",
                        "CAMBIAR VENTEO",
                        "CAMBIO DE LINEA",
                        "ELIMINACION DE VENTEO",
                        "MANTENIMIENTO DE VALVULA BRIDADA",
                        "SOLDADURA DE SELLO",
                        "AVANCE GENERAL",
                    ],
                    crosshair: true,
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        stacking: 'normal',
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                    name: "PROG",
                    data: [act1p, act2p, act3p, act4p, act5p, act6p, act7p, sprog],
                },
                {
                    name: "EJECUTADAS",
                    data: [act1e, act2e, act3e, act4e, act5e, act6e, act7e, seje],
                    stack: 'PRO'
                },
                {
                    name: "PENDIENTES",
                    data: [act1p - act1e, act2p - act2e, act3p - act3e, act4p - act4e, act5p - act5e, act6p - act6e, act7p - act7e, sprog - seje],
                    stack: 'PRO'
                },
                ],
            });
        }

        function cargarInformeInterDemex() {
            $.post(
                "https://utitalco.com/calidad/028/demex/weldbook/server/cargarDatosCCInterRes.php",
                function (resp) {
                    res = resp.res;

                    $("#tabla4").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: res,
                        colModel: [{
                            name: "actividad",
                            label: "ACTIVIDAD",
                            width: 250,
                            frozen: true,
                        },
                        {
                            name: "haztotal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "hazeje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "canaltotal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "canaleje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "tpcanaltotal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "tpcanaleje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "tpftotal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "tpfeje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "anitotal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "anieje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "cascototal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "cascoeje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "tpcascototal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "tpcascoeje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: ventana_alto,
                        rowNum: 1000,
                        pager: "#jqGridPager",
                    });

                    $("#tabla4").jqGrid("setGroupHeaders", {
                        useColSpanStyle: true,
                        groupHeaders: [{
                            startColumnName: "haztotal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>HAZ DE TUBOS</center></td></tr>' +
                                "</table>",
                        },

                        {
                            startColumnName: "canaltotal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CANAL Ó BONETE</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "tpcanaltotal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TAPA CANAL</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "tpftotal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TAPA CABEZAL FLOTANTE</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "anitotal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>ANILLO Y MEDIAS LUNAS</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "cascototal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CASCO</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "tpcascototal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TAPA CASCO</center></td></tr>' +
                                "</table>",
                        },
                        ],
                    });

                    $("#tabla4").jqGrid("setFrozenColumns");
                }
            );
        }

        function cargarInformeInterVisco() {
            $.post(
                "https://utitalco.com/calidad/028/vbk/weldbook/server/cargarDatosCCInterRes.php",
                function (resp) {
                    res = resp.res;

                    $("#tabla21").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: res,
                        colModel: [{
                            name: "actividad",
                            label: "ACTIVIDAD",
                            width: 250,
                            frozen: true,
                        },
                        {
                            name: "haztotal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "hazeje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "canaltotal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "canaleje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "tpcanaltotal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "tpcanaleje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "tpftotal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "tpfeje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "anitotal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "anieje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "cascototal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "cascoeje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "tpcascototal",
                            label: "TOTAL",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        {
                            name: "tpcascoeje",
                            label: "EJE",
                            width: 70,
                            frozen: true,
                            align: "center",
                        },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: ventana_alto,
                        rowNum: 1000,
                        pager: "#jqGridPager",
                    });

                    $("#tabla21").jqGrid("setGroupHeaders", {
                        useColSpanStyle: true,
                        groupHeaders: [{
                            startColumnName: "haztotal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>HAZ DE TUBOS</center></td></tr>' +
                                "</table>",
                        },

                        {
                            startColumnName: "canaltotal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CANAL Ó BONETE</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "tpcanaltotal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TAPA CANAL</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "tpftotal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TAPA CABEZAL FLOTANTE</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "anitotal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>ANILLO Y MEDIAS LUNAS</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "cascototal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CASCO</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "tpcascototal",
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TAPA CASCO</center></td></tr>' +
                                "</table>",
                        },
                        ],
                    });

                    $("#tabla21").jqGrid("setFrozenColumns");
                }
            );
        }



        function cargarInformeTamboresDemex() {
            $.post(
                "https://utitalco.com/calidad/028/demex/weldbook/server/cargarDatosCCTambores.php",
                function (resp) {
                    datos = resp;

                    console.log(datos);

                    $("#tabla5").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: datos,
                        colModel: [{
                            name: "item",
                            label: "ID <br><br>.",
                            width: 30,
                            frozen: true,
                        },
                        {
                            name: "tag",
                            label: "TAG <br><br>.",
                            width: 60,
                            frozen: true,
                        },
                        {
                            name: "alcance",
                            label: "ALCANCE",
                            width: 250,
                            align: "center",
                        },
                        {
                            name: "instsas",
                            label: "INST <br>SAS",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "abrirm",
                            label: "ABRIR <br>MANHOLES",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "instfacint",
                            label: "INSTALACIÓN <br>FACILIDADES <br>INTERNAS",
                            width: 80,
                        },
                        {
                            name: "retint",
                            label: "RETIRO DE <br>INTERNOS",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "limpint",
                            label: "LIMPIEZA <br>INTERNOS",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "retaislamiento",
                            label: "RETIRO DE <br>AISLAMIENTO",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "limpext",
                            label: "LIMPIEZA <br>EXTERNA",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "inspvisual",
                            label: "INSPECCIÓN <br>VISUAL",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "tomaesp",
                            label: "TOMA DE <br>ESPESORES",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "areasello",
                            label: "ÁREA DE <br>SELLO",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "inspinternos",
                            label: "INTERNOS",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "instint",
                            label: "INSTALACIÓN <br>DE INTERNOS",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "cierrem",
                            label: "CIERRE DE <br>MANHOLES",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "torque",
                            label: "NORMALIZACIÓN <br>AJUSTE Y <br>TORQUE",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "limpypintura",
                            label: "LIMPIEZA Y <br>PINTURA A <br>BASE DE <br>CONCRETO",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "pinturaext",
                            label: "APLICACIÓN <br>DE PINTURA <br>EXTERIOR",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "instaislamiento",
                            label: "INSTALACIÓN <br>DE <br>AISLAMIENTO",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "retsas",
                            label: "RETIRO <br>DE SAS",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "rca",
                            label: "RCA",
                            width: 80,
                            align: "center"
                        },
                        {
                            name: "obs",
                            label: "OBSERVACIONES",
                            width: 250,
                            align: "center",
                        },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 150,
                        rowNum: 1000,
                        pager: "#jqGridPager",
                    });

                    $("#tabla5").jqGrid("filterToolbar", {
                        autoSearch: true,
                        searchOnEnter: false,
                    });

                    $("#tabla5").jqGrid("setGroupHeaders", {
                        useColSpanStyle: true,
                        groupHeaders: [{
                            startColumnName: "inspvisual",
                            numberOfColumns: 4,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>INSPECCIÓN</center></td></tr>' +
                                "</table>",
                        },],
                    });

                    $("#tabla5").jqGrid("setFrozenColumns");
                }
            );
        }

        function cargarInformeTamboresVisco() {
            $.post(
                "https://utitalco.com/calidad/028/vbk/weldbook/server/cargarDatosCCTambores.php",
                function (resp) {
                    datos = resp;

                    if (resp != null) {
                        console.log(datos);

                        $("#tabla6").jqGrid({
                            datatype: "local",
                            regional: "es", // this is default
                            data: datos,
                            colModel: [{
                                name: "item",
                                label: "ID <br><br>.",
                                width: 30,
                                frozen: true,
                            },
                            {
                                name: "tag",
                                label: "TAG <br><br>.",
                                width: 60,
                                frozen: true,
                            },
                            {
                                name: "alcance",
                                label: "ALCANCE",
                                width: 250,
                                align: "center",
                            },
                            {
                                name: "instsas",
                                label: "INST <br>SAS",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "abrirm",
                                label: "ABRIR <br>MANHOLES",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "instfacint",
                                label: "INSTALACIÓN <br>FACILIDADES <br>INTERNAS",
                                width: 80,
                            },
                            {
                                name: "retint",
                                label: "RETIRO DE <br>INTERNOS",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "limpint",
                                label: "LIMPIEZA <br>INTERNOS",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "retaislamiento",
                                label: "RETIRO DE <br>AISLAMIENTO",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "limpext",
                                label: "LIMPIEZA <br>EXTERNA",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "inspvisual",
                                label: "INSPECCIÓN <br>VISUAL",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "tomaesp",
                                label: "TOMA DE <br>ESPESORES",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "areasello",
                                label: "ÁREA DE <br>SELLO",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "inspinternos",
                                label: "INTERNOS",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "instint",
                                label: "INSTALACIÓN <br>DE INTERNOS",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "cierrem",
                                label: "CIERRE DE <br>MANHOLES",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "torque",
                                label: "NORMALIZACIÓN <br>AJUSTE Y <br>TORQUE",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "limpypintura",
                                label: "LIMPIEZA Y <br>PINTURA A <br>BASE DE <br>CONCRETO",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "pinturaext",
                                label: "APLICACIÓN <br>DE PINTURA <br>EXTERIOR",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "instaislamiento",
                                label: "INSTALACIÓN <br>DE <br>AISLAMIENTO",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "retsas",
                                label: "RETIRO <br>DE SAS",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "rca",
                                label: "RCA",
                                width: 80,
                                align: "center"
                            },
                            {
                                name: "obs",
                                label: "OBSERVACIONES",
                                width: 250,
                                align: "center",
                            },
                            ],
                            loadonce: true,
                            shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                            width: ventana_ancho,
                            height: 150,
                            rowNum: 1000,
                            pager: "#jqGridPager",
                        });

                        $("#tabla6").jqGrid("filterToolbar", {
                            autoSearch: true,
                            searchOnEnter: false,
                        });

                        $("#tabla6").jqGrid("setGroupHeaders", {
                            useColSpanStyle: true,
                            groupHeaders: [{
                                startColumnName: "inspvisual",
                                numberOfColumns: 4,
                                titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                    '<tr><td id="h0" style="color: #000;"><center>INSPECCIÓN</center></td></tr>' +
                                    "</table>",
                            },],
                        });

                        $("#tabla6").jqGrid("setFrozenColumns");
                    }


                }
            );
        }

        function cargarInformeLgsDemex() {
            $.post(
                "https://utitalco.com/calidad/028/demex/weldbook/server/cargarDatosCCLgs.php",
                function (resp) {
                    datos = resp;

                    console.log(datos);

                    $("#tablalg").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: datos,
                        colModel: [{
                            name: "equipo",
                            label: "EQUIPO",
                            width: 120,
                            frozen: true
                        },
                        {
                            name: "alcance",
                            label: "ALCANCE",
                            width: 250,
                            align: "center",
                        },
                        {
                            name: "intervencion",
                            label: "INTERVENCIÓN <br>DE EQUIPO",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "desarmado",
                            label: "DESARMADO <br>DE <br>COMPONENTES",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "limpieza",
                            label: "LIMPIEZA <br>Y ARMADO",
                            width: 80
                        },
                        {
                            name: "instvalvulas",
                            label: "INST DE <br>VALULVAS",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "soldadurasello",
                            label: "SOLDADURA <br>DE SELLO",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "ph",
                            label: "PRUEBA <br>HIDROSTÁTICA",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "montaje",
                            label: "MONTAJE E <br>INSTALACIÓN",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "torque",
                            label: "TORQUE Y <br>TARJETEO",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "rca",
                            label: "RCA",
                            width: 80,
                            align: "center"
                        },
                        {
                            name: "obs",
                            label: "OBSERVACIONES",
                            width: 250,
                            align: "center",
                        },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 150,
                        rowNum: 1000,
                        pager: "#jqGridPager",
                    });

                    $("#tablalg").jqGrid("filterToolbar", {
                        autoSearch: true,
                        searchOnEnter: false,
                    });

                    $("#tablalg").jqGrid("setFrozenColumns");
                }
            );
        }


        function cargarInformeLgsVisco() {
            $.post(
                "https://utitalco.com/calidad/028/vbk/weldbook/server/cargarDatosCCLgs.php",
                function (resp) {
                    datos = resp;

                    console.log(datos);

                    $("#tabla7").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: datos,
                        colModel: [{
                            name: "equipo",
                            label: "EQUIPO",
                            width: 120,
                            frozen: true
                        },
                        {
                            name: "alcance",
                            label: "ALCANCE",
                            width: 250,
                            align: "center",
                        },
                        {
                            name: "intervencion",
                            label: "INTERVENCIÓN <br>DE EQUIPO",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "desarmado",
                            label: "DESARMADO <br>DE <br>COMPONENTES",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "limpieza",
                            label: "LIMPIEZA <br>Y ARMADO",
                            width: 80
                        },
                        {
                            name: "instvalvulas",
                            label: "INST DE <br>VALULVAS",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "soldadurasello",
                            label: "SOLDADURA <br>DE SELLO",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "ph",
                            label: "PRUEBA <br>HIDROSTÁTICA",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "montaje",
                            label: "MONTAJE E <br>INSTALACIÓN",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "torque",
                            label: "TORQUE Y <br>TARJETEO",
                            width: 80,
                            align: "center",
                        },
                        {
                            name: "rca",
                            label: "RCA",
                            width: 80,
                            align: "center"
                        },
                        {
                            name: "obs",
                            label: "OBSERVACIONES",
                            width: 250,
                            align: "center",
                        },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 150,
                        rowNum: 1000,
                        pager: "#jqGridPager",
                    });

                    $("#tabla7").jqGrid("filterToolbar", {
                        autoSearch: true,
                        searchOnEnter: false,
                    });

                    $("#tabla7").jqGrid("setFrozenColumns");
                }
            );
        }

        function cargarInformeSoldaduraEquiposDemex() {
            $.post(
                "https://utitalco.com/calidad/028/demex/weldbook/server/cJuntasEquipos.php",
                function (resp) {
                    datos = resp;

                    $("#tablaSold").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: datos,
                        colModel: [{
                            name: "especialidad",
                            label: "ESPECIALIDAD",
                            width: 150,
                            frozen: true,
                        },
                        {
                            name: "equipo",
                            label: "EQUIPO",
                            width: 200,
                            frozen: true,
                        },
                        {
                            name: "pulgadas",
                            label: "PULG",
                            width: 70,
                            align: "center",
                            frozen: true,
                        },
                        {
                            name: "jpt",
                            label: "JUNTAS <br> PROG",
                            width: 70,
                            align: "center",
                            formatter: {
                                integer: {
                                    thousandsSeparator: " ",
                                    defaultValue: "0",
                                },
                            },
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "jet",
                            label: "JUNTAS  <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "jpdt",
                            label: "JUNTAS  <br> PDTES",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "ajt",
                            label: "% AVANCE",
                            width: 70,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["jpt"]) {
                                    value.totalAmount += parseFloat(record["jpt"]);
                                }
                                if (record["jet"]) {
                                    value.totalTax += parseFloat(record["jet"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        {
                            name: "ppt",
                            label: "PULG DIAM <br> PROG",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "pet",
                            label: "PULG DIAM <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "ppdt",
                            label: "PULG DIAM <br> PDTES",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "apt",
                            label: "% AVANCE",
                            width: 70,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["ppt"]) {
                                    value.totalAmount += parseFloat(record["ppt"]);
                                }
                                if (record["pet"]) {
                                    value.totalTax += parseFloat(record["pet"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        {
                            name: "jpc",
                            label: "JUNTAS <br> PROG",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "jec",
                            label: "JUNTAS <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "jpdc",
                            label: "JUNTAS <br> PDTES",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "ajc",
                            label: "% AVANCE",
                            width: 70,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["jpc"]) {
                                    value.totalAmount += parseFloat(record["jpc"]);
                                }
                                if (record["jec"]) {
                                    value.totalTax += parseFloat(record["jec"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        {
                            name: "ppc",
                            label: "PULG DIAM <br> PROG",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "pec",
                            label: "PULG DIAM <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "ppdc",
                            label: "PULG DIAM <br> PDTES",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "apc",
                            label: "% AVANCE",
                            width: 70,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["ppc"]) {
                                    value.totalAmount += parseFloat(record["ppc"]);
                                }
                                if (record["pec"]) {
                                    value.totalTax += parseFloat(record["pec"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        {
                            name: "jptot",
                            label: "JUNTAS <br> PROG",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "jetot",
                            label: "JUNTAS <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "jtpdc",
                            label: "JUNTAS <br> PDTES",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "ajtot",
                            label: "% AVANCE",
                            width: 70,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["jptot"]) {
                                    value.totalAmount += parseFloat(record["jptot"]);
                                }
                                if (record["jetot"]) {
                                    value.totalTax += parseFloat(record["jetot"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        {
                            name: "pptot",
                            label: "PULG DIAM <br> PROG",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "petot",
                            label: "PULG DIAM <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "ptpdc",
                            label: "PULG DIAM <br> PDTES",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "aptot",
                            label: "% AVANCE",
                            width: 70,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["pptot"]) {
                                    value.totalAmount += parseFloat(record["pptot"]);
                                }
                                if (record["petot"]) {
                                    value.totalTax += parseFloat(record["petot"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 150,
                        rowNum: 1000,
                        pager: "#jqGridPager",

                        grouping: true,
                        groupingView: {
                            groupField: ["especialidad"],
                            groupColumnShow: [true],
                            groupText: ["<b>{0}</b>"],
                            groupOrder: ["asc"],
                            groupSummary: [true],
                            groupSummaryPos: ["header"],
                            groupCollapse: true,
                        },
                    });

                    $("#tablaSold").jqGrid("setGroupHeaders", {
                        useColSpanStyle: true,
                        groupHeaders: [{
                            startColumnName: "jpt",
                            numberOfColumns: 8,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TALLER</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "jpc",
                            numberOfColumns: 8,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(135, 244, 252); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CAMPO</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "jptot",
                            numberOfColumns: 8,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(153, 250, 169); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TOTAL</center></td></tr>' +
                                "</table>",
                        },
                        ],
                    });

                    $("#tablaSold").jqGrid("setFrozenColumns");
                }
            );
        }

        function cargarInformeSoldaduraEquiposVisco() {
            $.post(
                "https://utitalco.com/calidad/028/vbk/weldbook/server/cJuntasEquipos.php",
                function (resp) {
                    datos = resp;

                    $("#tabla8").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: datos,
                        colModel: [{
                            name: "especialidad",
                            label: "ESPECIALIDAD",
                            width: 150,
                            frozen: true,
                        },
                        {
                            name: "equipo",
                            label: "EQUIPO",
                            width: 200,
                            frozen: true,
                        },
                        {
                            name: "pulgadas",
                            label: "PULG",
                            width: 70,
                            align: "center",
                            frozen: true,
                        },
                        {
                            name: "jpt",
                            label: "JUNTAS <br> PROG",
                            width: 70,
                            align: "center",
                            formatter: {
                                integer: {
                                    thousandsSeparator: " ",
                                    defaultValue: "0",
                                },
                            },
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "jet",
                            label: "JUNTAS  <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "jpdt",
                            label: "JUNTAS  <br> PDTES",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "ajt",
                            label: "% AVANCE",
                            width: 70,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["jpt"]) {
                                    value.totalAmount += parseFloat(record["jpt"]);
                                }
                                if (record["jet"]) {
                                    value.totalTax += parseFloat(record["jet"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        {
                            name: "ppt",
                            label: "PULG DIAM <br> PROG",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "pet",
                            label: "PULG DIAM <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "ppdt",
                            label: "PULG DIAM <br> PDTES",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "apt",
                            label: "% AVANCE",
                            width: 70,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["ppt"]) {
                                    value.totalAmount += parseFloat(record["ppt"]);
                                }
                                if (record["pet"]) {
                                    value.totalTax += parseFloat(record["pet"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        {
                            name: "jpc",
                            label: "JUNTAS <br> PROG",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "jec",
                            label: "JUNTAS <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "jpdc",
                            label: "JUNTAS <br> PDTES",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "ajc",
                            label: "% AVANCE",
                            width: 70,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["jpc"]) {
                                    value.totalAmount += parseFloat(record["jpc"]);
                                }
                                if (record["jec"]) {
                                    value.totalTax += parseFloat(record["jec"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        {
                            name: "ppc",
                            label: "PULG DIAM <br> PROG",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "pec",
                            label: "PULG DIAM <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "ppdc",
                            label: "PULG DIAM <br> PDTES",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "apc",
                            label: "% AVANCE",
                            width: 70,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["ppc"]) {
                                    value.totalAmount += parseFloat(record["ppc"]);
                                }
                                if (record["pec"]) {
                                    value.totalTax += parseFloat(record["pec"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        {
                            name: "jptot",
                            label: "JUNTAS <br> PROG",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "jetot",
                            label: "JUNTAS <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "jtpdc",
                            label: "JUNTAS <br> PDTES",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "ajtot",
                            label: "% AVANCE",
                            width: 70,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["jptot"]) {
                                    value.totalAmount += parseFloat(record["jptot"]);
                                }
                                if (record["jetot"]) {
                                    value.totalTax += parseFloat(record["jetot"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        {
                            name: "pptot",
                            label: "PULG DIAM <br> PROG",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "petot",
                            label: "PULG DIAM <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "ptpdc",
                            label: "PULG DIAM <br> PDTES",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum",
                        },
                        {
                            name: "aptot",
                            label: "% AVANCE",
                            width: 70,
                            align: "center",
                            formatoptions: {
                                suffix: " %",
                            },
                            summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                            summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                        totalAmount: 0,
                                        totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["pptot"]) {
                                    value.totalAmount += parseFloat(record["pptot"]);
                                }
                                if (record["petot"]) {
                                    value.totalTax += parseFloat(record["petot"]);
                                }
                                return value;
                            },
                            formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                        var val =
                                            (cellval.totalTax / cellval.totalAmount) * 100;
                                        return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                        return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                            },
                        },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 150,
                        rowNum: 1000,
                        pager: "#jqGridPager",

                        grouping: true,
                        groupingView: {
                            groupField: ["especialidad"],
                            groupColumnShow: [true],
                            groupText: ["<b>{0}</b>"],
                            groupOrder: ["asc"],
                            groupSummary: [true],
                            groupSummaryPos: ["header"],
                            groupCollapse: true,
                        },
                    });

                    $("#tabla8").jqGrid("setGroupHeaders", {
                        useColSpanStyle: true,
                        groupHeaders: [{
                            startColumnName: "jpt",
                            numberOfColumns: 8,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TALLER</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "jpc",
                            numberOfColumns: 8,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(135, 244, 252); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CAMPO</center></td></tr>' +
                                "</table>",
                        },
                        {
                            startColumnName: "jptot",
                            numberOfColumns: 8,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(153, 250, 169); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TOTAL</center></td></tr>' +
                                "</table>",
                        },
                        ],
                    });

                    $("#tabla8").jqGrid("setFrozenColumns");


                }
            );
        }




        function cargarInformeSoldaduraDemex() {

            $.post('https://utitalco.com/calidad/028/demex/server/curvaSoldadura.php', {
                ods: odsq,
                fecha: fechab
            },
                function (resp) {

                    console.log(resp)

                    arrayDatos = resp.soldp

                    for (var i = 0; i < arrayDatos.length; i++) {
                        arrayFechas.push(arrayDatos[i].fecha)
                        arrayProg.push(arrayDatos[i].progacum)

                        // arrayFechas.push(arrayDatos[i].fecha)
                    }

                    arrayDatos = resp.solde
                    var arrayDatosTmp = resp.soldp

                    for (var i = 0; i < arrayDatos.length; i++) {
                        arrayEje.push(arrayDatos[i].ejeacum)

                        arrayProgAcum = arrayDatosTmp[i].progacum
                        arrayEjeAcum = arrayDatos[i].ejeacum
                        // arrayFechas.push(arrayDatos[i].fecha)
                    }



                    Swal.close()

                    cargarGraficasSoldaduraDemex()


                })
        }


        function cargarGraficasSoldaduraDemex() {

            Highcharts.chart('figsoldDemex', {
                colors: [
                    "#004236",
                    "#00c901",
                    "#F8F9F9 ",
                    "#C51111",
                    "#a4c639",
                    "#180272",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: 'spline',
                    height: 600,
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:.f} </b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                title: {
                    text: 'CURVA SOLDADURA'
                },

                xAxis: {
                    categories: arrayFechas
                },
                yAxis: {
                    title: {
                        text: 'CANT PULGADAS'
                    }
                },
                plotOptions: {
                    spline: {
                        dataLabels: {
                            enabled: true
                        },
                        enableMouseTracking: true
                    }
                },
                series:
                    [
                        {
                            name: 'PROG ACUM',
                            data: arrayProg
                        },
                        {
                            name: 'EJE ACUM',
                            data: arrayEje
                        },

                    ]
            });

            var desv = (arrayEjeAcum - arrayProgAcum).toFixed(2)
            desv = parseFloat(desv)

            Highcharts.chart('figavancediarioDemex', {


                colors: [
                    "#004236",
                    "#00c901",
                    "#180272",
                    "#C51111",
                    "#F8F9F9 ",
                    "#a4c639",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                    "#537b35",
                ],
                credits: {
                    enabled: false
                },
                chart: {
                    type: 'column',
                    height: 600,
                    // options3d: {
                    //     enabled: true,
                    //     alpha: 15,
                    //     beta: 15,
                    //     viewDistance: 25,
                    //     depth: 40
                    // }
                },
                title: {
                    text: '<b>AVANCE DIARIO ACUMULADO SOLDADURA POR PULGADAS DIAMETRALES</b>'
                },

                xAxis: {
                    categories: ['PULGADAS'],
                    crosshair: true
                },


                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                plotOptions: {
                    column: {
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true
                        }
                    }
                },
                series: [
                    {
                        name: 'PULG PROG',
                        data: [arrayProgAcum]
                    }, {
                        name: 'PULG EJE',
                        data: [arrayEjeAcum]
                    }
                    , {
                        name: 'DESVIACIÓN',
                        data: [desv]
                    }
                ]
            });





        }





        function cargarInformeBridasVisco() {
            $.post('https://utitalco.com/calidad/028/vbk/weldbook/server/repBridas.php', function (resp) {
                datos = resp
                $("#tabla9").jqGrid({
                    datatype: 'local',
                    regional: 'es', // this is default
                    data: datos,
                    colModel: [{
                        name: "especialidad",
                        label: "ESPECIALIDAD",
                        width: 120,
                        frozen: true
                    },
                    {
                        name: "linea",
                        label: "INGENIERÍA <br> / LÍNEA <br> / EQUIPO",
                        width: 180,
                        frozen: true
                    },
                    {
                        name: "cant",
                        label: "PLANEADAS",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },
                    {
                        name: "eje",
                        label: "EJEC",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },
                    {
                        name: "avance",
                        label: "AVANCE",
                        width: 80,
                        align: "center",
                        formatoptions: {
                            suffix: " %",
                        },
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: function (value, name, record) {
                            // initialize the value object
                            if (typeof value === "string") {
                                value = {
                                    totalAmount: 0,
                                    totalTax: 0,
                                };
                            }
                            // perform summary
                            if (record["cant"]) {
                                value.totalAmount += parseFloat(record["cant"]);
                            }
                            if (record["eje"]) {
                                value.totalTax += parseFloat(record["eje"]);
                            }
                            return value;
                        },
                        formatter: function (cellval, opts, rwdat, act) {
                            // get the regional options and pass it to the custom formatter
                            opts = $.extend({},
                                $.jgrid.getRegional(this, "formatter"),
                                opts
                            );
                            // determine if we are in summary row to put the value
                            if (opts.rowId === "") {
                                if (cellval.totalAmount !== 0) {
                                    var val =
                                        (cellval.totalTax / cellval.totalAmount) * 100;
                                    return $.fn.fmatter("number", val, opts, rwdat, act);
                                } else {
                                    return "0";
                                }
                            } else {
                                return $.fn.fmatter("number", cellval, opts, rwdat, act);
                            }
                        },
                    },


                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: ventana_ancho,
                    height: 250,
                    rowNum: 1000,
                    pager: "#jqGridPager",

                    grouping: true,
                    groupingView: {
                        groupField: ["especialidad"],
                        groupColumnShow: [true],
                        groupText: ["<b>{0}</b>"],
                        groupOrder: ["asc"],
                        groupSummary: [true],
                        groupSummaryPos: ["header"],
                        groupCollapse: true,
                    },
                });

                cargarGraficasBridas()



            })
        }

        function cargarInformeBridasDemex() {
            $.post('https://utitalco.com/calidad/028/demex/weldbook/server/repBridas.php', function (resp) {
                datos = resp
                $("#tabla14").jqGrid({
                    datatype: 'local',
                    regional: 'es', // this is default
                    data: datos,
                    colModel: [{
                        name: "especialidad",
                        label: "ESPECIALIDAD",
                        width: 120,
                        frozen: true
                    },
                    {
                        name: "linea",
                        label: "INGENIERÍA <br> / LÍNEA <br> / EQUIPO",
                        width: 180,
                        frozen: true
                    },
                    {
                        name: "cant",
                        label: "PLANEADAS",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },
                    {
                        name: "eje",
                        label: "EJEC",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },
                    {
                        name: "avance",
                        label: "AVANCE",
                        width: 80,
                        align: "center",
                        formatoptions: {
                            suffix: " %",
                        },
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: function (value, name, record) {
                            // initialize the value object
                            if (typeof value === "string") {
                                value = {
                                    totalAmount: 0,
                                    totalTax: 0,
                                };
                            }
                            // perform summary
                            if (record["cant"]) {
                                value.totalAmount += parseFloat(record["cant"]);
                            }
                            if (record["eje"]) {
                                value.totalTax += parseFloat(record["eje"]);
                            }
                            return value;
                        },
                        formatter: function (cellval, opts, rwdat, act) {
                            // get the regional options and pass it to the custom formatter
                            opts = $.extend({},
                                $.jgrid.getRegional(this, "formatter"),
                                opts
                            );
                            // determine if we are in summary row to put the value
                            if (opts.rowId === "") {
                                if (cellval.totalAmount !== 0) {
                                    var val =
                                        (cellval.totalTax / cellval.totalAmount) * 100;
                                    return $.fn.fmatter("number", val, opts, rwdat, act);
                                } else {
                                    return "0";
                                }
                            } else {
                                return $.fn.fmatter("number", cellval, opts, rwdat, act);
                            }
                        },
                    },


                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: ventana_ancho,
                    height: 250,
                    rowNum: 1000,
                    pager: "#jqGridPager",

                    grouping: true,
                    groupingView: {
                        groupField: ["especialidad"],
                        groupColumnShow: [true],
                        groupText: ["<b>{0}</b>"],
                        groupOrder: ["asc"],
                        groupSummary: [true],
                        groupSummaryPos: ["header"],
                        groupCollapse: true,
                    },
                });

                cargarGraficasBridasDemex()



            })
        }


        function cargarGraficasBridasDemex() {

            var titulo = []
            var prog = []
            var ejec = []
            var avance = []


            for (var i = 0; i < datos.length; i++) {
                titulo.push(datos[i].especialidad + ' - ' + datos[i].linea);
                prog.push(datos[i].cant)
                ejec.push(datos[i].eje)
                var pend = datos[i].cant - datos[i].eje
                avance.push(pend)
            }

            console.log('titulos')
            console.log(titulo)

            Highcharts.chart("fig7", {
                colors: [
                    "#7cb5ec",
                    "#90ed7d",
                    "#9a9a9c",
                    "#f7a35c",
                    "#8085e9",
                    "#f15c80",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",

                    height: 600
                },
                title: {
                    text: "<b>AVANCE UNIONES BRIDADAS  DEMEX</b>",
                },

                xAxis: {
                    categories: titulo,
                    crosshair: true,
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        stacking: 'normal',
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                    name: "TOTALES",
                    data: prog,
                },
                {
                    name: "EJECUTADAS",
                    data: ejec,
                    stack: 'PRO'
                },
                {
                    name: "PENDIENTES",
                    data: avance,
                    stack: 'PRO'
                },
                ],
            });
        }


        function cargarGraficasBridas() {

            var titulo = []
            var prog = []
            var ejec = []
            var avance = []


            for (var i = 0; i < datos.length; i++) {
                titulo.push(datos[i].especialidad + ' - ' + datos[i].linea);
                prog.push(datos[i].cant)
                ejec.push(datos[i].eje)
                var pend = datos[i].cant - datos[i].eje
                avance.push(pend)
            }

            Highcharts.chart("fig4", {
                colors: [
                    "#7cb5ec",
                    "#90ed7d",
                    "#9a9a9c",
                    "#f7a35c",
                    "#8085e9",
                    "#f15c80",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",

                    height: 600
                },
                title: {
                    text: "<b>AVANCE UNIONES BRIDADAS</b>",
                },

                xAxis: {
                    categories: titulo,
                    crosshair: true,
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        stacking: 'normal',
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                    name: "TOTALES",
                    data: prog,
                },
                {
                    name: "EJECUTADAS",
                    data: ejec,
                    stack: 'PRO'
                },
                {
                    name: "PENDIENTES",
                    data: avance,
                    stack: 'PRO'
                },
                ],
            });
        }

        function cargarAvanceDiarioVisco() {

            $('#fechac').val(fechabuscar)

            $.post("https://utitalco.com/calidad/028/vbk/weldbook/server/cJuntasEquiposEje.php", { fecha: fechabuscar }, function (resp) {
                datos = resp;

                if (datos == null) {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'info',
                        title: 'Sin registros...',
                        showConfirmButton: false,
                        timer: 1500
                    })
                } else {


                    $("#tabla12").jqGrid({
                        datatype: 'local',
                        regional: 'es', // this is default
                        data: datos,
                        colModel: [{
                            name: "especialidad",
                            label: "ESPECIALIDAD",
                            width: 150,
                            frozen: true
                        },
                        {
                            name: "equipo",
                            label: "EQUIPO",
                            width: 200,
                            frozen: true
                        },
                        {
                            name: "pulgadas",
                            label: "PULG",
                            width: 70,
                            align: "center",
                            frozen: true
                        },
                        {
                            name: "jet",
                            label: "JUNTAS <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum"
                        },

                        {
                            name: "pet",
                            label: "PULG DIAM <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum"
                        },



                        {
                            name: "jec",
                            label: "JUNTAS <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum"
                        },


                        {
                            name: "pec",
                            label: "PULG DIAM <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum"
                        },

                        {
                            name: "jetot",
                            label: "JUNTAS <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum"
                        },


                        {
                            name: "petot",
                            label: "PULG DIAM <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum"
                        },

                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: 900,
                        height: 200,
                        rowNum: 1000,
                        pager: "#jqGridPager",

                        grouping: true,
                        groupingView: {
                            groupField: ["especialidad"],
                            groupColumnShow: [true],
                            groupText: ["<b>{0}</b>"],
                            groupOrder: ["asc"],
                            groupSummary: [true],
                            groupSummaryPos: ['header'],
                            groupCollapse: false
                        }
                    });

                    $("#tabla12").jqGrid('setGroupHeaders', {
                        useColSpanStyle: true,
                        groupHeaders: [{
                            startColumnName: 'jet',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TALLER</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'jec',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(135, 244, 252); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CAMPO</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'jetot',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(153, 250, 169); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TOTAL</center></td></tr>' +
                                '</table>',
                        },
                        ]
                    });



                    $("#tabla12").jqGrid('setFrozenColumns');



                    $.post("https://utitalco.com/calidad/028/vbk/weldbook/server/cJuntasEquiposPlanEje.php", { fecha: fechabuscar }, function (resp) {
                        datos = resp.prog;
                        data = resp
                        console.log(resp)

                        $("#tabla13").jqGrid({
                            datatype: 'local',
                            regional: 'es', // this is default
                            data: datos,
                            colModel: [{
                                name: "equipo",
                                label: "EQUIPO",
                                width: 150,
                                frozen: true
                            },
                            {
                                name: "plano",
                                label: "PLANO",
                                width: 200,
                                frozen: true
                            },
                            {
                                name: "pulgadas",
                                label: "PULG",
                                width: 70,
                                align: "center",
                                frozen: true
                            },
                            {
                                name: "jet",
                                label: "JUNTAS <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum"
                            },

                            {
                                name: "pet",
                                label: "PULG DIAM <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum"
                            },



                            {
                                name: "jec",
                                label: "JUNTAS <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum"
                            },


                            {
                                name: "pec",
                                label: "PULG DIAM <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum"
                            },

                            {
                                name: "jetot",
                                label: "JUNTAS <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum"
                            },


                            {
                                name: "petot",
                                label: "PULG DIAM <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum"
                            },

                            ],
                            loadonce: true,
                            shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                            width: 900,
                            height: 200,
                            rowNum: 1000,
                            pager: "#jqGridPager2",

                            grouping: true,
                            groupingView: {
                                groupField: ["equipo"],
                                groupColumnShow: [true],
                                groupText: ["<b>{0}</b>"],
                                groupOrder: ["asc"],
                                groupSummary: [true],
                                groupSummaryPos: ['header'],
                                groupCollapse: false
                            }
                        });

                        $("#tabla13").jqGrid('setGroupHeaders', {
                            useColSpanStyle: true,
                            groupHeaders: [{
                                startColumnName: 'jet',
                                numberOfColumns: 2,
                                titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                    '<tr><td id="h0" style="color: #000;"><center>TALLER</center></td></tr>' +
                                    '</table>',
                            },
                            {
                                startColumnName: 'jec',
                                numberOfColumns: 2,
                                titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(135, 244, 252); border-style: solid; border-color: #b1b1b1 !important ">' +
                                    '<tr><td id="h0" style="color: #000;"><center>CAMPO</center></td></tr>' +
                                    '</table>',
                            },
                            {
                                startColumnName: 'jetot',
                                numberOfColumns: 2,
                                titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(153, 250, 169); border-style: solid; border-color: #b1b1b1 !important ">' +
                                    '<tr><td id="h0" style="color: #000;"><center>TOTAL</center></td></tr>' +
                                    '</table>',
                            },
                            ]
                        });



                        $("#tabla13").jqGrid('setFrozenColumns');

                        $('#cantsoldVisco').html(data.cantsold)
                        $('#rendVisco').html(data.rend + ' Pulg ')





                    })

                    var totj = 0;
                    var totp = 0;


                    for (var i = 0; i < datos.length; i++) {

                        totj += datos[i].jetot;
                        totp += datos[i].petot;
                        console.log(totj)
                    }

                    $('#totjuntasVisco').html(totj)
                    $('#totpulgVisco').html(totp)





                }






            });
        }

        function cargarAvanceDiarioDemex() {

            $('#fechac').val(fechabuscar)

            $.post("https://utitalco.com/calidad/028/demex/weldbook/server/cJuntasEquiposEje.php", { fecha: fechabuscar }, function (resp) {
                datos = resp;

                if (datos == null) {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'info',
                        title: 'Sin registros...',
                        showConfirmButton: false,
                        timer: 1500
                    })
                } else {


                    $("#tabla10").jqGrid({
                        datatype: 'local',
                        regional: 'es', // this is default
                        data: datos,
                        colModel: [{
                            name: "especialidad",
                            label: "ESPECIALIDAD",
                            width: 150,
                            frozen: true
                        },
                        {
                            name: "equipo",
                            label: "EQUIPO",
                            width: 200,
                            frozen: true
                        },
                        {
                            name: "pulgadas",
                            label: "PULG",
                            width: 70,
                            align: "center",
                            frozen: true
                        },
                        {
                            name: "jet",
                            label: "JUNTAS <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum"
                        },

                        {
                            name: "pet",
                            label: "PULG DIAM <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum"
                        },



                        {
                            name: "jec",
                            label: "JUNTAS <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum"
                        },


                        {
                            name: "pec",
                            label: "PULG DIAM <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum"
                        },

                        {
                            name: "jetot",
                            label: "JUNTAS <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum"
                        },


                        {
                            name: "petot",
                            label: "PULG DIAM <br> EJE",
                            width: 70,
                            align: "center",
                            summaryTpl: "<b>{0}</b>",
                            summaryType: "sum"
                        },

                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: 900,
                        height: 200,
                        rowNum: 1000,
                        pager: "#jqGridPager",

                        grouping: true,
                        groupingView: {
                            groupField: ["especialidad"],
                            groupColumnShow: [true],
                            groupText: ["<b>{0}</b>"],
                            groupOrder: ["asc"],
                            groupSummary: [true],
                            groupSummaryPos: ['header'],
                            groupCollapse: false
                        }
                    });

                    $("#tabla10").jqGrid('setGroupHeaders', {
                        useColSpanStyle: true,
                        groupHeaders: [{
                            startColumnName: 'jet',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TALLER</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'jec',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(135, 244, 252); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CAMPO</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'jetot',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(153, 250, 169); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TOTAL</center></td></tr>' +
                                '</table>',
                        },
                        ]
                    });



                    $("#tabla10").jqGrid('setFrozenColumns');



                    $.post("https://utitalco.com/calidad/028/demex/weldbook/server/cJuntasEquiposPlanEje.php", { fecha: fechabuscar }, function (resp) {
                        datos = resp.prog;
                        data = resp
                        console.log(resp)

                        $("#tabla11").jqGrid({
                            datatype: 'local',
                            regional: 'es', // this is default
                            data: datos,
                            colModel: [{
                                name: "equipo",
                                label: "EQUIPO",
                                width: 150,
                                frozen: true
                            },
                            {
                                name: "plano",
                                label: "PLANO",
                                width: 200,
                                frozen: true
                            },
                            {
                                name: "pulgadas",
                                label: "PULG",
                                width: 70,
                                align: "center",
                                frozen: true
                            },
                            {
                                name: "jet",
                                label: "JUNTAS <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum"
                            },

                            {
                                name: "pet",
                                label: "PULG DIAM <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum"
                            },



                            {
                                name: "jec",
                                label: "JUNTAS <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum"
                            },


                            {
                                name: "pec",
                                label: "PULG DIAM <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum"
                            },

                            {
                                name: "jetot",
                                label: "JUNTAS <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum"
                            },


                            {
                                name: "petot",
                                label: "PULG DIAM <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum"
                            },

                            ],
                            loadonce: true,
                            shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                            width: 900,
                            height: 200,
                            rowNum: 1000,
                            pager: "#jqGridPager2",

                            grouping: true,
                            groupingView: {
                                groupField: ["equipo"],
                                groupColumnShow: [true],
                                groupText: ["<b>{0}</b>"],
                                groupOrder: ["asc"],
                                groupSummary: [true],
                                groupSummaryPos: ['header'],
                                groupCollapse: false
                            }
                        });

                        $("#tabla11").jqGrid('setGroupHeaders', {
                            useColSpanStyle: true,
                            groupHeaders: [{
                                startColumnName: 'jet',
                                numberOfColumns: 2,
                                titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                    '<tr><td id="h0" style="color: #000;"><center>TALLER</center></td></tr>' +
                                    '</table>',
                            },
                            {
                                startColumnName: 'jec',
                                numberOfColumns: 2,
                                titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(135, 244, 252); border-style: solid; border-color: #b1b1b1 !important ">' +
                                    '<tr><td id="h0" style="color: #000;"><center>CAMPO</center></td></tr>' +
                                    '</table>',
                            },
                            {
                                startColumnName: 'jetot',
                                numberOfColumns: 2,
                                titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(153, 250, 169); border-style: solid; border-color: #b1b1b1 !important ">' +
                                    '<tr><td id="h0" style="color: #000;"><center>TOTAL</center></td></tr>' +
                                    '</table>',
                            },
                            ]
                        });



                        $("#tabla11").jqGrid('setFrozenColumns');

                        $('#cantsoldDemex').html(data.cantsold)
                        $('#rendDemex').html(data.rend + ' Pulg ')





                    })

                    var totj = 0;
                    var totp = 0;


                    for (var i = 0; i < datos.length; i++) {

                        totj += datos[i].jetot;
                        totp += datos[i].petot;
                        console.log(totj)
                    }

                    $('#totjuntasDemex').html(totj)
                    $('#totpulgDemex').html(totp)





                }






            });
        }


        function cargarInformeMiscDemex() {


            $.post("https://utitalco.com/calidad/028/demex/weldbook/server/cargarDatosCCMisc.php", function (resp) {
                datos = resp;

                console.log(datos);

                $("#tabla16").jqGrid({
                    datatype: 'local',
                    regional: 'es', // this is default
                    data: datos,
                    colModel: [
                        { name: "item", label: "ITEM", width: 250, frozen: true, align: "center" },
                        { name: "equipo", label: "EQUIPO", width: 200, frozen: true, align: "center" },
                        { name: "actividad", label: "ACTIVIDAD", width: 300,  },
                        { name: "miscelaneo", label: "MISCELANEO", width: 140,  align: "center" },
                        { name: "cvalvbplan", label: "PLAN", width: 50, align: "center" },
                        { name: "cvalvbeje", label: "EJE", width: 50, align: "center"},
                        { name: "cvalvbpor", label: "%", width: 50, align: "center" },
                        { name: "cvalvcbplan", label: "PLAN", width: 50, align: "center" },
                        { name: "cvalvcbeje", label: "EJE", width: 50, align: "center"},
                        { name: "cvalvcbpor", label: "%", width: 50, align: "center" },
                        { name: "cvalvibplan", label: "PLAN", width: 50, align: "center" },
                        { name: "cvalvibeje", label: "EJE", width: 50, align: "center"},
                        { name: "cvalvibpor", label: "%", width: 50, align: "center" },
                        { name: "mttovalvoplan", label: "PLAN", width: 50, align: "center"  },
                        { name: "mttovalvoeje", label: "EJE", width: 50, align: "center"},
                        { name: "mttovalvopor", label: "%", width: 50, align: "center" },
                        { name: "mttocambvalvplan", label: "PLAN", width: 50, align: "center" },
                        { name: "mttocambvalveje", label: "EJE", width: 50, align: "center"},
                        { name: "mttocambvalvpor", label: "%", width: 50, align: "center" },
                        { name: "totprog", label: "TOTAL <br>PROG", width: 50, align: "center" },
                        { name: "toteje", label: "TOTAL <br>EJE", width: 50, align: "center"},
                        { name: "totpor", label: "%", width: 50, align: "center" }
                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: ventana_ancho,
                    height: ventana_alto,
                    rowNum: 1000,
                    pager: "#jqGridPager",

                    // grouping: true,
                    //     groupingView: {
                    //         groupField: ["item"],
                    //         groupColumnShow: [true],
                    //         groupText: ["<b>{0}</b>"],
                    //         groupOrder: [false],
                    //         groupSummary: [true],
                    //         groupSummaryPos: ["header"],
                    //         groupCollapse: true,
                    //     },
                });

                // $("#tabla16").jqGrid('filterToolbar',
                //     { autoSearch: true, searchOnEnter: false, });


                $("#tabla16").jqGrid('setGroupHeaders', {
                    useColSpanStyle: true,
                    groupHeaders: [
                        {
                            startColumnName: 'cvalvbplan',
                            numberOfColumns: 3,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CAMBIO DE VÁLVULAS <br> DE BLOQUE</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'cvalvcbplan',
                            numberOfColumns: 3,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CAMBIO DE VÁLVULAS <br> COMPUESTA</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'cvalvibplan',
                            numberOfColumns: 3,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>INSPECCIÓN PUNTOS <br> DE INYECCIÓN</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'mttovalvoplan',
                            numberOfColumns: 3,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>MTTO A VÁLVULAS <br> ORBIT</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'mttocambvalvplan',
                            numberOfColumns: 3,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>MTTO O CAMBIO DE <br> VÁLVULAS DE 36"</center></td></tr>' +
                                '</table>',
                        },
                        
                        {
                            startColumnName: 'totprog',
                            numberOfColumns: 3,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>AVANCE GENERAL</center></td></tr>' +
                                '</table>',
                        },

                    ]
                });

                $("#tabla16").jqGrid('setFrozenColumns');

                cargarGraficaMiscDemex();
            });
        }

        function cargarGraficaMiscDemex() {

            

            Highcharts.chart("fig9", {
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",
                
                },
                title: {
                    text: "<b>AVANCE MISCELANEOS</b>",
                },

                xAxis: {
                    categories: ["CAMBIO DE VALVULAS DE BLOQUE", "CAMBIO DE VALVULAS DE COMPUERTA", "INSPECCIÓN PUNTOS DE INYECCIÓN", "MTTO A VÁLVULAS ORBIT", 
                         'MTTO O CAMBIO DE VALVULA 36"','AVANCE GENERAL'
                    ],
                    crosshair: true,
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                        name: "PROG",
                        data: [datos[0].cvalvbplan, datos[0].cvalvcplan, datos[0].cvalviplan, datos[0].mttovalvoplan, datos[0].mttocambvalvplan,
                        datos[0].totprog
                        ],
                    },
                    {
                        name: "EJECUTADAS",
                        data: [datos[0].cvalvbeje, datos[0].cvalvceje, datos[0].cvalvieje, datos[0].mttovalvoeje, datos[0].mttocambvalveje,
                        datos[0].toteje
                        ],
                    }
                ],
            });


        }



        function cargarInformeValvulasDemex() {
            cargandoPag();

            $.post("https://utitalco.com/calidad/028/demex/weldbook/server/cargarDatosCCValvulas.php", function (resp) {
                datos = resp;

                console.log(datos);

                $("#tabla17").jqGrid({
                    datatype: 'local',
                    regional: 'es', // this is default
                    data: datos,
                    colModel: [

                        { name: "item", label: "ID <br><br>.", width: 50, frozen: true },
                        { name: "tag", label: "TAG <br><br>.", width: 100, frozen: true },
                        { name: "retiro", label: "RETIRO DE LA <br> VÁLVULA", width: 80, align: "center" },
                        { name: "instbridas", label: "INSTALACIÓN <br> BRIDAS CIEGAS", width: 80, align: "center" },
                        { name: "trastaller", label: "TRASLADO A <br>TALLER PARA <br>MANTENIM.", width: 80, align: "center" },
                        { name: "retvalvulataller", label: "RETIRO DE VÁLVULA <br>DEL TALLER <br>REGISTRO DEL MTTO <br>DEL TALLER DE VAL.", width: 80, align: "center" },
                        { name: "instvalvula", label: "INSTALAR <br>VÁLVULA", width: 80, align: "center" },
                        { name: "etiqueta", label: "ETIQUETA <br>DE BRIDA", width: 80, align: "center" },
                        { name: "rca", label: "RCA", width: 80, align: "center" },
                        { name: "observaciones", label: "OBSERVACIONES", width: 300, align: "center" },



                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: ventana_ancho,
                    height: ventana_alto,
                    rowNum: 1000,
                    pager: "#jqGridPager"
                });

                $("#tabla17").jqGrid('filterToolbar',
                    { autoSearch: true, searchOnEnter: false, });

                $("#tabla17").jqGrid('setFrozenColumns');

                cargarRepValvDemex();
            });
        }

        function cargarRepValvDemex() {
            $.post("https://utitalco.com/calidad/028/demex/weldbook/server/repCCValvulas.php", function (resp) {
                datos = resp;
                console.log(datos)


                cargarGraficasValvDemex()




            });
        }

        function cargarGraficasValvDemex() {


            Highcharts.chart("fig10", {
                colors: [
                    "#7cb5ec",
                    "#90ed7d",
                    "#9a9a9c",
                    "#f7a35c",
                    "#8085e9",
                    "#f15c80",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",

                    // options3d: {
                    //     enabled: true,
                    //     alpha: 15,
                    //     beta: 15,
                    //     viewDistance: 25,
                    //     depth: 40
                    // }
                },
                title: {
                    text: "<b>AVANCE VÁLVULAS DEMEX</b>",
                },

                xAxis: {
                    categories: ["RETIRO DE VÁLVULA", "INSTALACIÓN BRIDA CIEGA", "TRASLADO A TALLER", "RETIRO DE TALLER",
                        "INSTALAR VÁLVULA", "ETIQUETA DE BRIDA", "RCA"
                    ],
                    crosshair: true,
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                    name: "PROG",
                    data: [datos.retiroprog, datos.instbridasprog, datos.trastalletprog, datos.retvalvulatallerprog, datos.instvalvulaprog,
                    datos.etiquetaprog, datos.rcaprog
                    ],
                },
                {
                    name: "EJECUTADAS",
                    data: [datos.retiroeje, datos.instbridaseje, datos.trastalleteje, datos.retvalvulatallereje, datos.instvalvulaeje,
                    datos.etiquetaeje, datos.rcaeje
                    ],
                }
                ],
            });


        }


        function cargarInformeValvulasVisco() {
            cargandoPag();

            $.post("https://utitalco.com/calidad/028/vbk/weldbook/server/cargarDatosCCValvulas.php", function (resp) {
                datos = resp;

                console.log(datos);

                $("#tabla18").jqGrid({
                    datatype: 'local',
                    regional: 'es', // this is default
                    data: datos,
                    colModel: [

                        { name: "item", label: "ID <br><br>.", width: 50, frozen: true },
                        { name: "tag", label: "TAG <br><br>.", width: 100, frozen: true },
                        { name: "retiro", label: "RETIRO DE LA <br> VÁLVULA", width: 80, align: "center" },
                        { name: "instbridas", label: "INSTALACIÓN <br> BRIDAS CIEGAS", width: 80, align: "center" },
                        { name: "trastaller", label: "TRASLADO A <br>TALLER PARA <br>MANTENIM.", width: 80, align: "center" },
                        { name: "retvalvulataller", label: "RETIRO DE VÁLVULA <br>DEL TALLER <br>REGISTRO DEL MTTO <br>DEL TALLER DE VAL.", width: 80, align: "center" },
                        { name: "instvalvula", label: "INSTALAR <br>VÁLVULA", width: 80, align: "center" },
                        { name: "etiqueta", label: "ETIQUETA <br>DE BRIDA", width: 80, align: "center" },
                        { name: "rca", label: "RCA", width: 80, align: "center" },
                        { name: "observaciones", label: "OBSERVACIONES", width: 300, align: "center" },



                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: ventana_ancho,
                    height: 200,
                    rowNum: 1000,
                    pager: "#jqGridPager"
                });

                $("#tabla18").jqGrid('filterToolbar',
                    { autoSearch: true, searchOnEnter: false, });

                $("#tabla18").jqGrid('setFrozenColumns');

                cargarRepValvVisco();
            });
        }

        function cargarRepValvVisco() {
            $.post("https://utitalco.com/calidad/028/vbk/weldbook/server/repCCValvulas.php", function (resp) {
                datos = resp;
                console.log(datos)


                cargarGraficasValvVisco()




            });
        }

        function cargarGraficasValvVisco() {


            Highcharts.chart("fig11", {
                colors: [
                    "#7cb5ec",
                    "#90ed7d",
                    "#9a9a9c",
                    "#f7a35c",
                    "#8085e9",
                    "#f15c80",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",

                    // options3d: {
                    //     enabled: true,
                    //     alpha: 15,
                    //     beta: 15,
                    //     viewDistance: 25,
                    //     depth: 40
                    // }
                },
                title: {
                    text: "<b>AVANCE VÁLVULAS VISCORREDUCTORA</b>",
                },

                xAxis: {
                    categories: ["RETIRO DE VÁLVULA", "INSTALACIÓN BRIDA CIEGA", "TRASLADO A TALLER", "RETIRO DE TALLER",
                        "INSTALAR VÁLVULA", "ETIQUETA DE BRIDA", "RCA"
                    ],
                    crosshair: true,
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                    name: "PROG",
                    data: [datos.retiroprog, datos.instbridasprog, datos.trastalletprog, datos.retvalvulatallerprog, datos.instvalvulaprog,
                    datos.etiquetaprog, datos.rcaprog
                    ],
                },
                {
                    name: "EJECUTADAS",
                    data: [datos.retiroeje, datos.instbridaseje, datos.trastalleteje, datos.retvalvulatallereje, datos.instvalvulaeje,
                    datos.etiquetaeje, datos.rcaeje
                    ],
                }
                ],
            });


        }

        function cargarInformeTorresDemex() {



            $.post("https://utitalco.com/calidad/028/demex/weldbook/server/cargarDatosCCTorres.php", function (resp) {
                datos = resp;

                console.log(datos);

                $("#tabla19").jqGrid({
                    datatype: 'local',
                    regional: 'es', // this is default
                    data: datos,
                    colModel: [

                        { name: "tag", label: "TAG  <br>.", width: 100, align: "center", frozen: true },
                        { name: "retaislamiento", label: "RETIRAR <br> AISLAMIENTO <br>EXTERNO", width: 80, align: "center" },
                        { name: "instsas", label: "INSTALAR <br> SAS", width: 80, align: "center" },
                        { name: "apertmanholes", label: "APERTURA DE <br>MANHOLES", width: 80, align: "center" },
                        { name: "instfacilidades", label: "INSTALAR <br>FACILIDADES", width: 80, align: "center" },
                        { name: "retirointernos", label: "RETIRO <br>INTERNOS", width: 80, align: "center" },
                        { name: "armarandamios", label: "ARMAR <br>ANDAMIOS <br>INTERNOS", width: 80, align: "center" },
                        { name: "retirolgs", label: "RETIRO <br>LG'S", width: 80, align: "center" },
                        { name: "limpinterna", label: "INTERNA", width: 80, align: "center" },
                        { name: "limpexterna", label: "EXTERNA", width: 80, align: "center" },
                        { name: "inspinterna", label: "INTERNA", width: 80, align: "center" },
                        { name: "inspexterna", label: "EXTERNA", width: 80, align: "center" },
                        { name: "inspend", label: "END", width: 80, align: "center" },
                        { name: "recpostinterna", label: "INTERNA", width: 80, align: "center" },
                        { name: "recpostexterna", label: "EXTERNA", width: 80, align: "center" },
                        { name: "ejerecinterna", label: "INTERNA", width: 80, align: "center" },
                        { name: "ejerecexterna", label: "EXTERNA", width: 80, align: "center" },
                        { name: "phidroserp", label: "PRUEBA <br> HIDROSTÁTICA <br>SERPENTIN", width: 80, align: "center" },
                        { name: "instinternos", label: "INSTALACIÓN <br>INTERNOS", width: 80, align: "center" },
                        { name: "instlgs", label: "INSTALACIÓN <br>LG'S", width: 80, align: "center" },
                        { name: "retirarfac", label: "RETIRAR <br>FACILIDADES", width: 80, align: "center" },
                        { name: "desarmandamios", label: "DESARMAR <br>ANDAMIOS <br>INTERNOS", width: 80, align: "center" },
                        { name: "cierremanholes", label: "CIERRE DE<br> MANHOLES", width: 80, align: "center" },
                        { name: "pintura", label: "PINTURA /<br>AISLAMIENTO", width: 80, align: "center" },
                        { name: "retirosas", label: "RETIRO SAS", width: 80, align: "center" },
                        { name: "limpbases", label: "LIMPIEZA Y <br>PINTURA A <br>BASES DE <br>CONCRETO", width: 80, align: "center" },
                        { name: "etiquetabridas", label: "ETIQUETA <br>DE BRIDAS", width: 80, align: "center" },
                        { name: "rca", label: "REGISTRO DE <br>TRABAJO", width: 80, align: "center" },
                        { name: "observaciones", label: "OBSERVACIONES", width: 500, align: "center" },

                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: ventana_ancho,
                    height: 200,
                    rowNum: 1000,
                    pager: "#jqGridPager"
                });


                $("#tabla19").jqGrid('filterToolbar',
                    { autoSearch: true, searchOnEnter: false, });

                $("#tabla19").jqGrid('setGroupHeaders', {
                    useColSpanStyle: true,
                    groupHeaders: [

                        {
                            startColumnName: 'limpinterna',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>LIMPIEZA</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'inspinterna',
                            numberOfColumns: 3,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>INSPECCIÓN</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'recpostinterna',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>RECOMENDACIÓN TÉCNICA <br>POST-INSPECCIÓN</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'ejerecinterna',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>EJECUCIÓN DE <br>RECOMENDACIÓN TÉCNICA</center></td></tr>' +
                                '</table>',
                        },



                    ]
                });

                $("#tabla19").jqGrid('setFrozenColumns');


            });
        }

        function cargarInformeTorresVisco() {



            $.post("https://utitalco.com/calidad/028/vbk/weldbook/server/cargarDatosCCTorres.php", function (resp) {
                datos = resp;

                console.log(datos);

                $("#tabla20").jqGrid({
                    datatype: 'local',
                    regional: 'es', // this is default
                    data: datos,
                    colModel: [

                        { name: "tag", label: "TAG <br>.", width: 100, align: "center", frozen: true },
                        { name: "retaislamiento", label: "RETIRAR <br> AISLAMIENTO <br>EXTERNO", width: 80, align: "center" },
                        { name: "instsas", label: "INSTALAR <br> SAS", width: 80, align: "center" },
                        { name: "apertmanholes", label: "APERTURA DE <br>MANHOLES", width: 80, align: "center" },
                        { name: "instfacilidades", label: "INSTALAR <br>FACILIDADES", width: 80, align: "center" },
                        { name: "retirointernos", label: "RETIRO <br>INTERNOS", width: 80, align: "center" },
                        { name: "armarandamios", label: "ARMAR <br>ANDAMIOS <br>INTERNOS", width: 80, align: "center" },
                        { name: "retirolgs", label: "RETIRO <br>LG'S", width: 80, align: "center" },
                        { name: "limpinterna", label: "INTERNA", width: 80, align: "center" },
                        { name: "limpexterna", label: "EXTERNA", width: 80, align: "center" },
                        { name: "inspinterna", label: "INTERNA", width: 80, align: "center" },
                        { name: "inspexterna", label: "EXTERNA", width: 80, align: "center" },
                        { name: "inspend", label: "END", width: 80, align: "center" },
                        { name: "recpostinterna", label: "INTERNA", width: 80, align: "center" },
                        { name: "recpostexterna", label: "EXTERNA", width: 80, align: "center" },
                        { name: "ejerecinterna", label: "INTERNA", width: 80, align: "center" },
                        { name: "ejerecexterna", label: "EXTERNA", width: 80, align: "center" },
                        { name: "instlining", label: "INSTALACIÓN <br>LILNING", width: 80, align: "center" },
                        { name: "plining", label: "PRUEBA <br> NEUMÁTICA <br>LINING", width: 80, align: "center" },
                        { name: "instinternos", label: "INSTALACIÓN <br>INTERNOS", width: 80, align: "center" },
                        { name: "mttolgs", label: "MTTO LG'S", width: 80, align: "center" },
                        { name: "instlgs", label: "INSTALACIÓN <br>LG'S", width: 80, align: "center" },
                        { name: "pruebadistri", label: "PRUEBA <br>DISTRIBUIDOR <br>EN PISO", width: 80, align: "center" },
                        { name: "pruebarociado", label: "PRUEBA <br>ROCIADO <br>DISTRIBUIDOR", width: 80, align: "center" },
                        { name: "pruebagoteo", label: "PRUEBA <br>GOTEO DE <br>COLECTOR", width: 80, align: "center" },
                        { name: "retirarfac", label: "RETIRAR <br>FACILIDADES", width: 80, align: "center" },
                        { name: "desarmandamios", label: "DESARMAR <br>ANDAMIOS <br>INTERNOS", width: 80, align: "center" },
                        { name: "cierremanholes", label: "CIERRE DE<br> MANHOLES", width: 80, align: "center" },
                        { name: "pintura", label: "PINTURA /<br>AISLAMIENTO", width: 80, align: "center" },
                        { name: "retirosas", label: "RETIRO SAS", width: 80, align: "center" },
                        { name: "limpbases", label: "LIMPIEZA Y <br>PINTURA A <br>BASES DE <br>CONCRETO", width: 80, align: "center" },
                        { name: "etiquetabridas", label: "ETIQUETA <br>DE BRIDAS", width: 80, align: "center" },
                        { name: "rca", label: "REGISTRO DE <br>TRABAJO", width: 80, align: "center" },
                        { name: "observaciones", label: "OBSERVACIONES", width: 500, align: "center" },

                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: ventana_ancho,
                    height: 200,
                    rowNum: 1000,
                    pager: "#jqGridPager"
                });


                $("#tabla20").jqGrid('filterToolbar',
                    { autoSearch: true, searchOnEnter: false, });

                $("#tabla20").jqGrid('setGroupHeaders', {
                    useColSpanStyle: true,
                    groupHeaders: [

                        {
                            startColumnName: 'limpinterna',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>LIMPIEZA</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'inspinterna',
                            numberOfColumns: 3,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>INSPECCIÓN</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'recpostinterna',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>RECOMENDACIÓN TÉCNICA <br>POST-INSPECCIÓN</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'ejerecinterna',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>EJECUCIÓN DE <br>RECOMENDACIÓN TÉCNICA</center></td></tr>' +
                                '</table>',
                        },



                    ]
                });

                $("#tabla20").jqGrid('setFrozenColumns');


            });
        }


        function cargarInformeRTDemex() {

            $.post("https://utitalco.com/calidad/028/demex/weldbook/server/cargarDatosCCRt.php", function (resp) {
                datos = resp;

                console.log(datos);

                $("#tabla22").jqGrid({
                    datatype: 'local',
                    regional: 'es', // this is default
                    data: datos,
                    colModel: [{
                        name: "cons",
                        label: "CONS.",
                        width: 50,
                        frozen: true
                    },
                    {
                        name: "num",
                        label: "RT No.",
                        width: 50,
                        frozen: true
                    },
                    {
                        name: "estadort",
                        label: "ESTADO POR RT",
                        width: 120,
                        frozen: true
                    },
                    {
                        name: "especialidad",
                        label: "ESPECIALIDAD",
                        width: 120,
                        frozen: true
                    },
                    {
                        name: "espdiagnostico",
                        label: "ESPECIALIDAD <br>POR DIAGNÓSTICO",
                        width: 120,
                        align: "center",
                        frozen: true
                    },
                    {
                        name: "equipo",
                        label: "EQUIPO",
                        width: 100,
                        frozen: true
                    },
                    {
                        name: "componente",
                        label: "COMPONENTE",
                        width: 200,
                        align: "center",
                        frozen: true
                    },
                    {
                        name: "etapa",
                        label: "ETAPA",
                        width: 120,
                    },
                    {
                        name: "descripcion",
                        label: "DESCRIPCIÓN",
                        width: 160,
                        align: "center"
                    },
                    {
                        name: "sk",
                        label: "SK",
                        width: 40,
                        align: "center"
                    },
                    {
                        name: "diagnostico",
                        label: "DIAGNÓSTICO",
                        width: 200,
                        align: "center"
                    },
                    {
                        name: "planeada",
                        label: "PLANEADA",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "costeada",
                        label: "COSTEADA",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "finicio",
                        label: "FECHA <br>INICIO",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "ffin",
                        label: "FECHA <br>FIN",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "estadodiag",
                        label: "ESTADO POR DIAGNÓSTIVO",
                        width: 160,
                        align: "center"
                    },
                    {
                        name: "porceje",
                        label: "PORCENTARJE <br>EJECUCIÓN",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "plp",
                        label: "PLP",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "rx",
                        label: "RX",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "pwht",
                        label: "PWHT",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "dureza",
                        label: "DUREZA",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "rxpostpwht",
                        label: "RX POST PWHT",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "rca",
                        label: "RCA",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "entcostos",
                        label: "ENTREGA  <br>A COSTOS",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "observaciones",
                        label: "OBSERVACIONES",
                        width: 300
                    }
                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: ventana_ancho,
                    height: ventana_alto,
                    rowNum: 1000,
                    pager: "#jqGridPager"
                });

                $("#tabla22").jqGrid('filterToolbar', {
                    autoSearch: true,
                    searchOnEnter: false,
                });


                $("#tabla22").jqGrid('setGroupHeaders', {
                    useColSpanStyle: true,
                    groupHeaders: [{
                        startColumnName: 'plp',
                        numberOfColumns: 6,
                        titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                            '<tr><td id="h0" style="color: #000;"><center>LIBERACIÓN TRABAJAOS</center></td></tr>' +
                            '</table>',
                    },

                    ]
                });

                $("#tabla22").jqGrid('setFrozenColumns');

                cargarGraficaRTDemex()


            });


        }

        function cargarGraficaRTDemex() {

            $.post("https://utitalco.com/calidad/028/demex/weldbook/server/repCCRt.php", function (resp) {
                datos = resp;

                $("#tabla23").jqGrid({
                    datatype: "local",
                    regional: "es", // this is default
                    data: datos.esprt,
                    colModel: [{
                        name: "esp",
                        label: "ESPECIALIDAD",
                        width: 150,
                        frozen: true
                    },
                    {
                        name: "est1",
                        label: "EJECUTADA",
                        width: 80,
                        align: "center",
                        frozen: true
                    },

                    {
                        name: "est2",
                        label: "EN <br> EJECUCIÓN",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },
                    {
                        name: "est3",
                        label: "PDTE <br> EJECUTAR",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },


                    {
                        name: "est4",
                        label: "NA",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },
                    {
                        name: "stot",
                        label: "TOTAL",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },

                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: 600,
                    height: 250,
                    rowNum: 1000,
                    pager: "#jqGridPager",


                });



                $("#tabla23").jqGrid('setFrozenColumns');

                $("#tabla24").jqGrid({
                    datatype: "local",
                    regional: "es", // this is default
                    data: datos.espdiag,
                    colModel: [{
                        name: "esp",
                        label: "ESPECIALIDAD",
                        width: 150,
                        frozen: true
                    },
                    {
                        name: "est1",
                        label: "EJECUTADA",
                        width: 80,
                        align: "center",
                        frozen: true
                    },

                    {
                        name: "est2",
                        label: "EN <br> EJECUCIÓN",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },
                    {
                        name: "est3",
                        label: "PDTE <br> EJECUTAR",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },


                    {
                        name: "est4",
                        label: "NA",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },
                    {
                        name: "stot",
                        label: "TOTAL",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },

                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: 600,
                    height: 250,
                    rowNum: 1000,
                    pager: "#jqGridPager",


                });



                $("#tabla24").jqGrid('setFrozenColumns');

                for (var i = 0; i < datos.esprt.length; i++) {

                    esp.push(datos.esprt[i].esp)

                    est1.push(datos.esprt[i].est1)
                    est2.push(datos.esprt[i].est2)
                    est3.push(datos.esprt[i].est3)
                    est4.push(datos.esprt[i].est4)
                    stot.push(datos.esprt[i].stot)

                }


                Highcharts.chart('fig14', {
                    credits: {
                        enabled: false,
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: 'ESTADO POR RT'
                    },

                    xAxis: {
                        categories: esp,
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: ''
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:.f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                format: '{point.y:.f}'
                            },
                        },
                    },
                    series: [{
                        name: 'EJECUTADA',
                        data: est1

                    }, {
                        name: 'EN EJECUCIÓN',
                        data: est2

                    }, {
                        name: 'PDTE EJECUTAR',
                        data: est3

                    }, {
                        name: 'NA',
                        data: est4

                    }, {
                        name: 'TOTAL',
                        data: stot

                    }
                    ]
                });

                esp = []
                est1 = []
                est2 = []
                est3 = []
                est4 = []
                stot = []

                for (var i = 0; i < datos.espdiag.length; i++) {

                    esp.push(datos.espdiag[i].esp)

                    est1.push(datos.espdiag[i].est1)
                    est2.push(datos.espdiag[i].est2)
                    est3.push(datos.espdiag[i].est3)
                    est4.push(datos.espdiag[i].est4)
                    stot.push(datos.espdiag[i].stot)


                }


                Highcharts.chart('fig15', {
                    credits: {
                        enabled: false,
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: 'ESTADO POR DIÁGNOSTICO'
                    },

                    xAxis: {
                        categories: esp,
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: ''
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:.f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                format: '{point.y:.f}'
                            },
                        },
                    },
                    series: [{
                        name: 'EJECUTADA',
                        data: est1

                    }, {
                        name: 'EN EJECUCIÓN',
                        data: est2

                    }, {
                        name: 'PDTE EJECUTAR',
                        data: est3

                    }, {
                        name: 'NA',
                        data: est4

                    }, {
                        name: 'TOTAL',
                        data: stot

                    }
                    ]
                });






            });

        }

        function cargarInformeRTVisco() {

            $.post("https://utitalco.com/calidad/028/vbk/weldbook/server/cargarDatosCCRt.php", function (resp) {
                datos = resp;

                console.log(datos);

                $("#tabla25").jqGrid({
                    datatype: 'local',
                    regional: 'es', // this is default
                    data: datos,
                    colModel: [{
                        name: "cons",
                        label: "CONS.",
                        width: 50,
                        frozen: true
                    },
                    {
                        name: "num",
                        label: "RT No.",
                        width: 50,
                        frozen: true
                    },
                    {
                        name: "estadort",
                        label: "ESTADO POR RT",
                        width: 120,
                        frozen: true
                    },
                    {
                        name: "especialidad",
                        label: "ESPECIALIDAD",
                        width: 120,
                        frozen: true
                    },
                    {
                        name: "espdiagnostico",
                        label: "ESPECIALIDAD <br>POR DIAGNÓSTICO",
                        width: 120,
                        align: "center",
                        frozen: true
                    },
                    {
                        name: "equipo",
                        label: "EQUIPO",
                        width: 100,
                        frozen: true
                    },
                    {
                        name: "componente",
                        label: "COMPONENTE",
                        width: 200,
                        align: "center",
                        frozen: true
                    },
                    {
                        name: "etapa",
                        label: "ETAPA",
                        width: 120,
                    },
                    {
                        name: "descripcion",
                        label: "DESCRIPCIÓN",
                        width: 160,
                        align: "center"
                    },
                    {
                        name: "sk",
                        label: "SK",
                        width: 40,
                        align: "center"
                    },
                    {
                        name: "diagnostico",
                        label: "DIAGNÓSTICO",
                        width: 200,
                        align: "center"
                    },
                    {
                        name: "planeada",
                        label: "PLANEADA",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "costeada",
                        label: "COSTEADA",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "finicio",
                        label: "FECHA <br>INICIO",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "ffin",
                        label: "FECHA <br>FIN",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "estadodiag",
                        label: "ESTADO POR DIAGNÓSTIVO",
                        width: 160,
                        align: "center"
                    },
                    {
                        name: "porceje",
                        label: "PORCENTARJE <br>EJECUCIÓN",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "plp",
                        label: "PLP",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "rx",
                        label: "RX",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "pwht",
                        label: "PWHT",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "dureza",
                        label: "DUREZA",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "rxpostpwht",
                        label: "RX POST PWHT",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "rca",
                        label: "RCA",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "entcostos",
                        label: "ENTREGA  <br>A COSTOS",
                        width: 80,
                        align: "center"
                    },
                    {
                        name: "observaciones",
                        label: "OBSERVACIONES",
                        width: 300
                    }
                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: ventana_ancho,
                    height: ventana_alto,
                    rowNum: 1000,
                    pager: "#jqGridPager"
                });

                $("#tabla25").jqGrid('filterToolbar', {
                    autoSearch: true,
                    searchOnEnter: false,
                });


                $("#tabla25").jqGrid('setGroupHeaders', {
                    useColSpanStyle: true,
                    groupHeaders: [{
                        startColumnName: 'plp',
                        numberOfColumns: 6,
                        titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                            '<tr><td id="h0" style="color: #000;"><center>LIBERACIÓN TRABAJAOS</center></td></tr>' +
                            '</table>',
                    },

                    ]
                });

                $("#tabla25").jqGrid('setFrozenColumns');

                cargarGraficaRTVisco()


            });


        }

        function cargarGraficaRTVisco() {

            $.post("https://utitalco.com/calidad/028/vbk/weldbook/server/repCCRt.php", function (resp) {
                datos = resp;

                $("#tabla26").jqGrid({
                    datatype: "local",
                    regional: "es", // this is default
                    data: datos.esprt,
                    colModel: [{
                        name: "esp",
                        label: "ESPECIALIDAD",
                        width: 150,
                        frozen: true
                    },
                    {
                        name: "est1",
                        label: "EJECUTADA",
                        width: 80,
                        align: "center",
                        frozen: true
                    },

                    {
                        name: "est2",
                        label: "EN <br> EJECUCIÓN",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },
                    {
                        name: "est3",
                        label: "PDTE <br> EJECUTAR",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },


                    {
                        name: "est4",
                        label: "NA",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },
                    {
                        name: "stot",
                        label: "TOTAL",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },

                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: 600,
                    height: 250,
                    rowNum: 1000,
                    pager: "#jqGridPager",


                });



                $("#tabla26").jqGrid('setFrozenColumns');

                $("#tabla27").jqGrid({
                    datatype: "local",
                    regional: "es", // this is default
                    data: datos.espdiag,
                    colModel: [{
                        name: "esp",
                        label: "ESPECIALIDAD",
                        width: 150,
                        frozen: true
                    },
                    {
                        name: "est1",
                        label: "EJECUTADA",
                        width: 80,
                        align: "center",
                        frozen: true
                    },

                    {
                        name: "est2",
                        label: "EN <br> EJECUCIÓN",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },
                    {
                        name: "est3",
                        label: "PDTE <br> EJECUTAR",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },


                    {
                        name: "est4",
                        label: "NA",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },
                    {
                        name: "stot",
                        label: "TOTAL",
                        width: 80,
                        align: "center",
                        summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                        summaryType: "sum",
                    },

                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: 600,
                    height: 250,
                    rowNum: 1000,
                    pager: "#jqGridPager",


                });



                $("#tabla27").jqGrid('setFrozenColumns');

                for (var i = 0; i < datos.esprt.length; i++) {

                    esp.push(datos.esprt[i].esp)

                    est1.push(datos.esprt[i].est1)
                    est2.push(datos.esprt[i].est2)
                    est3.push(datos.esprt[i].est3)
                    est4.push(datos.esprt[i].est4)
                    stot.push(datos.esprt[i].stot)

                }


                Highcharts.chart('fig16', {
                    credits: {
                        enabled: false,
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: 'ESTADO POR RT'
                    },

                    xAxis: {
                        categories: esp,
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: ''
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:.f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                format: '{point.y:.f}'
                            },
                        },
                    },
                    series: [{
                        name: 'EJECUTADA',
                        data: est1

                    }, {
                        name: 'EN EJECUCIÓN',
                        data: est2

                    }, {
                        name: 'PDTE EJECUTAR',
                        data: est3

                    }, {
                        name: 'NA',
                        data: est4

                    }, {
                        name: 'TOTAL',
                        data: stot

                    }
                    ]
                });

                esp = []
                est1 = []
                est2 = []
                est3 = []
                est4 = []
                stot = []

                for (var i = 0; i < datos.espdiag.length; i++) {

                    esp.push(datos.espdiag[i].esp)

                    est1.push(datos.espdiag[i].est1)
                    est2.push(datos.espdiag[i].est2)
                    est3.push(datos.espdiag[i].est3)
                    est4.push(datos.espdiag[i].est4)
                    stot.push(datos.espdiag[i].stot)


                }


                Highcharts.chart('fig17', {
                    credits: {
                        enabled: false,
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: 'ESTADO POR DIÁGNOSTICO'
                    },

                    xAxis: {
                        categories: esp,
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: ''
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:.f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                format: '{point.y:.f}'
                            },
                        },
                    },
                    series: [{
                        name: 'EJECUTADA',
                        data: est1

                    }, {
                        name: 'EN EJECUCIÓN',
                        data: est2

                    }, {
                        name: 'PDTE EJECUTAR',
                        data: est3

                    }, {
                        name: 'NA',
                        data: est4

                    }, {
                        name: 'TOTAL',
                        data: stot

                    }
                    ]
                });


            });


            Swal.close();
        }


        function cargarInformeHornosDemex() {



            $.post("https://utitalco.com/calidad/028/demex/weldbook/server/cargarDatosCCHornos.php", function (resp) {
                datos = resp;

                console.log('CC Hornos')
                console.log(datos);

                $("#tablaHD").jqGrid({
                    datatype: 'local',
                    regional: 'es', // this is default
                    data: datos,
                    colModel: [

                        { name: "equipo", label: "EQUIPO  <br>.", width: 100, align: "center", frozen: true },
                        { name: "instsas", label: "INSTALAR <br> SAS", width: 80, align: "center" },
                        { name: "aperturamanhol", label: "APERTURA DE <br>MANHOLES", width: 80, align: "center" },
                        { name: "instfacilidades", label: "INSTALAR <br>FACILIDADES", width: 80, align: "center" },
                        { name: "armarandamiosint", label: "ARMAR <br>ANDAMIOS <br>INTERNOS", width: 80, align: "center" },
                        { name: "cortenorteplan", label: "NORTE  <br>PLAN", width: 80, align: "center" },
                        { name: "cortenorteeje", label: "NORTE <br>EJEC", width: 80, align: "center" },
                        { name: "cortesurplan", label: "SUR <br>PLAN", width: 80, align: "center" },
                        { name: "contesureje", label: "SUR <br>EJE", width: 80, align: "center" },
                        { name: "demnorteplan", label: "NORTE <br>PLAN", width: 80, align: "center" },
                        { name: "demnorteeje", label: "NORTE <br>EJE", width: 80, align: "center" },
                        { name: "demsurplan", label: "SUR <br>PLAN", width: 80, align: "center" },
                        { name: "demsureje", label: "SUR <br>EJE", width: 80, align: "center" },
                        { name: "limpinterna", label: "INTERNA", width: 80, align: "center" },
                        { name: "limpexterna", label: "EXTERNA", width: 80, align: "center" },
                        { name: "inspinterna", label: "INTERNA", width: 80, align: "center" },
                        { name: "inspexterna", label: "EXTERNA", width: 80, align: "center" },
                        { name: "recompostint", label: "INTERNA", width: 80, align: "center" },
                        { name: "recompostext", label: "EXTERNA", width: 80, align: "center" },
                        { name: "ejerecompostint", label: "INTERNA", width: 80, align: "center" },
                        { name: "ejerecompostext", label: "EXTERNA", width: 80, align: "center" },
                        { name: "ctsoldplan", label: "SOLDADURA <br>PLAN", width: 80, align: "center" },
                        { name: "ctsoldeje", label: "SOLDADURA <br>EJE", width: 80, align: "center" },
                        { name: "ctrxpreplan", label: "RX PRE <br>PLAN", width: 80, align: "center" },
                        { name: "ctrxpreeje", label: "RX PRE <br>EJE", width: 80, align: "center" },

                        { name: "ctpwhtplan", label: "PWHT <br>PLAN", width: 80, align: "center" },
                        { name: "ctpwhteje", label: "PWHT <br>EJE", width: 80, align: "center" },
                        { name: "ctrxpostplan", label: "RX POST <br>PLAN", width: 80, align: "center" },
                        { name: "ctrxposteje", label: "RX POST <br>EJE", width: 80, align: "center" },
                        { name: "instmodnorteplan", label: "NORTE <br>PLAN", width: 80, align: "center" },
                        { name: "instmodnorteeje", label: "NORTE <br>EJE", width: 80, align: "center" },
                        { name: "instmodsurplan", label: "SUR <br>PLAN", width: 80, align: "center" },
                        { name: "instmodsureje", label: "SUR <br>EJE", width: 80, align: "center" },
                        { name: "instcasnorteplan", label: "NORTE <br>PLAN", width: 80, align: "center" },
                        { name: "instcasnorteeje", label: "NORTE <br>EJE", width: 80, align: "center" },
                        { name: "instcassurplan", label: "SUR <br>PLAN", width: 80, align: "center" },
                        { name: "instcassureje", label: "SUR <br>EJE", width: 80, align: "center" },
                        { name: "phserpen", label: "PH DE  <br>SERPENTIN", width: 80, align: "center" },
                        { name: "instinternos", label: "INSTALACIÓN <br>INTERNOS", width: 80, align: "center" },
                        { name: "retfacilidades", label: "RETIRO <br>FACILIDADES", width: 80, align: "center" },
                        { name: "desandamiosinter", label: "DESARMAR <br>ANDAMIOS <br>INTERNOS", width: 80, align: "center" },
                        { name: "cierremanhol", label: "CIERRE DE <br> MANHOLES", width: 80, align: "center" },
                        { name: "pintura", label: "PINTURA / <br>AISLAMIENTO", width: 80, align: "center" },
                        { name: "retirosas", label: "RETIRO SAS", width: 80, align: "center" },
                        { name: "limpiezapintura", label: "LIMPIEZA Y <br> PINTURA A <br>BASE DE <br>CONCRETO", width: 80, align: "center" },

                        { name: "etiquetabridas", label: "ETIQUETA <br>DE BRIDAS", width: 80, align: "center" },
                        { name: "rca", label: "REGISTRO DE <br>TRABAJO", width: 80, align: "center" },
                        { name: "observaciones", label: "OBSERVACIONES", width: 500, align: "center" },

                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: ventana_ancho,
                    height: ventana_alto,
                    rowNum: 1000,
                    pager: "#jqGridPager"
                });



                $("#tablaHD").jqGrid('filterToolbar',
                    { autoSearch: true, searchOnEnter: false, });

                $("#tablaHD").jqGrid('setGroupHeaders', {
                    useColSpanStyle: true,
                    groupHeaders: [

                        {
                            startColumnName: 'cortenorteplan',
                            numberOfColumns: 4,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CORTE DE CASING <br>CONVENCCIÓN</center></td></tr>' +
                                '</table>',
                        },

                        {
                            startColumnName: 'demnorteplan',
                            numberOfColumns: 4,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>DEMOLICIÓN DE <br> REFRACTARIO</center></td></tr>' +
                                '</table>',
                        },


                        {
                            startColumnName: 'limpinterna',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center> <br>LIMPIEZA</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'inspinterna',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center><br>INSPECCIÓN</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'recompostint',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>RECOMENDACIÓN TÉCNICA <br>POST-INSPECCIÓN</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'ejerecompostint',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>EJECUCIÓN DE <br>RECOMENDACIÓN TÉCNICA</center></td></tr>' +
                                '</table>',
                        },

                        {
                            startColumnName: 'ctsoldplan',
                            numberOfColumns: 8,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CAMBIO DE <br>TUBERÍA</center></td></tr>' +
                                '</table>',
                        },

                        {
                            startColumnName: 'instmodnorteplan',
                            numberOfColumns: 4,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CAMBIO DE <br>TUBERÍA</center></td></tr>' +
                                '</table>',
                        },

                        {
                            startColumnName: 'instcasnorteplan',
                            numberOfColumns: 4,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CAMBIO DE <br>TUBERÍA</center></td></tr>' +
                                '</table>',
                        },




                    ]
                });





                $("#tablaHD").jqGrid('setFrozenColumns');





            });
        }

    </script>
</body>

</html>
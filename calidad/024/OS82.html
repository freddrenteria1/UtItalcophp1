<!DOCTYPE html>

<html>
<head>
	
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title>RCA - UT ITALCO</title>
	<meta name="generator" content="LibreOffice 7.3.2.2 (Linux)"/>
	<meta name="author" content="c4326540"/>
	<meta name="created" content="2004-08-06T00:07:02"/>
	<meta name="changedby" content="Jairo Cruz"/>
	<meta name="changed" content="2022-08-16T15:37:00"/>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">

	
	<style type="text/css">
		body,div,table,thead,tbody,tfoot,tr,th,td,p { font-family:"Arial"; font-size:x-small }
		a.comment-indicator:hover + comment { background:#ffd; position:absolute; display:block; border:1px solid black; padding:0.5em;  } 
		a.comment-indicator { background:red; display:inline-block; border:1px solid black; width:0.5em; height:0.5em;  } 
		comment { display:none;  } 
	</style>


	<style type="text/css">
		body,
		div,
		table,
		thead,
		tbody,
		tfoot,
		tr,
		th,
		td,
		p {
			font-family: "Arial";
			font-size: x-small
		}
		
		a.comment-indicator:hover+comment {
			background: #ffd;
			position: absolute;
			display: block;
			border: 1px solid black;
			padding: 0.5em;
		}
		
		a.comment-indicator {
			background: red;
			display: inline-block;
			border: 1px solid black;
			width: 0.5em;
			height: 0.5em;
		}
		
		comment {
			display: none;
		}
	</style>

	<style>
		@media print {
            .oculto-impresion,
            .oculto-impresion * {
                display: none !important;
            }
        }

		textarea {
			font-size: 18px;
		}
		
		input[type=text] {
			width: 100%;
			padding: 12px;
			margin: 8px 0;
			border: 0;
			box-sizing: border-box;
			font-size: 18px;
			
		}

		.lineabaja{
			border-bottom-style: solid;
			border-bottom-width: 1px;
		}
		
		input[type=date] {
			width: 100%;
			padding: 8px;
			margin: 4px 0;
			border: 0;
			box-sizing: border-box;
			font-size: 18px;

		}
		
		input[type=time] {
			width: 100%;
			padding: 12px;
			margin: 8px 0;
			border: 0;
			box-sizing: border-box;
			font-size: 18px;
		}
		
		input[type=radio] {
			height: 20px;
			width: 20px;
		}
		
		select {
			background: transparent;
			border: none;
			font-size: 18px;
			height: 30px;
			padding: 5px;
			width: 100px;
		}
		
		.oculto {
			display: none;
		}
		
		.visible {
			display: inline;
		}
		
		.cuerpo {
			margin: 0 auto;
		}
	</style>
	
</head>

<body>
<table cellspacing="0" border="0" style="margin: 0 auto; margin-top: 10px; width: 97%;" >
	<colgroup width="84"></colgroup>
	<colgroup width="79"></colgroup>
	<colgroup width="137"></colgroup>
	<colgroup width="142"></colgroup>
	<colgroup width="123"></colgroup>
	<colgroup width="55"></colgroup>
	<colgroup width="106"></colgroup>
	<colgroup width="94"></colgroup>
	<colgroup width="83"></colgroup>
	<colgroup width="93"></colgroup>
	<colgroup width="74"></colgroup>
	<colgroup width="76"></colgroup>
	<colgroup width="98"></colgroup>
	<colgroup width="105"></colgroup>
	<tr>
		<td style="border-top: 2px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 rowspan=3 height="100" align="center"><b><font face="Arial Narrow" size=3 color="#000000"><br><img src="img/logo_m.png" width=186 height=58 hspace=18 vspace=25>
		</font></b></td>
		<td style="border-top: 2px solid #000000; border-bottom: 1px solid #000000" colspan=8 rowspan=3 align="center" valign=middle><b><font face="Arial Narrow" size=4 color="#000000">REGISTRO CONTROL DE ACTIVIDADES CUSTODIA PLÁTINAS DE ORIFICIO</font></b></td>
		<td style="border-top: 2px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=3 align="center" valign=middle><b><font face="Arial Narrow" size=3 color="#000000">FRM-BCA-19.370.3.OS82</font></b></td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=3 align="center" valign=middle><b><font face="Arial Narrow" size=3 color="#000000">Fecha: 20/20/2020</font></b></td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=3 align="center" valign=middle><b><font face="Arial Narrow" size=3 color="#000000">Versión: 0</font></b></td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000" colspan=14 height="33" align="center" valign=middle bgcolor="#969696"><b><font face="Arial Narrow" size=4>INFORMACIÓN GENERAL</font></b></td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=2 height="40" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=3>CONTRATO:</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="center"><font face="Arial Narrow" size=3><span id="contrato">000</span></font></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=2 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=3>UNIDAD:</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=2 align="center" valign=middle><b><font face="Arial Narrow" size=3><span id="unidad">U-2700</span></font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=3>PLANTA: </font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=2 align="center" valign=middle><b><font face="Arial Narrow" size=3><span id="planta">UOP I</span></font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=2 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=3>ORDEN DE SERVICIO:   </font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=2 align="center" valign=middle><b><font face="Arial Narrow" size=3 color="#000000"><span id="ods">024</span></font></b></td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000" colspan=14 height="8" align="left" valign=middle bgcolor="#FFFFFF"><b><font face="Arial Narrow" size=3><br></font></b></td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=2 height="40" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=3>FAMILIA DE EQUIPO:</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=5 align="center" valign=middle><font face="Arial Narrow" size=3>INSTRUMENTOS </font></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=3>TAG:</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=2 align="center" valign=middle><b><font face="Arial Narrow" size=3><span id="tag">000</span></font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=2 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=3>SERIE:</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=2 align="center"><font face="Arial Narrow" size=3><span id="serie">000</span></font></td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000" colspan=14 height="13" align="center" valign=middle bgcolor="#FFFFFF"><font face="Arial Narrow"><br></font></td>
		</tr>
	<tr>
		<td style="border-left: 2px solid #000000" height="40" align="left" valign=middle bgcolor="#FFFFFF"><b><font face="Arial Narrow" size=4>     
			FECHA:  </font></b></td>
		<td colspan=2  align="left" valign=middle bgcolor="#FFFFFF" class="lineabaja">
			<input type="date" class="form-control " id="fecha">
		</td>
		<td align="left" valign=middle bgcolor="#FFFFFF"><font face="Arial Narrow" size=3><br></font></td>
		<td align="left" valign=middle bgcolor="#FFFFFF"><font face="Arial Narrow" size=3><br></font></td>
		<td align="left" valign=middle bgcolor="#FFFFFF"><font face="Arial Narrow" size=3><br></font></td>
		<td align="left" valign=middle><font face="Arial Narrow" size=3 color="#333399"><br></font></td>
		<td align="center" valign=middle bgcolor="#FFFFFF"><b><font face="Arial Narrow" size=4>RATING:</font></b></td>
		<td colspan=5  class="lineabaja" align="left" valign=middle>
			<input type="text" class="form-control " id="rating" >
		</td>
		<td style="border-right: 2px solid #000000" align="left" valign=middle><font face="Arial Narrow" size=3 color="#333399"><br></font></td>
	</tr>
	<tr>
		<td style="border-left: 2px solid #000000" height="40" align="left" bgcolor="#FFFFFF"><b><font face="Arial Narrow" size=4>     
			SERVICIO:    </font></b></td>
		<td class="lineabaja" style="border-right: 2px solid #000000" align="left" valign=middle bgcolor="#FFFFFF" colspan="13">
			<input type="text" class="form-control" id="servicio" >
		</td>
	</tr>
	
	<tr>
		<td style="border-top: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000" colspan=14 height="3" align="center" valign=middle bgcolor="#FFFFFF"><font face="Arial Narrow"><br></font></td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000" colspan=14 height="33" align="center" valign=middle bgcolor="#969696"><b><font face="Arial Narrow" size=4>1. CHECK LIST</font></b></td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000" colspan=14 height="3" align="center" valign=middle><font face="Arial Narrow"><br></font></td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="35" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4 color="#000000">ELEMENTO</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=1 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4 color="#000000">ESTADO INICIAL</font></b></td>
		<td style="border-top: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=1 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4 color="#000000">ESTADO FINAL </font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=10 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4 color="#000000">OBSERVACIONES</font></b></td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="60" align="left" valign=middle><b><font face="Arial Narrow" size=4>ESPARRAGOS</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=1 align="center" valign=middle>
			<select id="item1estinicial">
				<option value=""></option>
				<option value="OK">OK</option>
				<option value="MAL">MAL</option>
				<option value="NA">NA</option>
			</select>
		</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=1 align="center" valign=middle>
			<select id="item1estfinal">
				<option value=""></option>
				<option value="OK">OK</option>
				<option value="MAL">MAL</option>
				<option value="NA">NA</option>
			</select>
		</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=10 align="center" valign=middle>
			<input type="text" class="form-control " id="obsitem1" >
		</td>
	</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="60" align="left" valign=middle><b><font face="Arial Narrow" size=4>EMPAQUES</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=1 align="center" valign=middle>
			<select id="item2estinicial">
				<option value=""></option>
				<option value="OK">OK</option>
				<option value="MAL">MAL</option>
				<option value="NA">NA</option>
			</select>
		</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=1 align="center" valign=middle>
			<select id="item2estfinal">
				<option value=""></option>
				<option value="OK">OK</option>
				<option value="MAL">MAL</option>
				<option value="NA">NA</option>
			</select>
		</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=10 align="center" valign=middle>
			<input type="text" class="form-control " id="obsitem2" >
		</td>
	</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="60" align="left" valign=middle><b><font face="Arial Narrow" size=4>ESTADO GENERAL DE LA PLÁTINA</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=1 align="center" valign=middle>
			<select id="item3estinicial">
				<option value=""></option>
				<option value="OK">OK</option>
				<option value="MAL">MAL</option>
				<option value="NA">NA</option>
			</select>
		</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=1 align="center" valign=middle>
			<select id="item3estfinal">
				<option value=""></option>
				<option value="OK">OK</option>
				<option value="MAL">MAL</option>
				<option value="NA">NA</option>
			</select>
		</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=10 align="center" valign=middle>
			<input type="text" class="form-control " id="obsitem3" >
		</td>
	</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="60" align="left" valign=middle><b><font face="Arial Narrow" size=4>LIMPIEZA</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=1 align="center" valign=middle>
			<select id="item4estinicial">
				<option value=""></option>
				<option value="OK">OK</option>
				<option value="MAL">MAL</option>
				<option value="NA">NA</option>
			</select>
		</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=1 align="center" valign=middle>
			<select id="item4estfinal">
				<option value=""></option>
				<option value="OK">OK</option>
				<option value="MAL">MAL</option>
				<option value="NA">NA</option>
			</select>
		</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=10 align="center" valign=middle>
			<input type="text" class="form-control " id="obsitem4" >
		</td>
	</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="60" align="left" valign=middle><b><font face="Arial Narrow" size=4>AISLAMIENTO</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=1 align="center" valign=middle>
			<select id="item5estinicial">
				<option value=""></option>
				<option value="OK">OK</option>
				<option value="MAL">MAL</option>
				<option value="NA">NA</option>
			</select>
		</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=1 align="center" valign=middle>
			<select id="item5estfinal">
				<option value=""></option>
				<option value="OK">OK</option>
				<option value="MAL">MAL</option>
				<option value="NA">NA</option>
			</select>
		</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=10 align="center" valign=middle>
			<input type="text" class="form-control " id="obsitem5" >
		</td>
	</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000" colspan=14 height="19" align="center" valign=middle bgcolor="#FFFFFF"><b><font face="Arial Narrow"><br></font></b></td>
	</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="47" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>REVISADO POR:</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>FECHA</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>HORA </font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=4 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>NOMBRE</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=3 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>FIRMA</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=2 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>CC/REGISTRO</font></b></td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="48" align="left" valign=middle bgcolor="#FFFFFF"><b><font face="Arial Narrow" size=4>SUPERVISOR  UT ITALCO</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" valign=middle bgcolor="#FFFFFF"><input type="date" id="fecha1" class="ut"></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" valign=middle bgcolor="#FFFFFF"><input type="time" id="hora1" class="ut"></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=4 align="center" valign=middle><input type="text" id="nombre1" class="ut"></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=3 align="center" valign=middle bgcolor="#FFFFFF">
			<button type="button" class="btn btn-info btn-block ut oculto-impresion" id="btnFirmar1" onclick="abrirFirma('1')">Firmar</button>
			<img src="" id="firma1" width="130px" height="50px" class="oculto">
		</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=2 align="center" valign=middle bgcolor="#FFFFFF">
			<input type="text" id="registro1" class="ut">
		</td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="48" align="left" valign=middle><b><font face="Arial Narrow" size=4>GESTOR TÉCNICO ECOPETROL S.A</font></b></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" valign=middle bgcolor="#FFFFFF"><input type="date" id="fecha2" class="ecp"></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" valign=middle bgcolor="#FFFFFF"><input type="time" id="hora2" class="ecp"></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=4 align="center" valign=middle bgcolor="#FFFFFF"><input type="text" id="nombre2" class="ecp"></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=3 align="center" valign=middle bgcolor="#FFFFFF">
			<button type="button" class="btn btn-info btn-block ecp oculto-impresion" id="btnFirmar2" onclick="abrirFirma('2')">Firmar</button>
			<img src="" id="firma2" width="130px" height="50px" class="oculto">
		</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000;  border-right: 2px solid #000000" colspan=2 align="center" valign=middle bgcolor="#FFFFFF">
			<input type="text" id="registro2" class="ecp">
		</td>
		</tr>
	<tr>
		<td style="border-left: 2px solid #000000" height="17" align="left" valign=middle><b><font face="Arial Narrow"><br></font></b></td>
		<td align="justify" valign=middle><b><font face="Arial Narrow"><br></font></b></td>
		<td align="center" valign=middle><b><font face="Arial Narrow"><br></font></b></td>
		<td align="justify" valign=middle><b><font face="Arial Narrow"><br></font></b></td>
		<td align="justify" valign=middle><b><font face="Arial Narrow"><br></font></b></td>
		<td align="justify" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="justify" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="justify" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="justify" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="justify" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="justify" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="justify" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="justify" valign=middle><font face="Arial Narrow"><br></font></td>
		<td style="border-right: 2px solid #000000" align="left"><font face="Arial Narrow"><br></font></td>
	</tr>
	<tr>
		<td style="border-left: 2px solid #000000" height="21" align="left" valign=middle><b><font face="Arial Narrow" size=3><br></font></b></td>
		<td align="left" valign=middle colspan="2"><b><font face="Arial Narrow" size=3>OK: BUEN ESTADO</font></b></td>
		
		<td align="justify" valign=middle><b><font face="Arial Narrow" size=3><br></font></b></td>
		<td align="justify" valign=middle><b><font face="Arial Narrow" size=3><br></font></b></td>
		<td align="left"><font face="Arial Narrow" size=3><br></font></td>
		<td align="left" valign=middle colspan="2"><b><font face="Arial Narrow"  size=3>MAL: MAL ESTADO</font></b></td>
		<td align="justify" valign=middle><b><font face="Arial Narrow" size=3><br></font></b></td>
		<td align="left" valign=middle><b><font face="Arial Narrow" size=3><br></font></b></td>
		<td align="left" valign=middle colspan="2"><b><font face="Arial Narrow" size=3>NA: NO APLICA</font></b></td>
		<td align="left" valign=middle><b><font face="Arial Narrow" size=3><br></font></b></td>
		<td style="border-right: 2px solid #000000" align="left" valign=middle><b><font face="Arial Narrow" size=3><br></font></b></td>
	</tr>
	<tr>
		<td style="border-left: 2px solid #000000" height="17" align="left" valign=middle><b><font face="Arial Narrow"><br></font></b></td>
		<td align="left" valign=middle><b><font face="Arial Narrow"><br></font></b></td>
		<td align="center" valign=middle><b><font face="Arial Narrow"><br></font></b></td>
		<td align="left" valign=middle><b><font face="Arial Narrow"><br></font></b></td>
		<td align="left" valign=middle><b><font face="Arial Narrow"><br></font></b></td>
		<td align="center" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="center" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="center" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="center" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="center" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="center" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="center" valign=middle><font face="Arial Narrow"><br></font></td>
		<td align="center" valign=middle><font face="Arial Narrow"><br></font></td>
		<td style="border-right: 2px solid #000000" align="center" valign=middle><font face="Arial Narrow"><br></font></td>
	</tr>
	<tr>
		<td style="border-left: 2px solid #000000" height="40" align="left" valign=middle><font face="Arial Narrow"><br></font></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=12 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>OBSERVACIONES</font></b> 
			<button type="button" class="btn btn-info btn-sm oculto-impresion" id="btnagregarObs" onclick="agregarObs()">Agregar</button>
			<button type="button" class="btn btn-info btn-sm m-1 oculto-impresion" onclick="adjuntar()">Adjuntar archivo</button>
                <button type="button" class="btn btn-warning btn-sm m-1 oculto-impresion" onclick="verArchivos()">Ver archivos</button>
		</td>
		<td style="border-right: 2px solid #000000" align="left" valign=middle>
			
		</td>
	</tr>
	<tr>
		<td style="border-left: 2px solid #000000" height="40" align="left" valign=middle><font face="Arial Narrow"><br></font></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=12 align="center" valign=middle>
		
			<table id="tblobs" style="width: 100%;" class="oculto">
				<tr>
					<td colspan="4">
						<textarea id="obs7" style="width: 100%;" rows="3" class="activo" placeholder="Observaciones..."></textarea>
					</td>
				</tr>
				<tr>

					<td>
						<input type="text" id="nombre7" placeholder="Nombre" class="activo">
					</td>

					<td style="width: 200px;">
						<input type="text" id="registro7" placeholder="CC/REGISTRO" class="activo">
					</td>
					<td>
						<button type="button" class="btn btn-info btn-block" id="btnFirmar7" onclick="abrirFirma('7')">Firmar</button>
						<img src="" id="firma7" width="130px" height="50px" class="oculto">
					</td>
					<td>

					</td>
				</tr>
			</table>
			
		</td>
		<td style="border-right: 2px solid #000000" align="left" valign=middle><font face="Arial Narrow" size=1><br></font></td>
	</tr>
	
	
	
	<tr>
		<td style=" border-left: 2px solid #000000; border-right: 2px solid #000000" colspan=14 height="33" align="center" valign=middle ><br></td>
	</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000" colspan=14 height="33" align="center" valign=middle bgcolor="#969696"><b><font face="Arial Narrow" size=4>2. ESTADO INCIAL</font></b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="47" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>REVISADO POR:</font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>FECHA</font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>HORA </font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=4 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>NOMBRE</font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=3 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>FIRMA</font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=2 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>CC/REGISTRO</font></b></td>
			</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="48" align="left" valign=middle bgcolor="#FFFFFF"><b><font face="Arial Narrow" size=4>SUPERVISOR  UT ITALCO</font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" valign=middle bgcolor="#FFFFFF"><input type="date" id="fecha3" class="ut"></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" valign=middle bgcolor="#FFFFFF"><input type="time" id="hora3" class="ut"></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=4 align="center" valign=middle><input type="text" id="nombre3" class="ut"></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=3 align="center" valign=middle bgcolor="#FFFFFF">
				<button type="button" class="btn btn-info btn-block ut oculto-impresion" id="btnFirmar3" onclick="abrirFirma('3')">Firmar</button>
				<img src="" id="firma3" width="130px" height="50px" class="oculto">
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=2 align="center" valign=middle bgcolor="#FFFFFF">
				<input type="text" id="registro3" class="ut">
			</td>
			</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="48" align="left" valign=middle><b><font face="Arial Narrow" size=4>OPERACIONES ECOPETROL S.A</font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" valign=middle bgcolor="#FFFFFF"><input type="date" id="fecha4" class="ecp"></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" valign=middle bgcolor="#FFFFFF"><input type="time" id="hora4" class="ecp"></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=4 align="center" valign=middle bgcolor="#FFFFFF"><input type="text" id="nombre4" class="ecp"></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=3 align="center" valign=middle bgcolor="#FFFFFF">
				<button type="button" class="btn btn-info btn-block ecp oculto-impresion" id="btnFirmar4" onclick="abrirFirma('2')">Firmar</button>
				<img src="" id="firma4" width="130px" height="50px" class="oculto">
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000;  border-right: 2px solid #000000" colspan=2 align="center" valign=middle bgcolor="#FFFFFF">
				<input type="text" id="registro4" class="ecp">
			</td>
			</tr>
		
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000" colspan=14 height="22" align="center" valign=middle><b><font face="Arial Narrow" color="#FFFFFF"><br></font></b></td>
		</tr>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000" colspan=14 height="33" align="center" valign=middle bgcolor="#969696"><b><font face="Arial Narrow" size=4>3. ESTADO FINAL</font></b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="47" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>REVISADO POR:</font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>FECHA</font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>HORA </font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=4 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>NOMBRE</font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=3 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>FIRMA</font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=2 align="center" valign=middle bgcolor="#C0C0C0"><b><font face="Arial Narrow" size=4>CC/REGISTRO</font></b></td>
			</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="48" align="left" valign=middle bgcolor="#FFFFFF"><b><font face="Arial Narrow" size=4>SUPERVISOR  UT ITALCO</font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" valign=middle bgcolor="#FFFFFF"><input type="date" id="fecha5" class="ut"></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" valign=middle bgcolor="#FFFFFF"><input type="time" id="hora5" class="ut"></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=4 align="center" valign=middle><input type="text" id="nombre5" class="ut"></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=3 align="center" valign=middle bgcolor="#FFFFFF">
				<button type="button" class="btn btn-info btn-block ut oculto-impresion" id="btnFirmar5" onclick="abrirFirma('5')">Firmar</button>
				<img src="" id="firma5" width="130px" height="50px" class="oculto">
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000" colspan=2 align="center" valign=middle bgcolor="#FFFFFF">
				<input type="text" id="registro5" class="ut">
			</td>
			</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000" colspan=3 height="48" align="left" valign=middle><b><font face="Arial Narrow" size=4>OPERACIONES ECOPETROL S.A</font></b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" valign=middle bgcolor="#FFFFFF"><input type="date" id="fecha6" class="ecp"></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" valign=middle bgcolor="#FFFFFF"><input type="time" id="hora6" class="ecp"></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=4 align="center" valign=middle bgcolor="#FFFFFF"><input type="text" id="nombre6" class="ecp"></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" colspan=3 align="center" valign=middle bgcolor="#FFFFFF">
				<button type="button" class="btn btn-info btn-block ecp oculto-impresion" id="btnFirmar6" onclick="abrirFirma('6')">Firmar</button>
				<img src="" id="firma6" width="130px" height="50px" class="oculto">
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000;  border-right: 2px solid #000000" colspan=2 align="center" valign=middle bgcolor="#FFFFFF">
				<input type="text" id="registro6" class="ecp">
			</td>
			</tr>
	<tr>
		<td colspan=14 height="18" align="center"><font face="Arial Narrow">Documento emitido por el Servicio de Calidad de la Compañía. El documento es propiedad de UT ITALCO. La empresa protegerá sus propios derechos en los tribunales civiles y penales de acuerdo con la ley.</font></td>
		</tr>
	<tr>
		<td colspan=14 height="18" align="center"><b><font face="Arial Narrow">** Fin del formato **</font></b></td>
		</tr>
</table>
<!-- Modal -->
<div class="modal"  id="modalFirma" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content" style="width: 600px;">
			<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">Firmar Documento</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<center><canvas id="canvas" style="border: 1px solid black;" width="560" height="320"></canvas>
					<br><input type="checkbox" id="poldatos" checked> 
					Acepto las <a href="javascript::void(0)" onclick="mostraraviso()">políticas de protección de datos personales</a>
				</center>
				
			</div>
			<div class="modal-footer">
				  
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
				<button type="button" class="btn btn-danger" id="btnLimpiar">Limpiar</button>
				<button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="pasarFirma()">Pasar a documento</button>
				 
			</div>
		</div>
	</div>
</div>
<!-- ************************************************************************** -->

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>

    <script>
        // var anchoTblCuerpo = $('#tblcuerpo').width();
        // $('#tblpie').width(anchoTblCuerpo)
        // $('#tblobs').width(anchoTblCuerpo)


        function agregarObs() {
            $('#tblobs').removeClass("oculto")
            $('#btnagregarObs').addClass("oculto")
        }

        var imagencargada = null
        var idImagen = null

        var user = sessionStorage.getItem('usercal')
        var tipouser = sessionStorage.getItem('tipouser')

        if (tipouser == 'ecopetrol') {
            $("input, select,  textarea").prop('disabled', true);
            $('.ecp').prop('disabled', false)
            $('.ut').prop('disabled', true)
                //$("#info input").prop("disabled", true);
        }

        if (tipouser == 'italco') {
            // $("input, select,  textarea").prop('disabled', false);
            $('.ecp').prop('disabled', true)
                // $('.ut').prop('disabled', true)
                //$("#info input").prop("disabled", true);
        }

        $('.activo').prop('disabled', false)

        var items = []
        var listaArchivos = []

        

        // Set up the canvas
        var canvas = document.querySelector("#canvas");
        var ctx = canvas.getContext("2d");
        ctx.strokeStyle = "#222222";
        ctx.lineWidth = 2;


        $btnDescargar = document.querySelector("#btnDescargar")
        $btnLimpiar = document.querySelector("#btnLimpiar")
        $btnGenerarDocumento = document.querySelector("#btnGenerarDocumento");

         

        // Get a regular interval for drawing to the screen
        window.requestAnimFrame = (function (callback) {
            return window.requestAnimationFrame || 
                        window.webkitRequestAnimationFrame ||
                        window.mozRequestAnimationFrame ||
                        window.oRequestAnimationFrame ||
                        window.msRequestAnimaitonFrame ||
                        function (callback) {
                            window.setTimeout(callback, 1000/60);
                        };
        })();
       

        const limpiarCanvas = () => {
            // Colocar color blanco en fondo de canvas
            clearCanvas();
        };
        limpiarCanvas();
        $btnLimpiar.onclick = limpiarCanvas;
        // Escuchar clic del botón para descargar el canvas



        window.obtenerImagen = () => {
            return $canvas.toDataURL();
        };


       // Set up mouse events for drawing
			var drawing = false;
			var mousePos = { x:0, y:0 };
			var lastPos = mousePos;
			canvas.addEventListener("mousedown", function (e) {
				drawing = true;
				lastPos = getMousePos(canvas, e);
			}, false);
			canvas.addEventListener("mouseup", function (e) {
				drawing = false;
			}, false);
			canvas.addEventListener("mousemove", function (e) {
				mousePos = getMousePos(canvas, e);
			}, false);

			// Set up touch events for mobile, etc
			canvas.addEventListener("touchstart", function (e) {
				mousePos = getTouchPos(canvas, e);
				var touch = e.touches[0];
				var mouseEvent = new MouseEvent("mousedown", {
					clientX: touch.clientX,
					clientY: touch.clientY
				});
				canvas.dispatchEvent(mouseEvent);
			}, false);
			canvas.addEventListener("touchend", function (e) {
				var mouseEvent = new MouseEvent("mouseup", {});
				canvas.dispatchEvent(mouseEvent);
			}, false);
			canvas.addEventListener("touchmove", function (e) {
				var touch = e.touches[0];
				var mouseEvent = new MouseEvent("mousemove", {
					clientX: touch.clientX,
					clientY: touch.clientY
				});
				canvas.dispatchEvent(mouseEvent);
			}, false);


            // Prevent scrolling when touching the canvas
			document.body.addEventListener("touchstart", function (e) { if (e.target == canvas) { e.preventDefault(); } }, {passive: false});
			document.body.addEventListener("touchend", function (e) {
				if (e.target == canvas) {
					e.preventDefault();
				}
			}, false);
			document.body.addEventListener("touchmove", function (e) {
				if (e.target == canvas) {
					e.preventDefault();
				}
			}, false);

			// Get the position of the mouse relative to the canvas
			function getMousePos(canvasDom, mouseEvent) {
				var rect = canvasDom.getBoundingClientRect();
				return {
					x: mouseEvent.clientX - rect.left,
					y: mouseEvent.clientY - rect.top
				};
			}

			// Get the position of a touch relative to the canvas
			function getTouchPos(canvasDom, touchEvent) {
				var rect = canvasDom.getBoundingClientRect();
				return {
					x: touchEvent.touches[0].clientX - rect.left,
					y: touchEvent.touches[0].clientY - rect.top
				};
			}

			// Draw to the canvas
			function renderCanvas() {
				if (drawing) {
					ctx.moveTo(lastPos.x, lastPos.y);
					ctx.lineTo(mousePos.x, mousePos.y);
					ctx.stroke();
					lastPos = mousePos;
				}
			}

			// Clear the canvas
			function clearCanvas() {
				canvas.width = canvas.width;
			}

			// Allow for animation
			(function drawLoop () {
				requestAnimFrame(drawLoop);
				renderCanvas();
			})();





        function abrirFirma(id) {

            if (id == 7) {
                if ($('#obs7').val() == '' || $('#nombre7').val == "" || $('#registro7').val() == "") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'info',
                        title: 'Por favor registre primero la observación, nombre y registro...',
                        showConfirmButton: false,
                        timer: 2500
                    })
                } else {
                    idImagen = id;
                    limpiarCanvas()
                    var myModal = new bootstrap.Modal(document.getElementById('modalFirma'))
                    myModal.show()
                }
            } else {

                if ($('#fecha' + id).val() == "" || $('#hora' + id).val() == "") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'info',
                        title: 'Por favor registre primero fecha y hora...',
                        showConfirmButton: false,
                        timer: 2500
                    })
                } else {
                    if ($('#nombre' + id).val() == "" || $('#registro' + id).val() == "") {
                        Swal.fire({
                            position: 'top-end',
                            icon: 'info',
                            title: 'Por favor registre primero nombre y registro...',
                            showConfirmButton: false,
                            timer: 2500
                        })
                    } else {
                        idImagen = id;
                        limpiarCanvas()
                        var myModal = new bootstrap.Modal(document.getElementById('modalFirma'))
                        myModal.show()
                    }
                }

            }


        }

        function pasarFirma() {
            if( $('#poldatos').prop('checked') ) {
                imagencargada = canvas.toDataURL("image/png");
                //document.querySelector("#firma").src = window.opener.obtenerImagen();
                document.querySelector("#firma" + idImagen).src = canvas.toDataURL("image/png");
    
                $('#firma' + idImagen).removeClass('oculto')
                $('#btnFirmar' + idImagen).hide()
    
                //SE GUARADAN LOS DATOS DE LA FIRMA
                if (idImagen == 1 || idImagen == 2) {
                    actLimpieza()
                }
                if (idImagen == 3 || idImagen == 4) {
                    actRecomendaciones()
                }
                if (idImagen == 5 || idImagen == 6) {
                    actPintura()
                }
    
                if (idImagen == 7) {
                    guardarObs()
                }
                 
            }else{
                Swal.fire({
                    position: 'top-end',
                    icon: 'info',
                    title: 'Debe aceptar las políticas de protección de datos perasonales',
                    showConfirmButton: false,
                    timer: 1500
                })
            }


            //document.querySelector("#btnfirmar").style.display = 'none';

        }

        function getParameterByName(name) {
            name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                results = regex.exec(location.search);
            return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }

        var tag = getParameterByName('tag');
        var arrayDatos = []
        var firmasItems = []
        var cmls = []

        odsq = localStorage.getItem('odsq');
        equipos = sessionStorage.getItem('equipo')
        alcance = sessionStorage.getItem('servicio')
        esp = sessionStorage.getItem('esp')

        var server = 'https://utitalco.com/calidad/024/server/';
        cargando()
        $.post(server + 'cargarRca114.php', {
                ods: odsq,
                tag: tag
            },
            function(resp) {
                arrayDatos = resp
                cmls = JSON.parse(arrayDatos.cmls);
                if(cmls.length > 6 && cmls.length < 10){
                    location = 'OS114v2.html?tag='+tag
                }
                if(cmls.length > 9){
                    location = 'OS114v3.html?tag='+tag
                }
                cargarDatos()
                
                
            })

        function actEquipo(){
            var eqaso = $('#eqp_asociado').val()
            $.post(server + 'actOs114EqAsoc.php', {
                    ods: odsq,
                    tag: tag,
                    equipo: eqaso
                },
                function(res) {
                    console.log(res)
                })
        }

        function cargarDatos() {
            $('#unidad').val(arrayDatos.unidad)
            $('#planta').val(arrayDatos.planta)

            $('#ods').val(arrayDatos.ods)
            $('#familia').val(arrayDatos.familia)
            $('#isometrico').html(arrayDatos.tag)
            $('#eqp_asociado').val(arrayDatos.equipo_asoc)
            $('#lazo').val(arrayDatos.lazo_corr)

            cmls = JSON.parse(arrayDatos.cmls);
            
            if(arrayDatos.doc != ''){

                listaArchivos = JSON.parse(arrayDatos.doc)
            }

            //cargue de cmsl precargados

            var c = 1;

            for (var i = 0; i < cmls.length; i++) {
                $('#cml' + c).html(cmls[i].cml)
                $('#acc' + c).html(cmls[i].accesorio)
                $('#okna' + c).val(cmls[i].okna)
                c++;
            }

            //cargue de datos de limpieza

            if (arrayDatos.limp_fac != "") {
                var arrayLimpieza = JSON.parse(arrayDatos.limp_fac)
                $('#inst_andamios').val(arrayLimpieza[0].inst_andamios)
                $('#rt_aisla').val(arrayLimpieza[0].rt_aisla)
                $('#pre_sup').val(arrayLimpieza[0].pre_sup)
                $('#insp_cml').val(arrayLimpieza[0].insp_cml)

                $('#fecha1').val(arrayLimpieza[0].fechaut)
                $('#hora1').val(arrayLimpieza[0].horaut)
                $('#nombre1').val(arrayLimpieza[0].nombreut)
                document.querySelector("#firma1").src = arrayLimpieza[0].firmaut;
                if (arrayLimpieza[0].fechaut != "") {
                    $('#firma1').removeClass('oculto')
                    $('#btnFirmar1').hide()
                }
                $('#registro1').val(arrayLimpieza[0].registrout)

                $('#fecha2').val(arrayLimpieza[0].fechaec)
                $('#hora2').val(arrayLimpieza[0].horaec)
                $('#nombre2').val(arrayLimpieza[0].nombreec)

                document.querySelector("#firma2").src = arrayLimpieza[0].firmaec;
                $('#registro2').val(arrayLimpieza[0].registroec)

                if (arrayLimpieza[0].fechaec != "") {
                    $('#firma2').removeClass('oculto')
                    $('#btnFirmar2').hide()
                }
            }

            //cargue de datos de recomendaciones

            if (arrayDatos.rec_post_insp != "") {
                var arrayRec = JSON.parse(arrayDatos.rec_post_insp)

                $('#eje_trab').val(arrayRec[0].eje_trab)
                $('#cont_calidad').val(arrayRec[0].cont_calidad)

                $('#fecha3').val(arrayRec[0].fechaut)
                $('#hora3').val(arrayRec[0].horaut)
                $('#nombre3').val(arrayRec[0].nombreut)
                document.querySelector("#firma3").src = arrayRec[0].firmaut;
                if (arrayRec[0].fechaut != "") {
                    $('#firma3').removeClass('oculto')
                    $('#btnFirmar3').hide()
                }
                $('#registro3').val(arrayRec[0].registrout)

                $('#fecha4').val(arrayRec[0].fechaec)
                $('#hora4').val(arrayRec[0].horaec)
                $('#nombre4').val(arrayRec[0].nombreec)

                document.querySelector("#firma4").src = arrayRec[0].firmaec;
                $('#registro4').val(arrayRec[0].registroec)

                if (arrayRec[0].fechaec != "") {
                    $('#firma4').removeClass('oculto')
                    $('#btnFirmar4').hide()
                }
            }

            //cargue de datos de PINTURA

            if (arrayDatos.pintura != "") {
                var arrayPint = JSON.parse(arrayDatos.pintura)
                var prep_sup_grado = arrayPint[0].prep_sup;
                if (prep_sup_grado != "") {
                    var array_prep = prep_sup_grado.split(" | ")
                    $('#prep_sup').val(array_prep[0])
                    $('#gradoSSPC').val(array_prep[1])
                } else {
                    $('#prep_sup').val('')
                    $('#gradoSSPC').val('')
                }

                $('#apli_recub').val(arrayPint[0].apli_recub)
                $('#inst_aislamiento').val(arrayPint[0].inst_aislamiento)
                $('#inst_foil_alum').val(arrayPint[0].inst_foil_alum)

                $('#fecha5').val(arrayPint[0].fechaut)
                $('#hora5').val(arrayPint[0].horaut)
                $('#nombre5').val(arrayPint[0].nombreut)
                document.querySelector("#firma5").src = arrayPint[0].firmaut;
                if (arrayPint[0].fechaut != "") {
                    $('#firma5').removeClass('oculto')
                    $('#btnFirmar5').hide()
                }
                $('#registro5').val(arrayPint[0].registrout)

                $('#fecha6').val(arrayPint[0].fechaec)
                $('#hora6').val(arrayPint[0].horaec)
                $('#nombre6').val(arrayPint[0].nombreec)

                document.querySelector("#firma6").src = arrayPint[0].firmaec;
                $('#registro6').val(arrayPint[0].registroec)

                if (arrayPint[0].fechaec != "") {
                    $('#firma6').removeClass('oculto')
                    $('#btnFirmar6').hide()
                }
            }

            //CARGUE DE OBSERVACIONES

            if (arrayDatos.observaciones != "") {
                var arrayObs = JSON.parse(arrayDatos.observaciones)
                var html = ''
                for (var i = 0; i < arrayObs.length; i++) {
                    html = `<b>Nota ${i+1}: </b>
                    ${arrayObs[i].obs} | ${arrayObs[i].nombre} | Registro: ${arrayObs[i].registro} | Fecha: ${arrayObs[i].fecha} | Firma: <span id="firm${i}" style="width: 60px;"></span> <br>--------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>
                    `
                    $('#observaciones').append(html)
                    const imagef = document.createElement('img')
                    imagef.src = arrayObs[i].firma
                    imagef.height = "60"
                    document.querySelector('#firm' + i).appendChild(imagef)

                }
            }

            Swal.close()

            // Swal.fire({
            //     position: 'top-end',
            //     icon: 'success',
            //     title: 'Formato cargado...',
            //     showConfirmButton: false,
            //     timer: 500
            // })


        }

        function actLimpieza() {

            var arrayCmls = []

            var cml1 = $('#cml1').text()
            if (cml1 != "") {
                arrayCmls.push({
                    "cml": cml1,
                    "accesorio": $('#acc1').text(),
                    "okna": $('#okna1').val()
                })
            }
            var cml2 = $('#cml2').text()
            if (cml2 != "") {
                arrayCmls.push({
                    "cml": cml2,
                    "accesorio": $('#acc2').text(),
                    "okna": $('#okna2').val()
                })
            }
            var cml3 = $('#cml3').text()
            if (cml3 != "") {
                arrayCmls.push({
                    "cml": cml3,
                    "accesorio": $('#acc3').text(),
                    "okna": $('#okna3').val()
                })
            }
            var cml4 = $('#cml4').text()
            if (cml4 != "") {
                arrayCmls.push({
                    "cml": cml4,
                    "accesorio": $('#acc4').text(),
                    "okna": $('#okna4').val()
                })
            }
            var cml5 = $('#cml5').text()
            if (cml5 != "") {
                arrayCmls.push({
                    "cml": cml5,
                    "accesorio": $('#acc5').text(),
                    "okna": $('#okna5').val()
                })
            }
            var cml6 = $('#cml6').text()
            if (cml6 != "") {
                arrayCmls.push({
                    "cml": cml6,
                    "accesorio": $('#acc6').text(),
                    "okna": $('#okna6').val()
                })
            }

            console.log(arrayCmls)

            var inst_andamio = $('#inst_andamios').val()
            var rt_aisla = $('#rt_aisla').val()
            var pre_sup = $('#pre_sup').val()
            var insp_cml = $('#insp_cml').val()

            var fechalimput = $('#fecha1').val()
            var horalimput = $('#hora1').val()
            var nombrelimput = $('#nombre1').val()

            var img = document.getElementById("firma1");
            var firmalimput = img.src

            if (fechalimput == '') {
                firmalimput = ''
            }
            var registrolimput = $('#registro1').val()

            var fechalimpec = $('#fecha2').val()
            var horalimpec = $('#hora2').val()
            var nombrelimpec = $('#nombre2').val()

            var img = document.getElementById("firma2");
            var firmalimpec = img.src

            if (fechalimpec == '') {
                firmalimpec = ''
            }
            var registrolimpec = $('#registro2').val()

            var arrayLmp = []

            arrayLmp.push({
                "inst_andamios": inst_andamio,
                "pre_sup": pre_sup,
                "rt_aisla": rt_aisla,
                "insp_cml": insp_cml,
                "fechaut": fechalimput,
                "horaut": horalimput,
                "nombreut": nombrelimput,
                "firmaut": firmalimput,
                "registrout": registrolimput,
                "fechaec": fechalimpec,
                "horaec": horalimpec,
                "nombreec": nombrelimpec,
                "firmaec": firmalimpec,
                "registroec": registrolimpec
            })

            console.log(arrayLmp)

            $.post(server + 'actOs114Limp.php', {
                    ods: odsq,
                    tag: tag,
                    datos: JSON.stringify(arrayLmp),
                    cmls: JSON.stringify(arrayCmls)
                },
                function(res) {
                    console.log(res)
                })

        }

        function actRecomendaciones() {
            var eje_trab = $('#eje_trab').val()
            var cont_calidad = $('#cont_calidad').val()


            var fechalimput = $('#fecha3').val()
            var horalimput = $('#hora3').val()
            var nombrelimput = $('#nombre3').val()

            var img = document.getElementById("firma3");
            var firmalimput = img.src

            if (fechalimput == '') {
                firmalimput = ''
            }
            var registrolimput = $('#registro3').val()

            var fechalimpec = $('#fecha4').val()
            var horalimpec = $('#hora4').val()
            var nombrelimpec = $('#nombre4').val()

            var img = document.getElementById("firma4");
            var firmalimpec = img.src

            if (fechalimpec == '') {
                firmalimpec = ''
            }
            var registrolimpec = $('#registro4').val()

            var arrayLmp = []

            arrayLmp.push({
                "eje_trab": cont_calidad,
                "cont_calidad": cont_calidad,
                "fechaut": fechalimput,
                "horaut": horalimput,
                "nombreut": nombrelimput,
                "firmaut": firmalimput,
                "registrout": registrolimput,
                "fechaec": fechalimpec,
                "horaec": horalimpec,
                "nombreec": nombrelimpec,
                "firmaec": firmalimpec,
                "registroec": registrolimpec
            })

            console.log(arrayLmp)

            $.post(server + 'actOs114Reco.php', {
                    ods: odsq,
                    tag: tag,
                    datos: JSON.stringify(arrayLmp)
                },
                function(res) {
                    console.log(res)
                })

        }

        function actPintura() {
            var prep_sup = $('#prep_sup').val()

            if (prep_sup == 'OK') {
                var grado = $('#gradoSSPC').val()
                var texto1 = prep_sup + ' | ' + grado
            } else {
                var grado = ''
                var texto1 = prep_sup
            }

            var inst_aislamiento = $('#inst_aislamiento').val()
            var apli_recub = $('#apli_recub').val()
            var inst_foil_alum = $('#inst_foil_alum').val()

            var fechalimput = $('#fecha5').val()
            var horalimput = $('#hora5').val()
            var nombrelimput = $('#nombre5').val()

            var img = document.getElementById("firma5");
            var firmalimput = img.src

            if (fechalimput == '') {
                firmalimput = ''
            }
            var registrolimput = $('#registro5').val()

            var fechalimpec = $('#fecha6').val()
            var horalimpec = $('#hora6').val()
            var nombrelimpec = $('#nombre6').val()

            var img = document.getElementById("firma6");
            var firmalimpec = img.src

            if (fechalimpec == '') {
                firmalimpec = ''
            }
            var registrolimpec = $('#registro6').val()

            var arrayLmp = []

            arrayLmp.push({
                "prep_sup": texto1,
                "apli_recub": apli_recub,
                "inst_aislamiento": inst_aislamiento,
                "inst_foil_alum": inst_foil_alum,
                "fechaut": fechalimput,
                "horaut": horalimput,
                "nombreut": nombrelimput,
                "firmaut": firmalimput,
                "registrout": registrolimput,
                "fechaec": fechalimpec,
                "horaec": horalimpec,
                "nombreec": nombrelimpec,
                "firmaec": firmalimpec,
                "registroec": registrolimpec
            })

            console.log(arrayLmp)

            $.post(server + 'actOs114Pintura.php', {
                    ods: odsq,
                    tag: tag,
                    datos: JSON.stringify(arrayLmp)
                },
                function(res) {
                    console.log(res)
                })

        }

        function guardarObs() {
            var observacion = $('#obs7').val()
            var nombreobs = $('#nombre7').val()
            var registroobs = $('#registro7').val()
            var img = document.getElementById("firma7");

            // crea un nuevo objeto `Date`
            var today = new Date();

            // obtener la fecha y la hora
            var now = today.toLocaleString();
            var firmaobs = img.src

            var arrayLmp = []

            arrayLmp.push({
                "obs": observacion,
                "nombre": nombreobs,
                "registro": registroobs,
                "firma": firmaobs,
                "fecha": now
            })


            $.post(server + 'actOs114Obs.php', {
                    ods: odsq,
                    tag: tag,
                    datos: JSON.stringify(arrayLmp)
                },
                function(res) {
                    console.log(res)
                    location.reload()
                })

        }

        


        function mostraraviso() {
            let timerInterval
            Swal.fire({
                title: 'Políticas de protección de datos personales',
                text: 'En cumplimiento con la Ley 1581 de protección de datos personales, se le informa que los datos suministrados serán incorporados a una base de datos cuya finalidad es el registro de control de actividades RCA y las actuaciones que se deriven de dicha gestión, cuyo responsable del tratamiento es UT ITALCO. Mediante el registro de sus datos  a través de este formato usted autoriza a UT ITALCO, a tratar los datos con la finalidad descrita arriba.  Como Titular se le informa que podrá ejercer sus derechos de acceso y reclamos a través del correo de contacto pqrsbca@utitalco.com.',
                timer: 20000,
                timerProgressBar: true,
                didOpen: () => {
                    Swal.showLoading()
                    const b = Swal.getHtmlContainer().querySelector('b')
                    timerInterval = setInterval(() => {
                        b.textContent = Swal.getTimerLeft()
                    }, 100)
                },
                willClose: () => {
                    clearInterval(timerInterval)
                }
            }).then((result) => {
                /* Read more about handling dismissals below */
                if (result.dismiss === Swal.DismissReason.timer) {
                    console.log('I was closed by the timer')
                }
            })
        }

        function cargando() {
            let timerInterval
            Swal.fire({
                title: 'Cargando formato...!',
                timer: 20000,
                timerProgressBar: true,
                didOpen: () => {
                    Swal.showLoading()
                    const b = Swal.getHtmlContainer().querySelector('b')
                    timerInterval = setInterval(() => {
                        b.textContent = Swal.getTimerLeft()
                    }, 100)
                },
                willClose: () => {
                    clearInterval(timerInterval)
                }
            }).then((result) => {
                /* Read more about handling dismissals below */
                if (result.dismiss === Swal.DismissReason.timer) {
                    console.log('I was closed by the timer')
                }
            })
        }

        function verArchivos(){
            var htmltexto = ''
            for(var i=0; i<listaArchivos.length; i++){
                htmltexto += `
                    <a href='https://utitalco.com/calidad/server/archivos/${listaArchivos[i].archivo}' target='_blank'>${listaArchivos[i].archivo}</a> <br>
                `
            }

            Swal.fire({
                title: '<strong>Lista de adjuntos</strong>',
                icon: 'info',
                html: `
                Pulse click sobre el archivo que desea descargar... <br>
                ${htmltexto}
                `
            
            })
        }

        function adjuntar(){
            Swal.fire({
                title: 'Adjuntar archivo',
                html: `
                <input type="file" id="archivo" class="form-control" placeholder="Buscar...">
                `,
                showCancelButton: true,
                confirmButtonText: 'Adjuntar'
            }).then((result) => {
                /* Read more about isConfirmed, isDenied below */
                if (result.isConfirmed) {
                    
                    var formData = new FormData();
                    var files = $('#archivo')[0].files[0];
                    formData.append('archivo', files);
                    formData.append('ods', odsq);
                    formData.append('tag', tag);
                    $.ajax({
                        url: server + 'guardarArchivo.php',
                        type: 'post',
                        data: formData,
                        contentType: false,
                        processData: false,
                        success: function(response) {
                            console.log(response)

                            if (response.msn == "Ok") {
                                Swal.fire({
                                    position: 'top-end',
                                    icon: 'success',
                                    title: 'Archivo cargado correctamente...',
                                    showConfirmButton: false,
                                    timer: 1500
                                }).then(()=>{

                                    location.reload();
                                })
                            } else {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'Oops...',
                                    text: 'Formato de archivo incorrecto...!',
                                })
                            }
                        }
                    });

                }
            })
        }


    </script>
</body>

</html>

<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QAQC - UT ITALCO</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
        integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous" />

    <script src="weldbook/jquery.min.js"></script>
    <script src="weldbook/jquery-ui.min.js"></script>
    <script src="weldbook/jquery.jqGrid.min.js"></script>
    <script src="weldbook/grid.locale-en.js"></script>
    <link rel="stylesheet" href="weldbook/jquery-ui.css" />
    <link rel="stylesheet" href="weldbook/ui.jqgrid_4.min.css" />
    <!-- <link rel="stylesheet" href="ui.jqgrid.css"> -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat+Alternates:wght@100;500;700&family=Roboto:wght@100;300;400;500&display=swap"
        rel="stylesheet" />

        <script type="text/javascript" src="https://code.highcharts.com/highcharts.js"></script>
        <!--<link rel="stylesheet" href="https://code.highcharts.com/css/themes/dark-unica.css"> -->
        <script src="https://code.highcharts.com/highcharts-3d.js"></script>
        <script src="https://code.highcharts.com/modules/cylinder.js"></script>
        <script src="https://code.highcharts.com/modules/funnel3d.js"></script>
        <script src="https://code.highcharts.com/modules/pyramid3d.js"></script>
        <script src="https://code.highcharts.com/modules/exporting.js"></script>
        <script src="https://code.highcharts.com/modules/export-data.js"></script>
        <script src="https://code.highcharts.com/modules/accessibility.js"></script> 
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.2.61/jspdf.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.svg.js"></script>
    
        

    <style>
        .ui-th-div {
            vertical-align: top !important;
        }

        .ui-jqgrid-title {
            vertical-align: top;
        }

        body {
            /* background-image: url("img/fondo.jpg");
            background-size: cover;
            background-repeat: no-repeat;
            background-attachment: fixed; */
            height: 100hv;
            font-family: "Montserrat Alternates", sans-serif;
            font-family: "Roboto", sans-serif;
            font-weight: normal;
        }

        video {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            object-fit: cover;
            z-index: -9999;
        }

        .cab {
            margin-top: 30px;
            background-color: rgb(218, 255, 255);
            padding: 20px;
            border-radius: 15px;
        }

        .titulop {
            padding: 15px;
            padding-top: 20px;
            align-items: center;
            vertical-align: middle;
            text-align: center;
        }

        .mnubotones {
            position: relative;
        }

        .cajones {
            float: left;
            margin: 10px;
        }

        .mbt {
            height: 100px;
        }

        .card {
            box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
            width: 21rem;
        }

        .cuerpo {
            position: relative;
            margin-top: 20px;
            border-radius: 10px;
            background-color: rgb(243, 243, 243);
            padding: 15px;
        }

        .padre {
            display: flex;
            align-items: center;
        }

        .micontainer {
            margin: 0 auto;
            width: 97%;
        }

        table thead td {
            vertical-align: middle;
        }

        th.ui-th-column {
            border-width: 1px;
            border-style: solid;
            border-color: #b1b1b1;
        }

        @media only screen and (max-width: 600px) {
            .mnubotones {
                margin-top: 30px;
                display: block;
                justify-content: center;
                align-items: center;
            }

            .card {
                box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
                width: 100%;
            }
        }
    </style>


</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="#"><img src="img/logo_m.png" width="100px" alt="" /></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <h5>
                    INFORME DIARIO DE AVANCE DE QA/QC ODS 032 AZUFRE lll
                    <br />
                    Fecha Informe: <span id="fecha"></span> | Fecha de Corte

                    <input type="date"  id="fechac" placeholder="Fecha">
                    <button id="export" onclick="cargarFecha()" class="btn btn-success">Cargar Datos</button>
                </h5>
            </div>
        </div>
    </nav>

    <div class="micontainer">
        <div class="cuerpo">


            <div class="card-header bg-primary text-center mt-2" style="color: #fff">
                <h5>AVANCE DIARIO JUNTAS Y PULGADAS DIAMETRALES</h5>
            </div>
            <!-- <div class="card-header bg-info">
                U-2500 DEMEX 
            </div> -->

            <div class="mt-2" id="fig5">
                <h5>Total Juntas Realizadas | <span id="totjuntasDemex"></span> | Total Pulgadas Realizadas | <span id="totpulgDemex"></span>
                    | # Soldadores | <span id="cantsoldDemex"></span>
                    | Rendimiento por Soldador  | <span id="rendDemex"></span> |
                </h5> <hr>

                <h5 id="rendimientos">

                </h5>
            </div>
            <div class="mt-2">
                <h4>Resumen por Especialidad</h4>
                <table class="table table-striped" id="tabla10"></table>
            </div>
            <div class="mt-2">
                <h4>Resumen por Equipo</h4>
                <table class="table table-striped" id="tabla11"></table>
            </div>

           
            <div class="card-header bg-primary text-center mt-2" style="color: #fff">
                <h5>INFORME DE SOLDADURA</h5>
            </div>
            <!-- <div class="card-header bg-info">
                JUNTAS SOLDADAS Y PULGADAS DIAMETRALES POR EQUIPOS U-2500 DEMEX
            </div> -->
            <div class="mt-2">
                <table class="table table-striped" id="tabla7"></table>
            </div>

            <div class="row">
                <div class="col-sm-8">
                    <div class="mt-2" id="figsold">
                
                    </div>
                </div>

                <div class="col-sm-4">
                    <div class="mt-2" id="figavancediario">

                    </div>
                </div>
            </div>
            

            <div class="card-header bg-primary text-center mt-2" style="color: #fff">
                <h5>INFORME DE BRIDAS</h5>
            </div>
            

            <div class="mt-2" id="fig4"></div>
            <div class="mt-2">
                <table class="table table-striped" id="tabla9"></table>
            </div>




            <!-- <div class="card-header bg-primary text-center" style="color: #fff">
                <h5>SEGUIMIENTO PUNTOS DE INSPECCIÓN</h5>
            </div>
            

            <div class="mt-2" id="fig1"></div>
            <div class="mt-2">
                <table class="table table-striped" id="tabla1"></table>
            </div> -->


            <div class="card-header bg-primary text-center mt-2" style="color: #fff">
                <h5>SEGUIMIENTO LAZOS DE CORROSIÓN</h5>
            </div>

            <div class="mt-2" id="fig3"></div>
            <div class="mt-2">
                <table class="table table-striped" id="tabla3"></table>
            </div>

            <div class="card-header bg-primary text-center mt-2" style="color: #fff">
                <h5>SEGUIMIENTO DE EQUIPOS ESTÁTICOS</h5>
            </div>
            <div class="card-header bg-info">INTERCAMBIADORES</div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla4"></table>
            </div>

            <!-- <div class="card-header bg-info mt-2">TAMBORES </div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla5"></table>
            </div> -->

            <div class="card-header bg-info">
                INDICADORES DE NIVEL LG 
            </div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla6"></table>
            </div>

            <div class="card-header bg-info">
                VÁLVULAS DE SEGURIDAD
            </div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla12"></table>
            </div>

            <div class="card-header bg-info">
                TORRES
            </div>

            <div class="mt-2">
                <table class="table table-striped" id="tabla13"></table>
            </div>

            
            


        </div>
    </div>

    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous">
    </script>
    <script type="text/javascript" language="javascript"
        src="//cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"></script>

    <script>
        var odsq = '032';
        var datos = [];
        var url = "https://utitalco.com/calidad/032/weldbook/server/";

        var user = sessionStorage.getItem("usercal");
        var tipouser = sessionStorage.getItem("tipouser");

        var arrayFechas = []
        var arrayProg = []
        var arrayEje = []

        var arrayProgAcum = null
        var arrayEjeAcum = null

        var soldadores = []
        var rendi = []

        var ventana_ancho = $(window).width();
        var ventana_alto = $(window).height();
        ventana_ancho = ventana_ancho - 80;
        ventana_alto = ventana_alto - 220;

        if (ventana_ancho > 1300) {
            ventana_alto = ventana_alto - 220;
        } else {
            ventana_alto = 330;
        }

        let date = new Date();
        let output =
            String(date.getDate()).padStart(2, "0") +
            "-" +
            String(date.getMonth() + 1).padStart(2, "0") +
            "-" +
            date.getFullYear();

        let outputf =
            date.getFullYear() +
            "-" +
            String(date.getMonth() + 1).padStart(2, "0") +
            "-" +
            String(date.getDate()).padStart(2, "0");
             
            
           

        $("#fecha").html(output);

        var fechab = sessionStorage.getItem('fechab');
        

        if(fechab == null){
            fechab = outputf;
        }

        var fechabuscar = fechab


        $('#fechac').val(fechab)

        //cargarDatos();

        function cargando() {
            let timerInterval;
            Swal.fire({
                title: "Cargando indicadores...!",
                timer: 120000,
                timerProgressBar: true,
                didOpen: () => {
                    Swal.showLoading();
                    const b = Swal.getHtmlContainer().querySelector("b");
                    timerInterval = setInterval(() => {
                        // b.textContent = Swal.getTimerLeft()
                    }, 100);
                },
                willClose: () => {
                    clearInterval(timerInterval);
                },
            }).then((result) => {
                /* Read more about handling dismissals below */
                if (result.dismiss === Swal.DismissReason.timer) {
                    console.log("I was closed by the timer");
                }
            });
        }

        function cargandoPag() {
            let timerInterval;
            Swal.fire({
                title: "Procesando datos...!",
                timer: 120000,
                timerProgressBar: true,
                didOpen: () => {
                    Swal.showLoading();
                    const b = Swal.getHtmlContainer().querySelector("b");
                    timerInterval = setInterval(() => {
                        // b.textContent = Swal.getTimerLeft()
                    }, 100);
                },
                willClose: () => {
                    clearInterval(timerInterval);
                },
            }).then((result) => {
                /* Read more about handling dismissals below */
                if (result.dismiss === Swal.DismissReason.timer) {
                    console.log("I was closed by the timer");
                }
            });
        }

        //cargarInformePuntos();
        cargarInformeLazos();
        cargarInformeInter();
        //cargarInformeTambores();
        cargarInformeLgs();
        cargarInformeSoldaduraEquipos();
        cargarInformeBridas()
        cargarAvanceDiario()
        cargarInformeValvulas()
        cargarInformeTorres()
        cargarInformeSoldadura()

        function cargarFecha(){
            fechabuscar = $('#fechac').val()
            sessionStorage.setItem('fechab', fechabuscar)
            location.reload()
        }

        function cargarInformePuntos() {
            cargandoPag();
            $.post(
                "https://utitalco.com/calidad/032/weldbook/server/repCCPuntos.php",
                function (resp) {
                    datos = resp;

                    $("#tabla1").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: datos,
                        colModel: [{
                                name: "lazo",
                                label: "LAZO CORROSIÓN",
                                width: 120,
                            },
                            {
                                name: "isometrico",
                                label: "ISOMETRICO",
                                width: 90,
                            },
                            {
                                name: "cmls",
                                label: "CML'S",
                                width: 50,
                                align: "center",
                            },

                            {
                                name: "limpiezaprog",
                                label: "TOT",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },
                            {
                                name: "limpiezaeje",
                                label: "EJE",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },

                            {
                                name: "alimpieza",
                                label: "AVANCE",
                                width: 50,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["limpiezaprog"]) {
                                        value.totalAmount += parseFloat(record["limpiezaprog"]);
                                    }
                                    if (record["limpiezaeje"]) {
                                        value.totalTax += parseFloat(record["limpiezaeje"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },

                            {
                                name: "insputespprog",
                                label: "TOT",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },
                            {
                                name: "insputespeje",
                                label: "EJE",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },

                            {
                                name: "ainsputesp",
                                label: "AVANCE",
                                width: 50,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["insputespprog"]) {
                                        value.totalAmount += parseFloat(record["insputespprog"]);
                                    }
                                    if (record["insputespeje"]) {
                                        value.totalTax += parseFloat(record["insputespeje"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },

                            {
                                name: "rtpostinspprog",
                                label: "TOT",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },
                            {
                                name: "rtpostinspeje",
                                label: "EJE",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },

                            {
                                name: "artpostinsp",
                                label: "AVANCE",
                                width: 50,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["rtpostinspprog"]) {
                                        value.totalAmount += parseFloat(record["rtpostinspprog"]);
                                    }
                                    if (record["rtpostinspeje"]) {
                                        value.totalTax += parseFloat(record["rtpostinspeje"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },

                            {
                                name: "ejertprog",
                                label: "TOT",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },
                            {
                                name: "ejerteje",
                                label: "EJE",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },

                            {
                                name: "aejert",
                                label: "AVANCE",
                                width: 50,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["ejertprog"]) {
                                        value.totalAmount += parseFloat(record["ejertprog"]);
                                    }
                                    if (record["ejerteje"]) {
                                        value.totalTax += parseFloat(record["ejerteje"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },

                            {
                                name: "vobocieprog",
                                label: "TOT",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },
                            {
                                name: "vobocieeje",
                                label: "EJE",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },

                            {
                                name: "avobocie",
                                label: "AVANCE",
                                width: 50,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["vobocieprog"]) {
                                        value.totalAmount += parseFloat(record["vobocieprog"]);
                                    }
                                    if (record["vobocieeje"]) {
                                        value.totalTax += parseFloat(record["vobocieeje"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },

                            {
                                name: "pinturaprog",
                                label: "TOT",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },
                            {
                                name: "pinturaeje",
                                label: "EJE",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },

                            {
                                name: "apintura",
                                label: "AVANCE",
                                width: 50,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["pinturaprog"]) {
                                        value.totalAmount += parseFloat(record["pinturaprog"]);
                                    }
                                    if (record["pinturaeje"]) {
                                        value.totalTax += parseFloat(record["pinturaeje"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },

                            {
                                name: "aislamientoprog",
                                label: "TOT",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },
                            {
                                name: "aislamientoeje",
                                label: "EJE",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },

                            {
                                name: "aaislamiento",
                                label: "AVANCE",
                                width: 50,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["aislamientoprog"]) {
                                        value.totalAmount += parseFloat(
                                            record["aislamientoprog"]
                                        );
                                    }
                                    if (record["aislamientoeje"]) {
                                        value.totalTax += parseFloat(record["aislamientoeje"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 200,
                        rowNum: 1000,
                        pager: "#jqGridPager",

                        grouping: true,
                        groupingView: {
                            groupField: ["lazo"],
                            groupColumnShow: [true],
                            groupText: ["<b>{0}</b>"],
                            groupOrder: ["asc"],
                            groupSummary: [true],
                            groupSummaryPos: ["header"],
                            groupCollapse: true,
                        },
                    });

                    $("#tabla1").jqGrid("setGroupHeaders", {
                        useColSpanStyle: true,
                        groupHeaders: [{
                                startColumnName: "limpiezaprog",
                                numberOfColumns: 3,
                                titleText: "LIMPIEZA",
                            },
                            {
                                startColumnName: "insputespprog",
                                numberOfColumns: 3,
                                titleText: "INSPECCIÓN <br> CIE",
                            },
                            {
                                startColumnName: "rtpostinspprog",
                                numberOfColumns: 3,
                                titleText: "EMISIÓN RT <br> POST <br>INSPECCIÓN",
                            },
                            {
                                startColumnName: "ejertprog",
                                numberOfColumns: 3,
                                titleText: "EJECUCIÓN <br> RECOMENDA.",
                            },
                            {
                                startColumnName: "vobocieprog",
                                numberOfColumns: 3,
                                titleText: "VoBo CIE",
                            },
                            {
                                startColumnName: "pinturaprog",
                                numberOfColumns: 3,
                                titleText: "PINTURA",
                            },
                            {
                                startColumnName: "aislamientoprog",
                                numberOfColumns: 3,
                                titleText: "AISLAMIENTO",
                            },
                        ],
                    });

                    cargarGraficasPuntosDemex();
                    cargarInformePuntosVisco();
                }
            );
        }

        
        function cargarGraficasPuntos() {
            armandamioprog = 0;
            armandamioeje = 0;

            retaislamientoprog = 0;
            retaislamientoeje = 0;

            limpiezaprog = 0;
            limpiezaeje = 0;

            insputespprog = 0;
            insputespeje = 0;

            rtpostinspprog = 0;
            rtpostinspeje = 0;

            ejertprog = 0;
            ejerteje = 0;

            vobocieprog = 0;
            vobocieeje = 0;

            pinturaprog = 0;
            pinturaeje = 0;

            aislamientoprog = 0;
            aislamientoeje = 0;

            desarmandamioprog = 0;
            desarmandamioeje = 0;

            regcontrolprog = 0;
            regcontroleje = 0;

            for (var i = 0; i < datos.length; i++) {
                armandamioprog += datos[i].armandamioprog;
                armandamioeje += datos[i].armandamioeje;

                retaislamientoprog += datos[i].retaislamientoprog;
                retaislamientoeje += datos[i].retaislamientoeje;

                limpiezaprog += datos[i].limpiezaprog;
                limpiezaeje += datos[i].limpiezaeje;

                insputespprog += datos[i].insputespprog;
                insputespeje += datos[i].insputespeje;

                rtpostinspprog += datos[i].rtpostinspprog;
                rtpostinspeje += datos[i].rtpostinspeje;

                ejertprog += datos[i].ejertprog;
                ejerteje += datos[i].ejerteje;

                vobocieprog += datos[i].vobocieprog;
                vobocieeje += datos[i].vobocieeje;

                pinturaprog += datos[i].pinturaprog;
                pinturaeje += datos[i].pinturaeje;

                aislamientoprog += datos[i].aislamientoprog;
                aislamientoeje += datos[i].aislamientoeje;

                desarmandamioprog += datos[i].desarmandamioprog;
                desarmandamioeje += datos[i].desarmandamioeje;

                regcontrolprog += datos[i].regcontrolprog;
                regcontroleje += datos[i].regcontroleje;
            }

            Highcharts.chart("fig1", {
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",
                    styledMode: true,
                },
                title: {
                    text: "<b>AVANCE PUNTOS DE INSPECCIÓN</b>",
                },

                xAxis: {
                    categories: [
                        "LIMPIEZA",
                        "INSPECCIÓN CIE",
                        "EMISIÓN RT POST INSP.",
                        "EJECUCIÓN RECOMENDA.",
                        "VoBo CIE",
                        "PINTURA",
                        "AISLAMIENTO",
                    ],
                    crosshair: true,
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        stacking: 'normal',
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                        name: "TOTALES",
                        data: [
                            limpiezaprog,
                            insputespprog,
                            rtpostinspprog,
                            ejertprog,
                            vobocieprog,
                            pinturaprog,
                            aislamientoprog,
                        ],
                    },
                    {
                        name: "EJECUTADAS",
                        data: [
                            limpiezaeje,
                            insputespeje,
                            rtpostinspeje,
                            ejerteje,
                            vobocieeje,
                            pinturaeje,
                            aislamientoeje,
                        ],
                        stack: 'PRO'
                    },
                    {
                        name: "PENDIENTES",
                        data: [
                            limpiezaprog - limpiezaeje,
                            insputespprog-insputespeje,
                            rtpostinspprog-rtpostinspeje,
                            ejertprog-ejerteje,
                            vobocieprog-vobocieeje,
                            pinturaprog-pinturaeje,
                            aislamientoprog-aislamientoeje,
                        ],
                        stack: 'PRO'
                    },
                ],
            });
        }

        
        function cargarInformeLazos() {
            $.post(
                "https://utitalco.com/calidad/032/weldbook/server/repCCLazos.php",
                function (resp) {
                    datos = resp;

                    $("#tabla3").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: datos,
                        colModel: [{
                                name: "lazo",
                                label: "LAZO CORROSIÓN",
                                width: 120,
                                frozen: true,
                            },
                            {
                                name: "isometrico",
                                label: "ISOMÉTRICO",
                                width: 150,
                                frozen: true,
                            },

                           



                            {
                                name: "act4p",
                                label: "PLAN",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },
                            {
                                name: "act4e",
                                label: "EJE",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },
                            {
                                name: "avact4",
                                label: "AVANCE",
                                width: 50,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["act4p"]) {
                                        value.totalAmount += parseFloat(record["act4p"]);
                                    }
                                    if (record["act4e"]) {
                                        value.totalTax += parseFloat(record["act4e"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },

                        
                            {
                                name: "sprog",
                                label: "PLAN",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },
                            {
                                name: "seje",
                                label: "EJE",
                                width: 50,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },
                            {
                                name: "avtot",
                                label: "AVANCE",
                                width: 50,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["sprog"]) {
                                        value.totalAmount += parseFloat(record["sprog"]);
                                    }
                                    if (record["seje"]) {
                                        value.totalTax += parseFloat(record["seje"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 300,
                        rowNum: 400,
                        pager: "#jqGridPager",

                        grouping: true,
                        groupingView: {
                            groupField: ["lazo"],
                            groupColumnShow: [true],
                            groupText: ["<b>{0}</b>"],
                            groupOrder: ["asc"],
                            groupSummary: [true],
                            groupSummaryPos: ["header"],
                            groupCollapse: false,
                        },
                    });

                    $("#tabla3").jqGrid("setGroupHeaders", {
                        useColSpanStyle: true,
                        groupHeaders: [{
                                startColumnName: "act1p",
                                numberOfColumns: 3,
                                titleText: "CAMBIAR TRACING",
                            },
                            {
                                startColumnName: "act2p",
                                numberOfColumns: 3,
                                titleText: "CAMBIAR VALVULA <br> BRIDADA",
                            },
                            {
                                startColumnName: "act3p",
                                numberOfColumns: 3,
                                titleText: "CAMBIAR VENTEO",
                            },
                            {
                                startColumnName: "act4p",
                                numberOfColumns: 3,
                                titleText: "CAMBIO DE LINEA",
                            },
                            {
                                startColumnName: "act5p",
                                numberOfColumns: 3,
                                titleText: "ELIMINACION DE <br> VENTEO",
                            },
                            {
                                startColumnName: "act6p",
                                numberOfColumns: 3,
                                titleText: "MANTENIMIENTO DE <br> VALVULA BRIDADA",
                            },
                            {
                                startColumnName: "act7p",
                                numberOfColumns: 3,
                                titleText: "SOLDADURA DE SELLO",
                            },
                            {
                                startColumnName: "sprog",
                                numberOfColumns: 3,
                                titleText: "AVANCE GENERAL",
                            },
                        ],
                    });

                    // $("#grid1b2").jqGrid('filterToolbar',
                    // {autoSearch: true, searchOnEnter: false,});

                    $("#tabla3").jqGrid("setFrozenColumns");

                    //cargarGraficasLazosVisco();
                }
            );
        }

        function cargarGraficasLazos() {
            act1p = 0;
            act2p = 0;
            act3p = 0;
            act4p = 0;
            act5p = 0;
            act6p = 0;
            act7p = 0;
            sprog = 0;

            act1e = 0;
            act2e = 0;
            act3e = 0;
            act4e = 0;
            act5e = 0;
            act6e = 0;
            act7e = 0;
            seje = 0;

            for (var i = 0; i < datos.length; i++) {
                act1p += datos[i].act1p;
                act1e += datos[i].act1e;
                act2p += datos[i].act2p;
                act2e += datos[i].act2e;
                act3p += datos[i].act3p;
                act3e += datos[i].act3e;
                act4p += datos[i].act4p;
                act4e += datos[i].act4e;
                act5p += datos[i].act5p;
                act5e += datos[i].act5e;
                act6p += datos[i].act6p;
                act6e += datos[i].act6e;
                act7p += datos[i].act7p;
                act7e += datos[i].act7e;
                sprog += datos[i].sprog;
                seje += datos[i].seje;
            }

            Highcharts.chart("fig3", {
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",
                    styledMode: true,
                },
                title: {
                    text: "<b>AVANCE LAZOS DE CORROSIÓN</b>",
                },

                xAxis: {
                    categories: [
                        "CAMBIAR TRACING",
                        "CAMBIAR VALVULA BRIDADA",
                        "CAMBIAR VENTEO",
                        "CAMBIO DE LINEA",
                        "ELIMINACION DE VENTEO",
                        "MANTENIMIENTO DE VALVULA BRIDADA",
                        "SOLDADURA DE SELLO",
                        "AVANCE GENERAL",
                    ],
                    crosshair: true,
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        stacking: 'normal',
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                        name: "PROG",
                        data: [act1p, act2p, act3p, act4p, act5p, act6p, act7p, sprog],
                    },
                    {
                        name: "EJECUTADAS",
                        data: [act1e, act2e, act3e, act4e, act5e, act6e, act7e, seje],
                        stack: 'PRO'
                    },
                    {
                        name: "PENDIENTES",
                        data: [act1p-act1e, act2p-act2e, act3p-act3e, act4p-act4e, act5p-act5e, act6p-act6e, act7p-act7e, sprog-seje],
                        stack: 'PRO'
                    },
                ],
            });
        }

        function cargarInformeInter() {
            $.post(
                "https://utitalco.com/calidad/032/weldbook/server/cargarDatosCCInter.php",
                function (resp) {
                    datos = resp;

                    alert


                    $("#tabla4").jqGrid({
                    datatype: 'local',
                    regional: 'es', // this is default
                    data: datos,
                    colModel: [
                    
                        {name: "item", label: "ID <br><br>.", width: 50, frozen: true}, 
                        {name: "zona", label: "ZONA EN <br> PLANTA <br>.", width: 80, frozen: true}, 
                        {name: "tag", label: "TAG <br><br>.", width: 100, frozen: true},
                        {name: "alcance", label: "ALCANCE", width: 250, align:"center", },
                        {name: "tipo", label: "TIPO", width: 80, align:"center", },
                        {name: "numtubos", label: "No. De <br>TUBOS", width: 80, align:"center", },
                        {name: "descripcion", label: "DESCRIPCIÓN", width: 190,},
                        {name: "phtubos", label: "PH <br> L TUBOS <br>(PSI)", width: 80, align:"center"},
                        {name: "phcasco", label: "PH <br> L CASCO <br>(PSI)", width: 80, align:"center"},
                        {name: "sastubos", label: "LADO <br>TUBOS", width: 80, align:"center"},
                        {name: "sascasco", label: "LADO <br>CASCO", width: 80, align:"center"},
                        {name: "hazubicacion", label: "UBICACIÓN", width: 80, align:"center"},
                        {name: "hazretiro", label: "RETIRO", width: 80, align:"center"},
                        {name: "hazlavado", label: "LAVADO", width: 80, align:"center"},
                        {name: "hazeddy", label: "EDDY / IRIS", width: 80, align:"center"},
                        {name: "hazinspvisual", label: "INSPECCIÓN <br>VISUAL", width: 80, align:"center"},
                        {name: "hazrtpostinsp", label: "RT POST <br>INSPECCIÓN", width: 80, align:"center"},
                        {name: "hazejert", label: "EJECUCIÓN <br>RT", width: 80, align:"center"},
                        {name: "hazcañuelas", label: "CAÑUELAS", width: 80, align:"center"},
                        {name: "hazreentube", label: "REENTUBE", width: 80, align:"center"},
                        {name: "hazliberado", label: "LIBERADO <br>PARA <br>INSTALAR", width: 80, align:"center"},

                        {name: "canalbubicacion", label: "UBICACIÓN", width: 80, align:"center"},
                        {name: "canalblavado", label: "LAVADO", width: 80, align:"center"},
                        {name: "canalblimpieza", label: "LIMPIEZA <br>PARA <br>INSPECCIÓN", width: 80, align:"center"},
                        {name: "canalbinspvisual", label: "INSPECCIÓN <br>VISUAL", width: 80, align:"center"},
                        {name: "canalbrtpostinsp", label: "RT POST <br>INSPECCIÓN", width: 80, align:"center"},
                        {name: "canalbejert", label: "EJECUCIÓN <br>RT", width: 80, align:"center"},
                        {name: "canalbejealcance", label: "EJECUCIÓN <br>ALCANCE", width: 80, align:"center"},
                        {name: "canalbliberado", label: "LIBERADO <br>PARA <br>INSTALAR", width: 80, align:"center"},

                        {name: "tcanalubicacion", label: "UBICACIÓN", width: 80, align:"center"},
                        {name: "tcanalretiro", label: "RETIRO", width: 80, align:"center"},
                        {name: "tcanallavado", label: "LAVADO", width: 80, align:"center"},
                        {name: "tcanallimpieza", label: "LIMPIEZA <br>PARA <br>INSPECCIÓN", width: 80, align:"center"},
                        {name: "tcanalinspvisual", label: "INSPECCIÓN <br>VISUAL", width: 80, align:"center"},
                        {name: "tcanalrtpostinsp", label: "RT POST <br>INSPECCIÓN", width: 80, align:"center"},
                        {name: "tcanalejert", label: "EJECUCIÓN <br>RT", width: 80, align:"center"},
                        {name: "tcanalejealcance", label: "EJECUCIÓN <br>ALCANCE", width: 80, align:"center"},
                        {name: "tcanalliberado", label: "LIBERADO <br>PARA <br>INSTALAR", width: 80, align:"center"},

                        {name: "tcabfubicacion", label: "UBICACIÓN", width: 80, align:"center"},
                        {name: "tcabfretiro", label: "RETIRO", width: 80, align:"center"},
                        {name: "tcabflavado", label: "LAVADO", width: 80, align:"center"},
                        {name: "tcabflimpieza", label: "LIMPIEZA <br>PARA <br>INSPECCIÓN", width: 80, align:"center"},
                        {name: "tcabfinspvisual", label: "INSPECCIÓN <br>VISUAL", width: 80, align:"center"},
                        {name: "tcabfrtpostinsp", label: "RT POST <br>INSPECCIÓN", width: 80, align:"center"},
                        {name: "tcabfejert", label: "EJECUCIÓN <br>RT", width: 80, align:"center"},
                        {name: "tcabfejealcance", label: "EJECUCIÓN <br>ALCANCE", width: 80, align:"center"},
                        {name: "tcabfliberado", label: "LIBERADO <br>PARA <br>INSTALAR", width: 80, align:"center"},

                        {name: "amlubicacion", label: "UBICACIÓN", width: 80, align:"center"},
                        {name: "amlretiro", label: "RETIRO", width: 80, align:"center"},
                        {name: "amllavado", label: "LAVADO", width: 80, align:"center"},
                        {name: "amlinspvisual", label: "INSPECCIÓN <br>VISUAL", width: 80, align:"center"},
                        {name: "amlrtpostinsp", label: "RT POST <br>INSPECCIÓN", width: 80, align:"center"},
                        {name: "amlejert", label: "EJECUCIÓN <br>RT", width: 80, align:"center"},
                        {name: "amlejealcance", label: "EJECUCIÓN <br>ALCANCE", width: 80, align:"center"},
                        {name: "amlliberado", label: "LIBERADO <br>PARA <br>INSTALAR", width: 80, align:"center"},

                        {name: "cclavado", label: "LAVADO", width: 80, align:"center"},
                        {name: "cclimpieza", label: "LIMPIEZA <br>PARA <br>INSPECCIÓN", width: 80, align:"center"},
                        {name: "ccinspvisual", label: "INSPECCIÓN <br>VISUAL", width: 80, align:"center"},
                        {name: "ccrtpostinsp", label: "RT POST <br>INSPECCIÓN", width: 80, align:"center"},
                        {name: "ccejert", label: "EJECUCIÓN <br>RT", width: 80, align:"center"},
                        {name: "ccejealcance", label: "EJECUCIÓN <br>ALCANCE", width: 80, align:"center"},
                        {name: "ccliberado", label: "LIBERADO <br>PARA <br>INSTALAR", width: 80, align:"center"},

                        {name: "tccubicacion", label: "UBICACIÓN", width: 80, align:"center"},
                        {name: "tccretiro", label: "RETIRO", width: 80, align:"center"},
                        {name: "tcclavado", label: "LAVADO", width: 80, align:"center"},
                        {name: "tcclimpieza", label: "LIMPIEZA <br>PARA <br>INSPECCIÓN", width: 80, align:"center"},
                        {name: "tccinspvisual", label: "INSPECCIÓN <br>VISUAL", width: 80, align:"center"},
                        {name: "tccrtpostinsp", label: "RT POST <br>INSPECCIÓN", width: 80, align:"center"},
                        {name: "tccejert", label: "EJECUCIÓN <br>RT", width: 80, align:"center"},
                        {name: "tccejealcance", label: "EJECUCIÓN <br>ALCANCE", width: 80, align:"center"},
                        {name: "tccliberado", label: "LIBERADO <br>PARA <br>INSTALAR", width: 80, align:"center"},

                        {name: "armhaz", label: "HAZ DE TUBOS", width: 80, align:"center"},
                        {name: "armcanal", label: "CANAL", width: 80, align:"center"},
                        {name: "armtcanal", label: "TAPA CANAL", width: 80, align:"center"},
                        {name: "armtcf", label: "TCF Y <br>ANILLOS/ <br>MEDIAS <br>LUNAS", width: 80, align:"center"},
                        {name: "armtapacc", label: "TAPA CASCO", width: 80, align:"center"},

                        {name: "phladotubos", label: "LADO TUBOS", width: 80, align:"center"},
                        {name: "phladocasco", label: "LADO CASCO", width: 80, align:"center"},

                        {name: "normsoldsello", label: "SOLDADURA <br>DE SELLOS", width: 80, align:"center"},
                        {name: "normpintura", label: "PINTURA <br>EXTERIOR", width: 80, align:"center"},
                        {name: "normaislamiento", label: "AISLAMIENTO", width: 80, align:"center"},
                        {name: "normretciegos", label: "RETIRO DE <br>CIEGOS", width: 80, align:"center"},
                        {name: "normrca", label: "RCA", width: 80, align:"center"},

                                       
                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: ventana_ancho,
                    height: ventana_alto,
                    rowNum: 1000,
                    pager: "#jqGridPager"
                });

               

                $("#tabla4").jqGrid('filterToolbar',
                {autoSearch: true, searchOnEnter: false,});
                                            

                $("#tabla4").jqGrid('setGroupHeaders', {
                    useColSpanStyle: true,
                    groupHeaders: [
                         
                        {
                            startColumnName: 'sastubos',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>SAS</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'hazubicacion',
                            numberOfColumns: 10,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>HAZ DE TUBOS</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'canalbubicacion',
                            numberOfColumns: 8,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CANAL Ó BONETE</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'tcanalubicacion',
                            numberOfColumns: 9,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TAPA CANAL</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'tcabfubicacion',
                            numberOfColumns: 9,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TAPA CABEZAL FLOTANTE</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'amlubicacion',
                            numberOfColumns: 8,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>ANILLO Y MEDIAS LUNAS</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'cclavado',
                            numberOfColumns: 7,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>CASCO</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'tccubicacion',
                            numberOfColumns: 9,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>TAPA CASCO</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'armhaz',
                            numberOfColumns: 5,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>ARMADO DE PARTES</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'phladotubos',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>PRUEBA HIDROSTÁTICA</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'normsoldsello',
                            numberOfColumns: 5,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>NORMALIZACIÓN</center></td></tr>' +
                                '</table>',
                        },
                        
                         
                    ]
                });

               

                $("#tabla4").jqGrid('setFrozenColumns');
                
                
                
                }
            );
        }

        function cargarInformeTambores() {
            $.post(
                "https://utitalco.com/calidad/032/weldbook/server/cargarDatosCCTambores.php",
                function (resp) {
                    datos = resp;

                    console.log(datos);

                    $("#tabla5").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: datos,
                        colModel: [{
                                name: "item",
                                label: "ID <br><br>.",
                                width: 30,
                                frozen: true,
                            },
                            {
                                name: "tag",
                                label: "TAG <br><br>.",
                                width: 60,
                                frozen: true,
                            },
                            {
                                name: "alcance",
                                label: "ALCANCE",
                                width: 250,
                                align: "center",
                            },
                            {
                                name: "instsas",
                                label: "INST <br>SAS",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "abrirm",
                                label: "ABRIR <br>MANHOLES",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "instfacint",
                                label: "INSTALACIÓN <br>FACILIDADES <br>INTERNAS",
                                width: 80,
                            },
                            {
                                name: "retint",
                                label: "RETIRO DE <br>INTERNOS",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "limpint",
                                label: "LIMPIEZA <br>INTERNOS",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "retaislamiento",
                                label: "RETIRO DE <br>AISLAMIENTO",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "limpext",
                                label: "LIMPIEZA <br>EXTERNA",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "inspvisual",
                                label: "INSPECCIÓN <br>VISUAL",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "tomaesp",
                                label: "TOMA DE <br>ESPESORES",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "areasello",
                                label: "ÁREA DE <br>SELLO",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "inspinternos",
                                label: "INTERNOS",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "instint",
                                label: "INSTALACIÓN <br>DE INTERNOS",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "cierrem",
                                label: "CIERRE DE <br>MANHOLES",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "torque",
                                label: "NORMALIZACIÓN <br>AJUSTE Y <br>TORQUE",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "limpypintura",
                                label: "LIMPIEZA Y <br>PINTURA A <br>BASE DE <br>CONCRETO",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "pinturaext",
                                label: "APLICACIÓN <br>DE PINTURA <br>EXTERIOR",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "instaislamiento",
                                label: "INSTALACIÓN <br>DE <br>AISLAMIENTO",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "retsas",
                                label: "RETIRO <br>DE SAS",
                                width: 80,
                                align: "center",
                            },
                            {
                                name: "rca",
                                label: "RCA",
                                width: 80,
                                align: "center"
                            },
                            {
                                name: "obs",
                                label: "OBSERVACIONES",
                                width: 250,
                                align: "center",
                            },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 150,
                        rowNum: 1000,
                        pager: "#jqGridPager",
                    });

                    $("#tabla5").jqGrid("filterToolbar", {
                        autoSearch: true,
                        searchOnEnter: false,
                    });

                    $("#tabla5").jqGrid("setGroupHeaders", {
                        useColSpanStyle: true,
                        groupHeaders: [{
                            startColumnName: "inspvisual",
                            numberOfColumns: 4,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>INSPECCIÓN</center></td></tr>' +
                                "</table>",
                        }, ],
                    });

                    $("#tabla5").jqGrid("setFrozenColumns");
                }
            );
        }

        function cargarInformeLgs() {
            $.post(
                "https://utitalco.com/calidad/032/weldbook/server/cargarDatosCCLgs.php",
                function (resp) {
                    datos = resp;

                    console.log(datos);

                    if(datos !=null){

                        $("#tabla6").jqGrid({
                            datatype: "local",
                            regional: "es", // this is default
                            data: datos,
                            colModel: [{
                                    name: "equipo",
                                    label: "EQUIPO",
                                    width: 120,
                                    frozen: true
                                },
                                {
                                    name: "alcance",
                                    label: "ALCANCE",
                                    width: 250,
                                    align: "center",
                                },
                                {
                                    name: "intervencion",
                                    label: "INTERVENCIÓN <br>DE EQUIPO",
                                    width: 80,
                                    align: "center",
                                },
                                {
                                    name: "desarmado",
                                    label: "DESARMADO <br>DE <br>COMPONENTES",
                                    width: 80,
                                    align: "center",
                                },
                                {
                                    name: "limpieza",
                                    label: "LIMPIEZA <br>Y ARMADO",
                                    width: 80
                                },
                                {
                                    name: "instvalvulas",
                                    label: "INST DE <br>VALULVAS",
                                    width: 80,
                                    align: "center",
                                },
                                {
                                    name: "soldadurasello",
                                    label: "SOLDADURA <br>DE SELLO",
                                    width: 80,
                                    align: "center",
                                },
                                {
                                    name: "ph",
                                    label: "PRUEBA <br>HIDROSTÁTICA",
                                    width: 80,
                                    align: "center",
                                },
                                {
                                    name: "montaje",
                                    label: "MONTAJE E <br>INSTALACIÓN",
                                    width: 80,
                                    align: "center",
                                },
                                {
                                    name: "torque",
                                    label: "TORQUE Y <br>TARJETEO",
                                    width: 80,
                                    align: "center",
                                },
                                {
                                    name: "rca",
                                    label: "RCA",
                                    width: 80,
                                    align: "center"
                                },
                                {
                                    name: "obs",
                                    label: "OBSERVACIONES",
                                    width: 250,
                                    align: "center",
                                },
                            ],
                            loadonce: true,
                            shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                            width: ventana_ancho,
                            height: 150,
                            rowNum: 1000,
                            pager: "#jqGridPager",
                        });
    
                        $("#tabla6").jqGrid("filterToolbar", {
                            autoSearch: true,
                            searchOnEnter: false,
                        });
    
                        $("#tabla6").jqGrid("setFrozenColumns");
                    }

                }
            );
        }

        function cargarInformeSoldaduraEquipos() {
            $.post(
                "https://utitalco.com/calidad/032/weldbook/server/cJuntasEquipos.php",
                function (resp) {
                    datos = resp;

                    $("#tabla7").jqGrid({
                        datatype: "local",
                        regional: "es", // this is default
                        data: datos,
                        colModel: [{
                                name: "especialidad",
                                label: "ESPECIALIDAD",
                                width: 150,
                                frozen: true,
                            },
                            {
                                name: "equipo",
                                label: "EQUIPO",
                                width: 200,
                                frozen: true,
                            },
                            {
                                name: "pulgadas",
                                label: "PULG",
                                width: 70,
                                align: "center",
                                frozen: true,
                            },
                            {
                                name: "jpt",
                                label: "JUNTAS <br> PROG",
                                width: 70,
                                align: "center",
                                formatter: {
                                    integer: {
                                        thousandsSeparator: " ",
                                        defaultValue: "0",
                                    },
                                },
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "jet",
                                label: "JUNTAS  <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "jpdt",
                                label: "JUNTAS  <br> PDTES",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "ajt",
                                label: "% AVANCE",
                                width: 70,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["jpt"]) {
                                        value.totalAmount += parseFloat(record["jpt"]);
                                    }
                                    if (record["jet"]) {
                                        value.totalTax += parseFloat(record["jet"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },
                            {
                                name: "ppt",
                                label: "PULG DIAM <br> PROG",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "pet",
                                label: "PULG DIAM <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "ppdt",
                                label: "PULG DIAM <br> PDTES",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "apt",
                                label: "% AVANCE",
                                width: 70,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["ppt"]) {
                                        value.totalAmount += parseFloat(record["ppt"]);
                                    }
                                    if (record["pet"]) {
                                        value.totalTax += parseFloat(record["pet"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },
                            {
                                name: "jpc",
                                label: "JUNTAS <br> PROG",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "jec",
                                label: "JUNTAS <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "jpdc",
                                label: "JUNTAS <br> PDTES",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "ajc",
                                label: "% AVANCE",
                                width: 70,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["jpc"]) {
                                        value.totalAmount += parseFloat(record["jpc"]);
                                    }
                                    if (record["jec"]) {
                                        value.totalTax += parseFloat(record["jec"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },
                            {
                                name: "ppc",
                                label: "PULG DIAM <br> PROG",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "pec",
                                label: "PULG DIAM <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "ppdc",
                                label: "PULG DIAM <br> PDTES",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "apc",
                                label: "% AVANCE",
                                width: 70,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["ppc"]) {
                                        value.totalAmount += parseFloat(record["ppc"]);
                                    }
                                    if (record["pec"]) {
                                        value.totalTax += parseFloat(record["pec"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },
                            {
                                name: "jptot",
                                label: "JUNTAS <br> PROG",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "jetot",
                                label: "JUNTAS <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "jtpdc",
                                label: "JUNTAS <br> PDTES",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "ajtot",
                                label: "% AVANCE",
                                width: 70,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["jptot"]) {
                                        value.totalAmount += parseFloat(record["jptot"]);
                                    }
                                    if (record["jetot"]) {
                                        value.totalTax += parseFloat(record["jetot"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },
                            {
                                name: "pptot",
                                label: "PULG DIAM <br> PROG",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "petot",
                                label: "PULG DIAM <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "ptpdc",
                                label: "PULG DIAM <br> PDTES",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",
                                summaryType: "sum",
                            },
                            {
                                name: "aptot",
                                label: "% AVANCE",
                                width: 70,
                                align: "center",
                                formatoptions: {
                                    suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                    // initialize the value object
                                    if (typeof value === "string") {
                                        value = {
                                            totalAmount: 0,
                                            totalTax: 0,
                                        };
                                    }
                                    // perform summary
                                    if (record["pptot"]) {
                                        value.totalAmount += parseFloat(record["pptot"]);
                                    }
                                    if (record["petot"]) {
                                        value.totalTax += parseFloat(record["petot"]);
                                    }
                                    return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                    // get the regional options and pass it to the custom formatter
                                    opts = $.extend({},
                                        $.jgrid.getRegional(this, "formatter"),
                                        opts
                                    );
                                    // determine if we are in summary row to put the value
                                    if (opts.rowId === "") {
                                        if (cellval.totalAmount !== 0) {
                                            var val =
                                                (cellval.totalTax / cellval.totalAmount) * 100;
                                            return $.fn.fmatter("number", val, opts, rwdat, act);
                                        } else {
                                            return "0";
                                        }
                                    } else {
                                        return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                    }
                                },
                            },
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 300,
                        rowNum: 1000,
                        pager: "#jqGridPager",

                        grouping: true,
                        groupingView: {
                            groupField: ["especialidad"],
                            groupColumnShow: [true],
                            groupText: ["<b>{0}</b>"],
                            groupOrder: ["asc"],
                            groupSummary: [true],
                            groupSummaryPos: ["header"],
                            groupCollapse: false,
                        },
                    });

                    $("#tabla7").jqGrid("setGroupHeaders", {
                        useColSpanStyle: true,
                        groupHeaders: [{
                                startColumnName: "jpt",
                                numberOfColumns: 8,
                                titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                    '<tr><td id="h0" style="color: #000;"><center>TALLER</center></td></tr>' +
                                    "</table>",
                            },
                            {
                                startColumnName: "jpc",
                                numberOfColumns: 8,
                                titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(135, 244, 252); border-style: solid; border-color: #b1b1b1 !important ">' +
                                    '<tr><td id="h0" style="color: #000;"><center>CAMPO</center></td></tr>' +
                                    "</table>",
                            },
                            {
                                startColumnName: "jptot",
                                numberOfColumns: 8,
                                titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(153, 250, 169); border-style: solid; border-color: #b1b1b1 !important ">' +
                                    '<tr><td id="h0" style="color: #000;"><center>TOTAL</center></td></tr>' +
                                    "</table>",
                            },
                        ],
                    });

                    $("#tabla7").jqGrid("setFrozenColumns");
                }
            );
        }

        function cargarInformeBridas(){
            $.post('https://utitalco.com/calidad/032/weldbook/server/repBridas.php', function (resp) {
                    datos = resp
                    $("#tabla9").jqGrid({
                        datatype: 'local',
                        regional: 'es', // this is default
                        data: datos,
                        colModel: [{
                                name: "especialidad",
                                label: "ESPECIALIDAD",
                                width: 120,
                                frozen: true
                            },
                            {
                                name: "linea",
                                label: "INGENIERÍA <br> / LÍNEA <br> / EQUIPO",
                                width: 180,
                                frozen: true
                            },
                            {
                                name: "cant",
                                label: "PLANEADAS",
                                width: 80,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },
                            {
                                name: "eje",
                                label: "EJEC",
                                width: 80,
                                align: "center",
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: "sum",
                            },
                            {
                                name: "avance",
                                label: "AVANCE",
                                width: 80,
                                align: "center",
                                formatoptions: {
                                suffix: " %",
                                },
                                summaryTpl: "<b>{0}</b>", // set the summary template to show the group summary
                                summaryType: function (value, name, record) {
                                // initialize the value object
                                if (typeof value === "string") {
                                    value = {
                                    totalAmount: 0,
                                    totalTax: 0,
                                    };
                                }
                                // perform summary
                                if (record["cant"]) {
                                    value.totalAmount += parseFloat(record["cant"]);
                                }
                                if (record["eje"]) {
                                    value.totalTax += parseFloat(record["eje"]);
                                }
                                return value;
                                },
                                formatter: function (cellval, opts, rwdat, act) {
                                // get the regional options and pass it to the custom formatter
                                opts = $.extend({},
                                    $.jgrid.getRegional(this, "formatter"),
                                    opts
                                );
                                // determine if we are in summary row to put the value
                                if (opts.rowId === "") {
                                    if (cellval.totalAmount !== 0) {
                                    var val =
                                        (cellval.totalTax / cellval.totalAmount) * 100;
                                    return $.fn.fmatter("number", val, opts, rwdat, act);
                                    } else {
                                    return "0";
                                    }
                                } else {
                                    return $.fn.fmatter("number", cellval, opts, rwdat, act);
                                }
                                },
                            },


                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: ventana_ancho,
                        height: 250,
                        rowNum: 1000,
                        pager: "#jqGridPager",

                        grouping: true,
                        groupingView: {
                        groupField: ["especialidad"],
                        groupColumnShow: [true],
                        groupText: ["<b>{0}</b>"],
                        groupOrder: ["asc"],
                        groupSummary: [true],
                        groupSummaryPos: ["header"],
                        groupCollapse: true,
                        },
                    });

                    cargarGraficasBridas()



                })
        }

         function cargarGraficasBridas() {

            var titulo = []
            var prog = []
            var ejec = []
            var avance = []


            for (var i = 0; i < datos.length; i++) {
                titulo.push(datos[i].especialidad + ' - ' + datos[i].linea);
                prog.push(datos[i].cant)
                ejec.push(datos[i].eje)
                var pend = datos[i].cant - datos[i].eje
                avance.push(pend)
            }

            console.log('titulos')
            console.log(titulo)

            Highcharts.chart("fig4", {
                colors: [
                    "#7cb5ec",
                    "#90ed7d",
                    "#9a9a9c",
                    "#f7a35c",
                    "#8085e9",
                    "#f15c80",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",

                    height: 600
                },
                title: {
                    text: "<b>AVANCE UNIONES BRIDADAS</b>",
                },

                xAxis: {
                    categories: titulo,
                    crosshair: true,
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        stacking: 'normal',
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                    name: "TOTALES",
                    data: prog,
                },
                {
                    name: "EJECUTADAS",
                    data: ejec,
                    stack: 'PRO'
                },
                {
                    name: "PENDIENTES",
                    data: avance,
                    stack: 'PRO'
                },
                ],
            });
        
        
        }

        // function cargarGraficasBridas() {

        //     var titulo = []
        // var prog = []
        // var ejec = []
        // var avance = []
            
           
        //     for (var i = 0; i < datos.length; i++) {
        //         titulo.push(datos[i].linea);
        //         prog.push(datos[i].cant)
        //         ejec.push(datos[i].eje)
        //         var pend = datos[i].cant - datos[i].eje
        //         avance.push(pend)
        //     }
        //      console.log('titulo')
        //      console.log(titulo)

        //      console.log('prog')
        //      console.log(prog)

        //      console.log('ejec')
        //      console.log(ejec)
         
        //     Highcharts.chart("fig4", {
        //         credits: {
        //             enabled: false,
        //         },
        //         chart: {
        //             type: "column",
        //             styledMode: true,
        //             height: 600
        //         },
        //         title: {
        //             text: "<b>AVANCE UNIONES BRIDADAS</b>",
        //         },

        //         xAxis: {
        //             categories: titulo,
        //             crosshair: true,
        //         },

        //         yAxis: {
        //             min: 0,
        //             title: {
        //                 text: "Cant",
        //             },
        //         },
        //         tooltip: {
        //             headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
        //             pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
        //                 '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
        //             footerFormat: "</table>",
        //             shared: true,
        //             useHTML: true,
        //         },
        //         plotOptions: {
        //             column: {
        //                 stacking: 'normal',
        //                 pointPadding: 0.2,
        //                 borderWidth: 0,
        //                 dataLabels: {
        //                     enabled: true,
        //                 },
        //             },
        //         },
        //         series: [{
        //                 name: "TOTALES",
        //                 data: prog,
        //             },
        //             {
        //                 name: "EJECUTADAS",
        //                 data: ejec,
        //                 stack: 'PRO'
        //             },
        //             {
        //                 name: "PENDIENTES",
        //                 data: avance,
        //                 stack: 'PRO'
        //             },
        //         ],
        //     });
        // }

        function cargarAvanceDiario() {

            $('#fechac').val(fechabuscar)

            $.post("https://utitalco.com/calidad/032/weldbook/server/cJuntasEquiposEje.php", {fecha:fechabuscar}, function (resp) {
                datos = resp;

                if(datos == null){
                    Swal.fire({
                        position: 'top-end',
                        icon: 'info',
                        title: 'Sin registros...',
                        showConfirmButton: false,
                        timer: 1500
                    })
                }else{

                                    
                    $("#tabla10").jqGrid({
                        datatype: 'local',
                        regional: 'es', // this is default
                        data: datos,
                        colModel: [{
                                name: "especialidad",
                                label: "ESPECIALIDAD",
                                width: 150,
                                frozen: true
                            },
                            {
                                name: "equipo",
                                label: "EQUIPO",
                                width: 200,
                                frozen: true
                            },
                            {
                                name: "pulgadas",
                                label: "PULG",
                                width: 70,
                                align: "center",
                                frozen: true
                            },
                            {
                                name: "jet",
                                label: "JUNTAS <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",  
                                summaryType: "sum" 
                            },
                            
                            {
                                name: "pet",
                                label: "PULG DIAM <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",  
                                summaryType: "sum" 
                            },
                            
                            
                            
                            {
                                name: "jec",
                                label: "JUNTAS <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",  
                                summaryType: "sum" 
                            },
                            
                            
                            {
                                name: "pec",
                                label: "PULG DIAM <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",  
                                summaryType: "sum" 
                            },
                            
                            {
                                name: "jetot",
                                label: "JUNTAS <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",  
                                summaryType: "sum" 
                            },
                            
                            
                            {
                                name: "petot",
                                label: "PULG DIAM <br> EJE",
                                width: 70,
                                align: "center",
                                summaryTpl: "<b>{0}</b>",  
                                summaryType: "sum" 
                            },
                            
                        ],
                        loadonce: true,
                        shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                        width: 900,
                        height: 200,
                        rowNum: 1000,
                        pager: "#jqGridPager",

                        grouping: true,
                        groupingView: {
                            groupField: ["especialidad"],
                            groupColumnShow: [true],
                            groupText: ["<b>{0}</b>"],
                            groupOrder: ["asc"],
                            groupSummary: [true],
                            groupSummaryPos: ['header'],
                            groupCollapse: true
                        }
                    });

                    $("#tabla10").jqGrid('setGroupHeaders', {
                        useColSpanStyle: true,
                        groupHeaders: [{
                                startColumnName: 'jet',
                                numberOfColumns: 2,
                                titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                    '<tr><td id="h0" style="color: #000;"><center>TALLER</center></td></tr>' +
                                    '</table>',
                            },
                            {
                                startColumnName: 'jec',
                                numberOfColumns: 2,
                                titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(135, 244, 252); border-style: solid; border-color: #b1b1b1 !important ">' +
                                    '<tr><td id="h0" style="color: #000;"><center>CAMPO</center></td></tr>' +
                                    '</table>',
                            },
                            {
                                startColumnName: 'jetot',
                                numberOfColumns: 2,
                                titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(153, 250, 169); border-style: solid; border-color: #b1b1b1 !important ">' +
                                    '<tr><td id="h0" style="color: #000;"><center>TOTAL</center></td></tr>' +
                                    '</table>',
                            },
                        ]
                    });

                    

                    $("#tabla10").jqGrid('setFrozenColumns');



                    $.post("https://utitalco.com/calidad/032/weldbook/server/cJuntasEquiposPlanEje.php", {fecha:fechabuscar}, function (resp) {
                        soldadores = resp
                        datos = resp.prog;
                        data = resp
                        console.log(resp)

                            $("#tabla11").jqGrid({
                                datatype: 'local',
                                regional: 'es', // this is default
                                data: datos,
                                colModel: [{
                                        name: "equipo",
                                        label: "EQUIPO",
                                        width: 150,
                                        frozen: true
                                    },
                                    {
                                        name: "plano",
                                        label: "PLANO",
                                        width: 200,
                                        frozen: true
                                    },
                                    {
                                        name: "pulgadas",
                                        label: "PULG",
                                        width: 70,
                                        align: "center",
                                        frozen: true
                                    },
                                    {
                                        name: "jet",
                                        label: "JUNTAS <br> EJE",
                                        width: 70,
                                        align: "center",
                                        summaryTpl: "<b>{0}</b>",  
                                        summaryType: "sum" 
                                    },
                                    
                                    {
                                        name: "pet",
                                        label: "PULG DIAM <br> EJE",
                                        width: 70,
                                        align: "center",
                                        summaryTpl: "<b>{0}</b>",  
                                        summaryType: "sum" 
                                    },
                                    
                                    
                                    
                                    {
                                        name: "jec",
                                        label: "JUNTAS <br> EJE",
                                        width: 70,
                                        align: "center",
                                        summaryTpl: "<b>{0}</b>",  
                                        summaryType: "sum" 
                                    },
                                    
                                    
                                    {
                                        name: "pec",
                                        label: "PULG DIAM <br> EJE",
                                        width: 70,
                                        align: "center",
                                        summaryTpl: "<b>{0}</b>",  
                                        summaryType: "sum" 
                                    },
                                    
                                    {
                                        name: "jetot",
                                        label: "JUNTAS <br> EJE",
                                        width: 70,
                                        align: "center",
                                        summaryTpl: "<b>{0}</b>",  
                                        summaryType: "sum" 
                                    },
                                    
                                    
                                    {
                                        name: "petot",
                                        label: "PULG DIAM <br> EJE",
                                        width: 70,
                                        align: "center",
                                        summaryTpl: "<b>{0}</b>",  
                                        summaryType: "sum" 
                                    },
                                    
                                ],
                                loadonce: true,
                                shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                                width: 900,
                                height: 200,
                                rowNum: 1000,
                                pager: "#jqGridPager2",

                                grouping: true,
                                groupingView: {
                                    groupField: ["equipo"],
                                    groupColumnShow: [true],
                                    groupText: ["<b>{0}</b>"],
                                    groupOrder: ["asc"],
                                    groupSummary: [true],
                                    groupSummaryPos: ['header'],
                                    groupCollapse: true
                                }
                            });

                            $("#tabla11").jqGrid('setGroupHeaders', {
                                useColSpanStyle: true,
                                groupHeaders: [{
                                        startColumnName: 'jet',
                                        numberOfColumns: 2,
                                        titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                            '<tr><td id="h0" style="color: #000;"><center>TALLER</center></td></tr>' +
                                            '</table>',
                                    },
                                    {
                                        startColumnName: 'jec',
                                        numberOfColumns: 2,
                                        titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(135, 244, 252); border-style: solid; border-color: #b1b1b1 !important ">' +
                                            '<tr><td id="h0" style="color: #000;"><center>CAMPO</center></td></tr>' +
                                            '</table>',
                                    },
                                    {
                                        startColumnName: 'jetot',
                                        numberOfColumns: 2,
                                        titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(153, 250, 169); border-style: solid; border-color: #b1b1b1 !important ">' +
                                            '<tr><td id="h0" style="color: #000;"><center>TOTAL</center></td></tr>' +
                                            '</table>',
                                    },
                                ]
                            });

                            

                            $("#tabla11").jqGrid('setFrozenColumns');

                          

                            $('#cantsoldDemex').html(data.cantsold)
                            $('#rendDemex').html(data.rend + ' Pulg ')

                            var html = ''

                            rendi = soldadores.rendimiento;

                            for(var i=0; i < rendi.length; i++ ){
                                html += `
                                ESPECIALIDAD :  ${rendi[i].especialidad} | Total Juntas Realizadas | ${rendi[i].juntas} | Total Pulgadas Realizadas | ${rendi[i].pulg}
                            | # Soldadores | ${rendi[i].cansold}
                            | Rendimiento por Soldador  | ${rendi[i].rendimiento.toFixed(2)} | <hr>
                                `
                            }

                            $('#rendimientos').html(html)

                            

                            

                    })

                    var totj = 0;
                    var totp = 0;


                    for(var i=0; i<datos.length; i++){
                        
                        totj += datos[i].jetot;
                        totp += datos[i].petot;
                        console.log(totj)
                    }

                    

                    $('#totjuntasDemex').html(totj)
                    $('#totpulgDemex').html(totp)

                    
 
                   


                    

                    Swal.close();

                }

               




            });
        }

        function cargarInformeValvulas() {


            $.post("https://utitalco.com/calidad/032/weldbook/server/cargarDatosCCValvulas.php", function (resp) {
                datos = resp;

                console.log(datos);
                 
                $("#tabla12").jqGrid({
                    datatype: 'local',
                    regional: 'es', // this is default
                    data: datos,
                    colModel: [
                    
                        {name: "item", label: "ID <br><br>.", width: 50, frozen: true}, 
                        {name: "tag", label: "TAG <br><br>.", width: 100, frozen: true},
                        {name: "retiro", label: "RETIRO DE LA <br> VÁLVULA", width: 80, align:"center"},
                        {name: "instbridas", label: "INSTALACIÓN <br> BRIDAS CIEGAS", width: 80, align:"center"},
                        {name: "trastaller", label: "TRASLADO A <br>TALLER PARA <br>MANTENIM.", width: 80, align:"center"},
                        {name: "retvalvulataller", label: "RETIRO DE VÁLVULA <br>DEL TALLER <br>REGISTRO DEL MTTO <br>DEL TALLER DE VAL.", width: 80, align:"center"},
                        {name: "instvalvula", label: "INSTALAR <br>VÁLVULA", width: 80, align:"center"},
                        {name: "etiqueta", label: "ETIQUETA <br>DE BRIDA", width: 80, align:"center"},
                        {name: "rca", label: "RCA", width: 80, align:"center"},
                        {name: "observaciones", label: "OBSERVACIONES", width: 300, align:"center"},
                       

                                       
                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: ventana_ancho,
                    height: 150,
                    rowNum: 1000,
                    pager: "#jqGridPager"
                });

               

                $("#tabla12").jqGrid('filterToolbar',
                {autoSearch: true, searchOnEnter: false,});
                                            


                $("#tabla12").jqGrid('setFrozenColumns');

                

            
            
            });
        }

        function cargarInformeTorres() {

            $.post("https://utitalco.com/calidad/032/weldbook/server/cargarDatosCCTorres.php", function (resp) {
                datos = resp;

                console.log(datos);
                 
                $("#tabla13").jqGrid({
                    datatype: 'local',
                    regional: 'es', // this is default
                    data: datos,
                    colModel: [
                    
                        {name: "tag", label: "TAG ", width: 100, align:"center", frozen: true},
                        {name: "zona", label: "ZONA", width: 100, align:"center", frozen: true},
                        {name: "retaislamiento", label: "RETIRAR <br> AISLAMIENTO <br>EXTERNO", width: 80, align:"center"},
                        {name: "instsas", label: "INSTALAR <br> SAS", width: 80, align:"center"},
                        {name: "apertmanholes", label: "APERTURA DE <br>MANHOLES", width: 80, align:"center"},
                        {name: "instfacilidades", label: "INSTALAR <br>FACILIDADES", width: 80, align:"center"},
                        {name: "retirointernos", label: "RETIRO <br>INTERNOS", width: 80, align:"center"},
                        {name: "armarandamios", label: "ARMAR <br>ANDAMIOS <br>INTERNOS", width: 80, align:"center"},
                        {name: "retirolgs", label: "RETIRO <br>LG'S", width: 80, align:"center"},
                        {name: "limpinterna", label: "INTERNA", width: 80, align:"center"},
                        {name: "limpexterna", label: "EXTERNA", width: 80, align:"center"},
                        {name: "inspinterna", label: "INTERNA", width: 80, align:"center"},
                        {name: "inspexterna", label: "EXTERNA", width: 80, align:"center"},
                        {name: "inspend", label: "END", width: 80, align:"center"},
                        {name: "recpostinterna", label: "INTERNA", width: 80, align:"center"},
                        {name: "recpostexterna", label: "EXTERNA", width: 80, align:"center"},
                        {name: "ejerecinterna", label: "INTERNA", width: 80, align:"center"},
                        {name: "ejerecexterna", label: "EXTERNA", width: 80, align:"center"},
                        {name: "instlining", label: "INSTALACIÓN <br>LILNING", width: 80, align:"center"},
                        {name: "plining", label: "PRUEBA <br> NEUMÁTICA <br>LINING", width: 80, align:"center"},
                        {name: "instinternos", label: "INSTALACIÓN <br>INTERNOS", width: 80, align:"center"},
                        {name: "mttolgs", label: "MTTO LG'S", width: 80, align:"center"},
                        {name: "instlgs", label: "INSTALACIÓN <br>LG'S", width: 80, align:"center"},
                        {name: "pruebadistri", label: "PRUEBA <br>DISTRIBUIDOR <br>EN PISO", width: 80, align:"center"},
                        {name: "pruebarociado", label: "PRUEBA <br>ROCIADO <br>DISTRIBUIDOR", width: 80, align:"center"},
                        {name: "pruebagoteo", label: "PRUEBA <br>GOTEO DE <br>COLECTOR", width: 80, align:"center"},
                        {name: "retirarfac", label: "RETIRAR <br>FACILIDADES", width: 80, align:"center"},
                        {name: "desarmandamios", label: "DESARMAR <br>ANDAMIOS <br>INTERNOS", width: 80, align:"center"},
                        {name: "cierremanholes", label: "CIERRE DE<br> MANHOLES", width: 80, align:"center"},
                        {name: "pintura", label: "PINTURA /<br>AISLAMIENTO", width: 80, align:"center"},
                        {name: "retirosas", label: "RETIRO SAS", width: 80, align:"center"},
                        {name: "limpbases", label: "LIMPIEZA Y <br>PINTURA A <br>BASES DE <br>CONCRETO", width: 80, align:"center"},
                        {name: "etiquetabridas", label: "ETIQUETA <br>DE BRIDAS", width: 80, align:"center"},
                        {name: "rca", label: "REGISTRO DE <br>TRABAJO", width: 80, align:"center"},
                        {name: "observaciones", label: "OBSERVACIONES", width: 500, align:"center"},
                                       
                    ],
                    loadonce: true,
                    shrinkToFit: false, // must be set with frozen columns, otherwise columns will be shrank to fit the grid width
                    width: ventana_ancho,
                    height: 150,
                    rowNum: 1000,
                    pager: "#jqGridPager"
                });

               

                $("#tabla13").jqGrid('filterToolbar',
                {autoSearch: true, searchOnEnter: false,});

                $("#tabla13").jqGrid('setGroupHeaders', {
                    useColSpanStyle: true,
                    groupHeaders: [
                         
                        {
                            startColumnName: 'limpinterna',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>LIMPIEZA</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'inspinterna',
                            numberOfColumns: 3,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>INSPECCIÓN</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'recpostinterna',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>RECOMENDACIÓN TÉCNICA <br>POST-INSPECCIÓN</center></td></tr>' +
                                '</table>',
                        },
                        {
                            startColumnName: 'ejerecinterna',
                            numberOfColumns: 2,
                            titleText: '<table style="width:100%;border-spacing:2px; border-width: 1px; background-color:rgb(233, 252, 147); border-style: solid; border-color: #b1b1b1 !important ">' +
                                '<tr><td id="h0" style="color: #000;"><center>EJECUCIÓN DE <br>RECOMENDACIÓN TÉCNICA</center></td></tr>' +
                                '</table>',
                        },
                       
                        
                         
                    ]
                });

                                            

              

                $("#tabla13").jqGrid('setFrozenColumns');

               

            
            
            });
        }

        function cargarInformeSoldadura() {
             
            $.post('https://utitalco.com/calidad/032/server/curvaSoldadura.php', {
                    ods: odsq,
                    fecha: fechab
                },
                function (resp) {
                   
                    console.log(resp)

                    arrayDatos = resp.soldp

                    for(var i=0; i<arrayDatos.length; i++ ){
                        arrayFechas.push(arrayDatos[i].fecha)
                        arrayProg.push(arrayDatos[i].progacum)
                        
                        // arrayFechas.push(arrayDatos[i].fecha)
                    }

                    arrayDatos = resp.solde
                    var arrayDatosTmp = resp.soldp

                    for(var i=0; i<arrayDatos.length; i++ ){
                        arrayEje.push(arrayDatos[i].ejeacum)

                        arrayProgAcum = arrayDatosTmp[i].progacum
                        arrayEjeAcum = arrayDatos[i].ejeacum
                        // arrayFechas.push(arrayDatos[i].fecha)
                    }



                    Swal.close()

                    cargarGraficasSoldadura()
 

                })
        }


        function cargarGraficasSoldadura() {

            Highcharts.chart('figsold', {
                colors: [
                    "#004236",
                    "#00c901",
                    "#F8F9F9 ",
                    "#C51111",
                    "#a4c639",
                    "#180272",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: 'spline',
                    height: 600,
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:.f} </b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                title: {
                    text: 'CURVA SOLDADURA'
                },
                
                xAxis: {
                    categories: arrayFechas
                },
                yAxis: {
                    title: {
                        text: 'CANT PULGADAS'
                    }
                },
                plotOptions: {
                    spline: {
                        dataLabels: {
                            enabled: true
                        },
                        enableMouseTracking: true
                    }
                },
                series: 
                [
                    {
                    name: 'PROG ACUM',
                    data: arrayProg
                    },
                    {
                    name: 'EJE ACUM',
                    data: arrayEje
                    },
                
                ]
            });

            var desv = (arrayEjeAcum-arrayProgAcum).toFixed(2)
            desv = parseFloat(desv)
           
            Highcharts.chart('figavancediario', {
                 
                 credits: {
                     enabled: false
                 },
                 chart: {
                     type: 'column',
                     height: 600,
                     // options3d: {
                     //     enabled: true,
                     //     alpha: 15,
                     //     beta: 15,
                     //     viewDistance: 25,
                     //     depth: 40
                     // }
                 },
                 title: {
                     text: '<b>AVANCE DIARIO ACUMULADO SOLDADURA POR PULGADAS DIAMETRALES</b>'
                 },
 
                 xAxis: {
                     categories: ['PULGADAS'],
                     crosshair: true
                 },
 
                
                 tooltip: {
                     headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                     pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                         '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                     footerFormat: '</table>',
                     shared: true,
                     useHTML: true
                 },
                 plotOptions: {
                     column: {
                         pointPadding: 0.2,
                         borderWidth: 0,
                         dataLabels: {
                             enabled: true
                         }
                     }
                 },
                 series: [
                 {
                     name: 'PULG PROG',
                     data: [arrayProgAcum]
                 }, {
                     name: 'PULG EJE',
                     data: [arrayEjeAcum]
                 }
                 , {
                     name: 'DESVIACIÓN',
                     data: [desv]
                 }
             ]
             });
 

            
           
            
        }
        
        
    
    </script>
</body>

</html>
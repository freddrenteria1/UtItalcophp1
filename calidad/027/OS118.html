<!DOCTYPE html>

<html>

<head>

	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title></title>
	<meta name="generator" content="LibreOffice 7.3.6.2 (Linux)" />
	<meta name="author" content="angelica maria gomez" />
	<meta name="created" content="2004-08-31T02:48:55" />
	<meta name="changedby" content="01AC0479" />
	<meta name="changed" content="2022-11-10T15:40:00" />

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

	<style type="text/css">
		body,
		div,
		table,
		thead,
		tbody,
		tfoot,
		tr,
		th,
		td,
		p {
			font-family: "Arial";
			font-size: x-small
		}

		a.comment-indicator:hover+comment {
			background: #ffd;
			position: absolute;
			display: block;
			border: 1px solid black;
			padding: 0.5em;
		}

		a.comment-indicator {
			background: red;
			display: inline-block;
			border: 1px solid black;
			width: 0.5em;
			height: 0.5em;
		}

		comment {
			display: none;
		}
	</style>

	<style>
		@media print {

			.oculto-impresion,
			.oculto-impresion * {
				display: none !important;
			}
		}

		.salto {
			PAGE-BREAK-AFTER: always;
		}

		.mispan {
			font-size: 16px;
		}

		textarea {
			font-size: 18px;
		}

		input[type=text] {
			width: 100%;
			padding: 12px;
			margin: 8px 0;
			border: 0;
			box-sizing: border-box;
			font-size: 18px;

		}

		.lineabaja {
			border-bottom-style: solid;
			border-bottom-width: 1px;
		}

		input[type=date] {
			width: 100%;
			padding: 12px;
			margin: 8px 0;
			border: 0;
			box-sizing: border-box;
			font-size: 18px;
		}

		input[type=time] {
			width: 100%;
			padding: 12px;
			margin: 8px 0;
			border: 0;
			box-sizing: border-box;
			font-size: 18px;
		}

		input[type=radio] {
			height: 20px;
			width: 20px;
		}

		select {
			background: transparent;
			border: none;
			font-size: 18px;
			height: 30px;
			padding: 5px;
			width: 250px;
		}

		.oculto {
			display: none;
		}

		.visible {
			display: inline;
		}

		.cuerpo {
			margin: 0 auto;
		}
	</style>

</head>

<body>
	<table id="tblcuerpo" cellspacing="0" border="0" style="margin: 0 auto; margin-top: 10px; width: 95%;">
		<colgroup span="4" width="27"></colgroup>
		<colgroup width="55"></colgroup>
		<colgroup width="27"></colgroup>
		<colgroup width="32"></colgroup>
		<colgroup span="26" width="27"></colgroup>
		<tr>
			<td style="border-top: 2px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=7 rowspan=3 height="100" align="center"><b>
					<font face="Arial Narrow" color="#000000"><br><img
							src="img\logo_m.png" width=182 hspace=7
							vspace=21>
					</font>
				</b></td>
			<td style="border-top: 2px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=20 rowspan=3 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3 color="#000000">REGISTRO DE CONTROL DE ACTIVIDADES MANTENIMIENTO DE
						SISTEMA DE PUESTA A TIERRA</font>
				</b></td>
			<td style="border-top: 2px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=6 align="center"><b>
					<font face="Arial Narrow" size=3 color="#000000">FRM-BCA-19.370.3.OS118</font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=6 align="center"><b>
					<font face="Arial Narrow" size=3 color="#000000">Fecha: 28/02/2020</font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=6 align="center"><b>
					<font face="Arial Narrow" size=3 color="#000000">Versión: 0</font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=33 height="39" align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>Contrato: 3023605 Mantenimiento con parada de planta y en operación de las
						unidades de la refinería de Barrancabermeja.</font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=4 height="40" align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>No. ORDEN DE SERVICIO</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=7 align="center" valign=middle>
				<font face="Arial Narrow" size="5"><span id="ods">027</span></font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=4 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>PLANTA</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=18 align="center" valign=middle>
				<font face="Arial Narrow" size="5"><span id="planta">U-650</span></font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=4 height="34" align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>SISTEMA</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=15 align="center" valign=middle><b>
					<input type="text" id="sistema" onchange="actInfo()">
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=4 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>PLANO</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=10 align="center" valign=middle><b>
					<input type="text" id="plano" onchange="actInfo()">
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000"
				colspan=3 height="34" align="left" valign=middle bgcolor="#FFFFFF"><b>
					<font face="Arial Narrow" size="3">FECHA:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000" colspan=13 align="center"
				valign=middle bgcolor="#FFFFFF"><b>
					<input type="date" id="fecha" onchange="actInfo()">
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-right: 2px solid #000000"
				colspan=17 align="center" valign=middle><b>
					<font face="Arial Narrow"><br></font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000"
				colspan=3 height="27" align="left" valign=middle bgcolor="#FFFFFF"><b>
					<font face="Arial Narrow" size="3">EQUIPO:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<input type="text" id="equipo" onchange="actInfo()">
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000"
				colspan=2 align="left" valign=middle bgcolor="#FFFFFF"><b>
					<font face="Arial Narrow" size="3">SERIE:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-right: 2px solid #000000"
				colspan=15 align="center" valign=middle><b>
					<input type="text" id="serie" onchange="actInfo()">
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000"
				colspan=3 height="27" align="left" valign=middle bgcolor="#FFFFFF"><b>
					<font face="Arial Narrow" size="3">MARCA:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<input type="text" id="marca" onchange="actInfo()">
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000"
				colspan=5 align="left" valign=middle bgcolor="#FFFFFF"><b>
					<font face="Arial Narrow" size="3">FECHA CALIBRACIÓN:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-right: 2px solid #000000"
				colspan=12 align="center" valign=middle><b>
					<input type="date" id="fechacal" onchange="actInfo()">
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000"
				colspan=3 height="27" align="left" valign=middle bgcolor="#FFFFFF"><b>
					<font face="Arial Narrow" size="3">RANGO:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<input type="text" id="rango" onchange="actInfo()">
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000"
				colspan=6 align="left" valign=middle bgcolor="#FFFFFF"><b>
					<font face="Arial Narrow" size="3">PROXIMA CALIBRACIÓN:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-right: 2px solid #000000"
				colspan=11 align="center" valign=middle><b>
					<input type="text" id="proximacal" onchange="actInfo()">
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000"
				colspan=5 height="27" align="left" valign=middle bgcolor="#FFFFFF"><b>
					<font face="Arial Narrow" size="3">METODO DE MEDICIÓN:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-right: 1px solid #000000"
				colspan=11 align="center" valign=middle><b>
					<input type="text" id="metodomed" onchange="actInfo()">
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000"
				colspan=8 align="left" valign=middle bgcolor="#FFFFFF"><b>
					<font face="Arial Narrow" size="3">DISTANCIA ENTRE ELECTRODOS:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-right: 2px solid #000000"
				colspan=9 align="center" valign=middle><b>
					<input type="text" id="distancia" onchange="actInfo()">
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=33 rowspan=2 height="31" align="center" valign=middle bgcolor="#969696"><b>
					<font face="Arial Narrow" size="3">MEDIDA DE RESISTENCIA PUESTA MALLA A TIERRA</font>
				</b></td>
		</tr>
		<tr>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="44" align="center" valign=middle bgcolor="#C0C0C0"><b>
					<font face="Arial Narrow" size="3" color="#000000">No.</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle bgcolor="#C0C0C0"><b>
					<font face="Arial Narrow" size="3" color="#000000">PUNTO INDIVIDUAL</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle bgcolor="#C0C0C0"><b>
					<font face="Arial Narrow" size="3" color="#000000">RESISTENCIA PUESTA A TIERRA (OHMS)</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle bgcolor="#C0C0C0"><b>
					<font face="Arial Narrow" size="3" color="#000000">UBICACIÓN</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle bgcolor="#C0C0C0"><b>
					<font face="Arial Narrow" size="3" color="#000000">FECHA</font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="23" align="center" valign=middle><b>
					<font face="Arial Narrow" size="3"><span >1</span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="punto1" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="text" id="resistencia1" onchange="actMedidas()">
				</font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="ubicacion1" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="date" id="fecham1" onchange="actMedidas()">
				</font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="23" align="center" valign=middle><b>
					<font face="Arial Narrow" size="3"><span >2</span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="punto2" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="text" id="resistencia2" onchange="actMedidas()">
				</font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="ubicacion2" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="date" id="fecham2" onchange="actMedidas()">
				</font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="23" align="center" valign=middle><b>
					<font face="Arial Narrow" size="3"><span >3</span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="punto3" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="text" id="resistencia3" onchange="actMedidas()">
				</font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="ubicacion3" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="date" id="fecham3" onchange="actMedidas()">
				</font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="23" align="center" valign=middle><b>
					<font face="Arial Narrow" size="3"><span >4</span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="punto4" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="text" id="resistencia4" onchange="actMedidas()">
				</font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="ubicacion4" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="date" id="fecham4" onchange="actMedidas()">
				</font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="23" align="center" valign=middle><b>
					<font face="Arial Narrow" size="3"><span >5</span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="punto5" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="text" id="resistencia5" onchange="actMedidas()">
				</font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="ubicacion5" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="date" id="fecham5" onchange="actMedidas()">
				</font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="23" align="center" valign=middle><b>
					<font face="Arial Narrow" size="3"><span >6</span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="punto6" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="text" id="resistencia6" onchange="actMedidas()">
				</font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="ubicacion6" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="date" id="fecham6" onchange="actMedidas()">
				</font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="23" align="center" valign=middle><b>
					<font face="Arial Narrow" size="3"><span >7</span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="punto7" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="text" id="resistencia7" onchange="actMedidas()">
				</font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="ubicacion7" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="date" id="fecham7" onchange="actMedidas()">
				</font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="23" align="center" valign=middle><b>
					<font face="Arial Narrow" size="3"><span >8</span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="punto8" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="text" id="resistencia8" onchange="actMedidas()">
				</font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="ubicacion8" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="date" id="fecham8" onchange="actMedidas()">
				</font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="23" align="center" valign=middle><b>
					<font face="Arial Narrow" size="3"><span >9</span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="punto9" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="text" id="resistencia9" onchange="actMedidas()">
				</font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="ubicacion9" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="date" id="fecham9" onchange="actMedidas()">
				</font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="23" align="center" valign=middle><b>
					<font face="Arial Narrow" size="3"><span >10</span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="punto1" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="text" id="resistencia10" onchange="actMedidas()">
				</font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="ubicacion10" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="date" id="fecham10" onchange="actMedidas()">
				</font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="23" align="center" valign=middle><b>
					<font face="Arial Narrow" size="3"><span >11</span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="punto11" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="text" id="resistencia11" onchange="actMedidas()">
				</font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="ubicacion11" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="date" id="fecham1" onchange="actMedidas()">
				</font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="23" align="center" valign=middle><b>
					<font face="Arial Narrow" size="3"><span >12</span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="punto12" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="text" id="resistencia12" onchange="actMedidas()">
				</font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="ubicacion12" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="date" id="fecham12" onchange="actMedidas()">
				</font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="23" align="center" valign=middle><b>
					<font face="Arial Narrow" size="3"><span >13</span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="punto13" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="text" id="resistencia13" onchange="actMedidas()">
				</font>
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<font face="Arial Narrow">
						<input type="text" id="ubicacion13" onchange="actMedidas()">
					</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle>
				<font face="Arial Narrow">
					<input type="date" id="fecham13" onchange="actMedidas()">
				</font>
			</td>
		</tr>


		<tr>
			<td style="border-top: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=33 height="27" align="center" valign=middle bgcolor="#969696"><b>
					<font face="Arial Narrow" size="3">REGISTRO FOTOGRAFICO DEL TRABAJO</font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=16 height="27" align="center" valign=middle bgcolor="#C0C0C0"><b>
					<font face="Arial Narrow" size="3" color="#000000">1. FOTO INICIAL</font>
				</b><button type="button" class="btn btn-info btn-sm oculto-impresion" id="btnagregarFotoini"
				onclick="fotoInicial()">Agregar</button></td>

			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=17 align="center" valign=middle bgcolor="#C0C0C0"><b>
					<font face="Arial Narrow" size="3" color="#000000">2. FOTO FINAL</font>
				</b><button type="button" class="btn btn-info btn-sm oculto-impresion" id="btnagregarFotofin"
			onclick="fotoFinal()">Agregar</button></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=16 rowspan=8 height="185" align="center" valign=middle><b>
					<span id="galeriainicial">
				 
					</span>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=17 rowspan=8 align="center" valign=middle><b>
					<span id="galeriafinal">
				 
					</span>
				</b></td>
		</tr>
		<tr>
		</tr>
		<tr>
		</tr>
		<tr>
		</tr>
		<tr>
		</tr>
		<tr>
		</tr>
		<tr>
		</tr>
		<tr>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=33 height="21" align="left" bgcolor="#969696" sdnum="1033;0;0%"><b>
					<font face="Arial Narrow" size="3">OBSERVACIONES:</font>
				</b><button type="button" class="btn btn-info btn-sm oculto-impresion" id="btnagregarObs"
				onclick="agregarObs()">Agregar Observación</button>
			
			</td>
		</tr>

		<tr>

			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=33 align="left" valign=middle>
				<table id="tblobs" style="width: 100%;" class="oculto">
					<tr>
						<td colspan="4">
							<textarea id="obs100" style="width: 100%;" rows="3" class="activo"
								placeholder="Observaciones..."></textarea>
						</td>
					</tr>
					<tr>

						<td>
							<input type="text" id="nombre100" placeholder="Nombre" class="activo">
						</td>

						<td style="width: 200px;">
							<input type="text" id="registro100" placeholder="CC/REGISTRO" class="activo">
						</td>
						<td>
							<button type="button" class="btn btn-info btn-block" id="btnFirmar21"
								onclick="abrirFirma('100')">Firmar</button>
							<img src="" id="firma100" width="130px" height="50px" class="oculto">
						</td>
						<td>

						</td>
					</tr>
				</table>
			</td>

		</tr>
		<tr>

			<td style="border-top: 1px solid #000000; border-bottom: 2px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=33 height="42" align="left" valign=middle bgcolor="#FFFFFF" id="observaciones"><b>
					<font face="Arial Narrow"><br></font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=33 height="21" align="center" valign=top sdnum="1033;0;0%"><b>
					<font face="Arial Narrow"><br></font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=16 height="21" align="center" valign=middle bgcolor="#969696"><b>
					<font face="Arial Narrow" size="3">SUPERVISOR UT.ITALCO</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=17 align="center" valign=middle bgcolor="#969696"><b>
					<font face="Arial Narrow" size="3">SUPERVISOR ECOPETROL</font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=4 height="27" align="left" valign=middle><b>
					<font face="Arial Narrow" size="3">NOMBRE:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=12 align="center" valign=middle><b>
					<input type="text" id="nombre1" class="ut">
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=4 align="left" valign=middle><b>
					<font face="Arial Narrow" size="3">NOMBRE:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<input type="text" id="nombre2" class="ecp">
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=4 height="27" align="left" valign=middle><b>
					<font face="Arial Narrow" size="3">FIRMA:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=12 align="center" valign=middle><b>
					<button type="button" class="btn btn-info btn-block ut oculto-impresion" id="btnFirmar1"
					onclick="abrirFirma('1')">Firmar</button>
				<img src="" id="firma1" width="130px" height="50px" class="oculto">
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=4 align="left" valign=middle><b>
					<font face="Arial Narrow" size="3">FIRMA:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<button type="button" class="btn btn-info btn-block ecp oculto-impresion" id="btnFirmar2"
					onclick="abrirFirma('2')">Firmar</button>
					<img src="" id="firma2" width="130px" height="50px" class="oculto"
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=4 height="27" align="left" valign=middle><b>
					<font face="Arial Narrow" size="3">REGISTRO:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=12 align="center" valign=middle><b>
					<input type="text" id="registro1" class="ut">
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=4 align="left" valign=middle><b>
					<font face="Arial Narrow" size="3">REGISTRO:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<input type="text" id="registro2" class="ecp">
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 2px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=4 height="27" align="left" valign=middle><b>
					<font face="Arial Narrow" size="3">FECHA:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 2px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=12 align="center" valign=middle><b>
					<input type="date" id="fecha1" class="ut">
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 2px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=4 align="left" valign=middle><b>
					<font face="Arial Narrow" size="3">FECHA:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 2px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=13 align="center" valign=middle><b>
					<input type="date" id="fecha2" class="ecp">
				</b></td>
		</tr>
	</table>
	<!-- ************************************************************************** -->
	<!-- Modal -->
	<div class="modal" id="modalFirma" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content" style="width: 600px;">
				<div class="modal-header">
					<h5 class="modal-title" id="exampleModalLabel">Firmar Documento</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<center><canvas id="canvas" style="border: 1px solid black;" width="560" height="320"></canvas>
						<br><input type="checkbox" id="poldatos" checked>
						Acepto las <a href="javascript::void(0)" onclick="mostraraviso()">políticas de protección de
							datos personales</a>
					</center>

				</div>
				<div class="modal-footer">

					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
					<button type="button" class="btn btn-danger" id="btnLimpiar">Limpiar</button>
					<button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="pasarFirma()">Pasar a
						documento</button>

				</div>
			</div>
		</div>
	 
	<!-- ************************************************************************** -->

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2" crossorigin="anonymous"></script> -->

	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
		integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous">
	</script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
		integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous">
	</script>


	<script>
		function agregarObs() {
			$('#tblobs').removeClass("oculto")
			$('#btnagregarObs').addClass("oculto")
		}

		var imagencargada = null
		var idImagen = null
		var arrayDatosPrueba = []
		var html = ''

		var user = sessionStorage.getItem('usercal')
		var tipouser = sessionStorage.getItem('tipouser')

		if (tipouser == 'ecopetrol') {
			$("input, select,  textarea").prop('disabled', true);
			$('.ecp').prop('disabled', false)
			$('.ut').prop('disabled', true)
			//$("#info input").prop("disabled", true);
		}

		if (tipouser == 'italco') {
			// $("input, select,  textarea").prop('disabled', false);
			$('.ecp').prop('disabled', true)
			// $('.ut').prop('disabled', true)
			//$("#info input").prop("disabled", true);
		}

		$('.activo').prop('disabled', false)

		var items = []
		// Set up the canvas
		var canvas = document.querySelector("#canvas");
		var ctx = canvas.getContext("2d");
		ctx.strokeStyle = "#222222";
		ctx.lineWidth = 2;


		$btnDescargar = document.querySelector("#btnDescargar")
		$btnLimpiar = document.querySelector("#btnLimpiar")
		$btnGenerarDocumento = document.querySelector("#btnGenerarDocumento");



		// Get a regular interval for drawing to the screen
		window.requestAnimFrame = (function (callback) {
			return window.requestAnimationFrame ||
				window.webkitRequestAnimationFrame ||
				window.mozRequestAnimationFrame ||
				window.oRequestAnimationFrame ||
				window.msRequestAnimaitonFrame ||
				function (callback) {
					window.setTimeout(callback, 1000 / 60);
				};
		})();


		const limpiarCanvas = () => {
			// Colocar color blanco en fondo de canvas
			clearCanvas();
		};
		limpiarCanvas();
		$btnLimpiar.onclick = limpiarCanvas;
		// Escuchar clic del botón para descargar el canvas



		window.obtenerImagen = () => {
			return $canvas.toDataURL();
		};


		// Set up mouse events for drawing
		var drawing = false;
		var mousePos = {
			x: 0,
			y: 0
		};
		var lastPos = mousePos;
		canvas.addEventListener("mousedown", function (e) {
			drawing = true;
			lastPos = getMousePos(canvas, e);
		}, false);
		canvas.addEventListener("mouseup", function (e) {
			drawing = false;
		}, false);
		canvas.addEventListener("mousemove", function (e) {
			mousePos = getMousePos(canvas, e);
		}, false);

		// Set up touch events for mobile, etc
		canvas.addEventListener("touchstart", function (e) {
			mousePos = getTouchPos(canvas, e);
			var touch = e.touches[0];
			var mouseEvent = new MouseEvent("mousedown", {
				clientX: touch.clientX,
				clientY: touch.clientY
			});
			canvas.dispatchEvent(mouseEvent);
		}, false);
		canvas.addEventListener("touchend", function (e) {
			var mouseEvent = new MouseEvent("mouseup", {});
			canvas.dispatchEvent(mouseEvent);
		}, false);
		canvas.addEventListener("touchmove", function (e) {
			var touch = e.touches[0];
			var mouseEvent = new MouseEvent("mousemove", {
				clientX: touch.clientX,
				clientY: touch.clientY
			});
			canvas.dispatchEvent(mouseEvent);
		}, false);


		// Prevent scrolling when touching the canvas
		document.body.addEventListener("touchstart", function (e) {
			if (e.target == canvas) {
				e.preventDefault();
			}
		}, {
			passive: false
		});
		document.body.addEventListener("touchend", function (e) {
			if (e.target == canvas) {
				e.preventDefault();
			}
		}, false);
		document.body.addEventListener("touchmove", function (e) {
			if (e.target == canvas) {
				e.preventDefault();
			}
		}, false);

		// Get the position of the mouse relative to the canvas
		function getMousePos(canvasDom, mouseEvent) {
			var rect = canvasDom.getBoundingClientRect();
			return {
				x: mouseEvent.clientX - rect.left,
				y: mouseEvent.clientY - rect.top
			};
		}

		// Get the position of a touch relative to the canvas
		function getTouchPos(canvasDom, touchEvent) {
			var rect = canvasDom.getBoundingClientRect();
			return {
				x: touchEvent.touches[0].clientX - rect.left,
				y: touchEvent.touches[0].clientY - rect.top
			};
		}

		// Draw to the canvas
		function renderCanvas() {
			if (drawing) {
				ctx.moveTo(lastPos.x, lastPos.y);
				ctx.lineTo(mousePos.x, mousePos.y);
				ctx.stroke();
				lastPos = mousePos;
			}
		}

		// Clear the canvas
		function clearCanvas() {
			canvas.width = canvas.width;
		}

		// Allow for animation
		(function drawLoop() {
			requestAnimFrame(drawLoop);
			renderCanvas();
		})();


		function abrirFirma(id) {

			if (id == 100) {
				if ($('#obs100').val() == '' || $('#nombre100').val == "" || $('#registro100').val() == "") {
					Swal.fire({
						position: 'top-end',
						icon: 'info',
						title: 'Por favor registre primero la observación, nombre y registro...',
						showConfirmButton: false,
						timer: 2500
					})
				} else {
					idImagen = id;
					limpiarCanvas()
					var myModal = new bootstrap.Modal(document.getElementById('modalFirma'))
					myModal.show()
				}
			} else {

				if ($('#fecha' + id).val() == "" || $('#hora' + id).val() == "") {
					Swal.fire({
						position: 'top-end',
						icon: 'info',
						title: 'Por favor registre primero fecha y hora...',
						showConfirmButton: false,
						timer: 2500
					})
				} else {
					if ($('#nombre' + id).val() == "" || $('#registro' + id).val() == "") {
						Swal.fire({
							position: 'top-end',
							icon: 'info',
							title: 'Por favor registre primero nombre y registro...',
							showConfirmButton: false,
							timer: 2500
						})
					} else {



						idImagen = id;
						limpiarCanvas()
						var myModal = new bootstrap.Modal(document.getElementById('modalFirma'))
						myModal.show()



					}
				}

			}


		}

		function pasarFirma() {
			if ($('#poldatos').prop('checked')) {
				imagencargada = canvas.toDataURL("image/png");
				//document.querySelector("#firma").src = window.opener.obtenerImagen();
				document.querySelector("#firma" + idImagen).src = canvas.toDataURL("image/png");

				$('#firma' + idImagen).removeClass('oculto')
				$('#btnFirmar' + idImagen).hide()


				if (idImagen == 1 || idImagen == 2 ) {
					firmas()
				}

				 


				if (idImagen == 100) {
					guardarObs()
				}


			} else {
				Swal.fire({
					position: 'top-end',
					icon: 'info',
					title: 'Debe aceptar las políticas de protección de datos perasonales',
					showConfirmButton: false,
					timer: 1500
				})
			}


			//document.querySelector("#btnfirmar").style.display = 'none';

		}

		function getParameterByName(name) {
			name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
			var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
				results = regex.exec(location.search);
			return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
		}

		var tag = getParameterByName('tag');
		var arrayDatos = []
		var firmasItems = []
		var arrayInfo = []

		odsq = localStorage.getItem('odsq');
		equipos = sessionStorage.getItem('equipo')
		alcance = sessionStorage.getItem('servicio')
		esp = sessionStorage.getItem('esp')


		var server = 'https://utitalco.com/calidad/027/server/';

		$.post(server + 'cargarRca118.php', {
				ods: odsq,
				tag: tag
			},
			function (resp) {
				arrayDatos = resp
				cargarDatos()
			})

		function cargarDatos() {
			$('#unidad').html(arrayDatos.unidad)
			$('#planta').html(arrayDatos.planta)
			$('#ods').html(arrayDatos.ods)
			$('#tag').html(arrayDatos.tag)

			if(arrayDatos.fotoInicial != ""){
				listaFotosInicial = JSON.parse(arrayDatos.fotoinicial)
				cargarGaleriaInicial()
			}

			if(arrayDatos.fotofinal != ""){
				listaFotosFinal = JSON.parse(arrayDatos.fotofinal)
				cargarGaleriaFinal()
			}
			

			if(arrayDatos.info != ""){
                arrayItems = JSON.parse(arrayDatos.info)
                $('#sistema').val(arrayItems[0].sistema)
				$('#plano').val(arrayItems[0].plano)
				$('#fecha').val(arrayItems[0].fecha)
				$('#equipo').val(arrayItems[0].equipo)
				$('#serie').val(arrayItems[0].serie)
				$('#marca').val(arrayItems[0].marca)
				$('#fechacal').val(arrayItems[0].fechacal)
				$('#rango').val(arrayItems[0].rango)
				$('#proximacal').val(arrayItems[0].proximacal)
				$('#metodomed').val(arrayItems[0].metodomed)
				$('#distancia').val(arrayItems[0].distancia)
            }

			if(arrayDatos.medidas != ""){
                arrayItems = JSON.parse(arrayDatos.medidas)
                for(var i=0; i<= 12; i++){
                    b=i+1;
                     $('#punto'+b).val(arrayItems[i].punto)
					 $('#resistencia'+b).val(arrayItems[i].resistencia)
					 $('#ubicacion'+b).val(arrayItems[i].ubicacion)
					 $('#fecham'+b).val(arrayItems[i].fecham)
                }
            }

		

			if (arrayDatos.firmas != "") {
				var arrayFirmasItems = JSON.parse(arrayDatos.firmas)

				//ecp

				$('#fecha2').val(arrayFirmasItems[0].fechaec)
				$('#hora2').val(arrayFirmasItems[0].horaec)
				$('#nombre2').val(arrayFirmasItems[0].nombreec)

				if (arrayFirmasItems[0].fechaec != "") {
					document.querySelector("#firma2").src = arrayFirmasItems[0].firmaec;
					$('#firma2').removeClass('oculto')
					$('#btnFirmar2').hide()
				}

				$('#registro2').val(arrayFirmasItems[0].registroec)

				//ut

				$('#fecha1').val(arrayFirmasItems[0].fechaut)
				$('#hora1').val(arrayFirmasItems[0].horaut)
				$('#nombre1').val(arrayFirmasItems[0].nombreut)

				if (arrayFirmasItems[0].fechaut != "") {
					document.querySelector("#firma1").src = arrayFirmasItems[0].firmaut;
					$('#firma1').removeClass('oculto')
					$('#btnFirmar1').hide()
				}

				$('#registro1').val(arrayFirmasItems[0].registrout)


			}


			//CARGUE DE OBSERVACIONES

			if (arrayDatos.observaciones != "") {
				var arrayObs = JSON.parse(arrayDatos.observaciones)
				var html = ''
				for (var i = 0; i < arrayObs.length; i++) {
					html = `<b>Nota ${i+1}: </b>
				${arrayObs[i].obs} | ${arrayObs[i].nombre} | Registro: ${arrayObs[i].registro} | Fecha: ${arrayObs[i].fecha} | Firma: <span id="firm${i}" style="width: 60px;"></span> <br>--------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>
				`
					$('#observaciones').append(html)
					const imagef = document.createElement('img')
					imagef.src = arrayObs[i].firma
					imagef.height = "60"
					document.querySelector('#firm' + i).appendChild(imagef)

				}
			}
			if (arrayDatos.doc != "") {
				listaArchivos = JSON.parse(arrayDatos.doc)

			}


			Swal.close()


		}


		//actualiza informacion
		function actInfo(){

			 var sistema = $('#sistema').val()
			 var plano = $('#plano').val()
			 var fecha = $('#fecha').val()
			 var equipo = $('#equipo').val()
			 var serie = $('#serie').val()
			 var marca = $('#marca').val()
			 var fechacal = $('#fechacal').val()
			 var rango = $('#rango').val()
			 var proximacal= $('#proximacal').val()
			 var metodomed= $('#metodomed').val()
			 var distancia= $('#distancia').val()

			 var arrayItems = []

			 arrayItems.push({
				'sistema':sistema,
				'plano':plano,
				'fecha':fecha,
				'equipo':equipo,
				'serie':serie,
				'marca':marca,
				'fechacal':fechacal,
				'rango':rango,
				'proximacal':proximacal,
				'metodomed':metodomed,
				'distancia':distancia
			 })

                $.post(server + 'act118Info.php', {
                    ods: odsq,
                    tag: tag,
                    datos: JSON.stringify(arrayItems)
                },
                function (res) {
                        Swal.fire({
                            position: 'top-end',
                            icon: 'success',
                            width: 100,
                            showConfirmButton: false,
                            timer: 1500
                        })
                })
        }
		

		 function actMedidas(){

            var arrayItems = []

                for(var i=1; i<=13; i++){
                    var punto = $('#punto'+i).val()
					var resistencia = $('#resistencia'+i).val()
					var ubicacion = $('#ubicacion'+i).val()
					var fecham = $('#fecham'+i).val()

                    arrayItems.push({
                        'punto':punto,
						'resistencia':resistencia,
						'ubicacion':ubicacion,
						'fecham':fecham
                    });

					console.log(arrayItems)

                }

                $.post(server + 'act118Items.php', {
                    ods: odsq,
                    tag: tag,
                    datos: JSON.stringify(arrayItems)
                },
                function (res) {
                        Swal.fire({
                            position: 'top-end',
                            icon: 'success',
                            width: 100,
                            showConfirmButton: false,
                            timer: 1500
                        })
                })
        }
		
		function firmas() {

			var fechaec = $('#fecha2').val()
			var horaec = $('#hora2').val()
			var nombreec = $('#nombre2').val()

			var img = document.getElementById("firma2");
			var firmaec = img.src

			if (fechaec == '') {
				firmaec = ''
			}

			var registroec = $('#registro3').val()

			
			var fechaut = $('#fecha1').val()
			var horaut = $('#hora1').val()
			var nombreut = $('#nombre1').val()

			var img = document.getElementById("firma1");
			var firmaut = img.src

			if (fechaut == '') {
				firmaut = ''
			}

			var registrout = $('#registro1').val()

			var arrayFirmasItems = []

			arrayFirmasItems.push({
				'fechaec': fechaec,
				'horaec': horaec,
				'nombreec': nombreec,
				'firmaec': firmaec,
				'registroec': registroec,
				'fechaut': fechaut,
				'horaut': horaut,
				'nombreut': nombreut,
				'firmaut': firmaut,
				'registrout': registrout,
			})

			$.post(server + 'act118Firmas.php', {
					ods: odsq,
					tag: tag,
					datos: JSON.stringify(arrayFirmasItems)
				},
				function (res) {
					Swal.fire({
						position: 'top-end',
						icon: 'success',
						width: 100,
						showConfirmButton: false,
						timer: 1500
					})
				})

		}

	 
		function mostraraviso() {
			let timerInterval
			Swal.fire({
				title: 'Políticas de protección de datos personales',
				text: 'En cumplimiento con la Ley 1581 de protección de datos personales, se le informa que los datos suministrados serán incorporados a una base de datos cuya finalidad es el registro de control de actividades RCA y las actuaciones que se deriven de dicha gestión, cuyo responsable del tratamiento es UT ITALCO. Mediante el registro de sus datos  a través de este formato usted autoriza a UT ITALCO, a tratar los datos con la finalidad descrita arriba.  Como Titular se le informa que podrá ejercer sus derechos de acceso y reclamos a través del correo de contacto pqrsbca@utitalco.com.',
				timer: 20000,
				timerProgressBar: true,
				didOpen: () => {
					Swal.showLoading()
					const b = Swal.getHtmlContainer().querySelector('b')
					timerInterval = setInterval(() => {
						b.textContent = Swal.getTimerLeft()
					}, 100)
				},
				willClose: () => {
					clearInterval(timerInterval)
				}
			}).then((result) => {
				/* Read more about handling dismissals below */
				if (result.dismiss === Swal.DismissReason.timer) {
					console.log('I was closed by the timer')
				}
			})
		}

		function cargando() {
			let timerInterval
			Swal.fire({
				title: 'Cargando formato...!',
				timer: 20000,
				timerProgressBar: true,
				didOpen: () => {
					Swal.showLoading()
					const b = Swal.getHtmlContainer().querySelector('b')
					timerInterval = setInterval(() => {
						// b.textContent = Swal.getTimerLeft()
					}, 100)
				},
				willClose: () => {
					clearInterval(timerInterval)
				}
			}).then((result) => {
				/* Read more about handling dismissals below */
				if (result.dismiss === Swal.DismissReason.timer) {
					console.log('I was closed by the timer')
				}
			})
		}

		function verArchivos() {
			var htmltexto = ''
			for (var i = 0; i < listaArchivos.length; i++) {
				htmltexto += `
				<a href='https://utitalco.com/calidad/027/server/archivos/${listaArchivos[i].archivo}' target='_blank'>${listaArchivos[i].archivo}</a> <br>
			`
			}

			Swal.fire({
				title: '<strong>Lista de adjuntos</strong>',
				icon: 'info',
				html: `
			Pulse click sobre el archivo que desea descargar... <br>
			${htmltexto}
			`

			})
		}

		function adjuntar() {
			Swal.fire({
				title: 'Adjuntar archivo',
				html: `
			<input type="file" id="archivo" class="form-control" placeholder="Buscar...">
			`,
				showCancelButton: true,
				confirmButtonText: 'Adjuntar'
			}).then((result) => {
				/* Read more about isConfirmed, isDenied below */
				if (result.isConfirmed) {

					var formData = new FormData();
					var files = $('#archivo')[0].files[0];
					formData.append('archivo', files);
					formData.append('ods', odsq);
					formData.append('tag', tag);
					$.ajax({
						url: server + 'guardarArchivo124.php',
						type: 'post',
						data: formData,
						contentType: false,
						processData: false,
						success: function (response) {
							console.log(response)

							if (response.msn == "Ok") {
								Swal.fire({
									position: 'top-end',
									icon: 'success',
									title: 'Archivo cargado correctamente...',
									showConfirmButton: false,
									timer: 1500
								}).then(() => {

									location.reload();
								})
							} else {
								Swal.fire({
									icon: 'error',
									title: 'Oops...',
									text: 'Formato de archivo incorrecto...!',
								})
							}
						}
					});

				}
			})
		}

		function fotoInicial() {
			Swal.fire({
				title: 'Adjuntar Foto Inicial',
				html: `
			<input type="file" id="fotoinicial" class="form-control" placeholder="Buscar...">
			`,
				showCancelButton: true,
				confirmButtonText: 'Adjuntar'
			}).then((result) => {
				/* Read more about isConfirmed, isDenied below */
				if (result.isConfirmed) {

					var formData = new FormData();
					var files = $('#fotoinicial')[0].files[0];
					formData.append('archivo', files);
					formData.append('ods', odsq);
					formData.append('tag', tag);
					$.ajax({
						url: server + 'guardarFotoInicial118.php',
						type: 'post',
						data: formData,
						contentType: false,
						processData: false,
						success: function (response) {
							console.log(response)

							if (response.msn == "Ok") {
								Swal.fire({
									position: 'top-end',
									icon: 'success',
									title: 'Foto cargada correctamente...',
									showConfirmButton: false,
									timer: 1500
								}).then(() => {

									location.reload();
								})
							} else {
								Swal.fire({
									icon: 'error',
									title: 'Oops...',
									text: 'Formato de archivo incorrecto...!',
								})
							}
						}
					});

				}
			})
		}

		function fotoFinal() {
			Swal.fire({
				title: 'Adjuntar Foto Final',
				html: `
			<input type="file" id="fotofinal" class="form-control" placeholder="Buscar...">
			`,
				showCancelButton: true,
				confirmButtonText: 'Adjuntar'
			}).then((result) => {
				/* Read more about isConfirmed, isDenied below */
				if (result.isConfirmed) {

					var formData = new FormData();
					var files = $('#fotofinal')[0].files[0];
					formData.append('archivo', files);
					formData.append('ods', odsq);
					formData.append('tag', tag);
					$.ajax({
						url: server + 'guardarFotoFinal118.php',
						type: 'post',
						data: formData,
						contentType: false,
						processData: false,
						success: function (response) {
							console.log(response)

							if (response.msn == "Ok") {
								Swal.fire({
									position: 'top-end',
									icon: 'success',
									title: 'Foto cargada correctamente...',
									showConfirmButton: false,
									timer: 1500
								}).then(() => {

									location.reload();
								})
							} else {
								Swal.fire({
									icon: 'error',
									title: 'Oops...',
									text: 'Formato de archivo incorrecto...!',
								})
							}
						}
					});

				}
			})
		}

		function cargarGaleriaInicial(){
			var html = ''
			for(var i=0; i<listaFotosInicial.length; i++){
				html += `
				<a href="https://utitalco.com/calidad/027/server/archivos/${listaFotosInicial[i].archivo}" target="_blank" rel="noopener noreferrer">
						<img src="https://utitalco.com/calidad/027/server/archivos/${listaFotosInicial[i].archivo}" width="280px"  style="margin: 10px; border-radius: 10px;" >
					</a>
				`
					$('#galeriainicial').html(html)
			}

		

		}

		function cargarGaleriaFinal(){
			

			var html = ''
			for(var i=0; i<listaFotosFinal.length; i++){
				html += `
				<a href="https://utitalco.com/calidad/027/server/archivos/${listaFotosFinal[i].archivo}" target="_blank" rel="noopener noreferrer">
						<img src="https://utitalco.com/calidad/027/server/archivos/${listaFotosFinal[i].archivo}" width="280px"  style="margin: 10px; border-radius: 10px;" >
					</a>
				`
					$('#galeriafinal').html(html)
			}

		}

		function guardarObs() {
			var observacion = $('#obs100').val()
			var nombreobs = $('#nombre100').val()
			var registroobs = $('#registro100').val()
			var img = document.getElementById("firma100");

			// crea un nuevo objeto `Date`
			var today = new Date();

			// obtener la fecha y la hora
			var now = today.toLocaleString();
			var firmaobs = img.src

			if (arrayDatos.observaciones != "") {

				var arrayLmp = JSON.parse(arrayDatos.observaciones)
			} else {
				var arrayLmp = []
			}



			arrayLmp.push({
				"obs": observacion,
				"nombre": nombreobs,
				"registro": registroobs,
				"firma": firmaobs,
				"fecha": now
			})


			$.post(server + 'actOs118Obs.php', {
					ods: odsq,
					tag: tag,
					datos: JSON.stringify(arrayLmp)
				},
				function (res) {
					console.log(res)
					location.reload()
				})

		}
	</script>
</body>

</html>
<!DOCTYPE html>

<html>

<head>

	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title></title>
	<meta name="generator" content="LibreOffice 7.3.6.2 (Linux)" />
	<meta name="author" content="BP01AC0581" />
	<meta name="created" content="2021-06-30T19:32:49" />
	<meta name="changedby" content="01AC0479" />
	<meta name="changed" content="2022-10-20T19:03:19" />
	<meta name="AppVersion" content="16.0300" />

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

	<style type="text/css">
		body,
		div,
		table,
		thead,
		tbody,
		tfoot,
		tr,
		th,
		td,
		p {
			font-family: "Arial";
			font-size: x-small
		}

		a.comment-indicator:hover+comment {
			background: #ffd;
			position: absolute;
			display: block;
			border: 1px solid black;
			padding: 0.5em;
		}

		a.comment-indicator {
			background: red;
			display: inline-block;
			border: 1px solid black;
			width: 0.5em;
			height: 0.5em;
		}

		comment {
			display: none;
		}
	</style>
	<style>
		@media print {

			.oculto-impresion,
			.oculto-impresion * {
				display: none !important;
			}
		}

		.salto {
			PAGE-BREAK-AFTER: always;
		}

		.mispan {
			font-size: 16px;
		}

		textarea {
			font-size: 18px;
		}

		input[type=text] {
			width: 100%;
			padding: 12px;
			margin: 8px 0;
			border: 0;
			box-sizing: border-box;
			font-size: 18px;

		}

		.lineabaja {
			border-bottom-style: solid;
			border-bottom-width: 1px;
		}

		input[type=date] {
			width: 100%;
			padding: 12px;
			margin: 8px 0;
			border: 0;
			box-sizing: border-box;
			font-size: 18px;
		}

		input[type=time] {
			width: 100%;
			padding: 12px;
			margin: 8px 0;
			border: 0;
			box-sizing: border-box;
			font-size: 18px;
		}

		input[type=radio] {
			height: 20px;
			width: 20px;
		}

		select {
			background: transparent;
			border: none;
			font-size: 18px;
			height: 30px;
			padding: 5px;
			width: 250px;
		}

		.oculto {
			display: none;
		}

		.visible {
			display: inline;
		}

		.cuerpo {
			margin: 0 auto;
		}
	</style>


</head>

<body>
	<table id="tblcuerpo" cellspacing="0" border="0" style="margin: 0 auto; margin-top: 10px; width: 95%;">
		<colgroup width="138"></colgroup>
		<colgroup span="10" width="72"></colgroup>
		<colgroup width="109"></colgroup>
		<colgroup span="2" width="46"></colgroup>
		<colgroup width="62"></colgroup>
		<colgroup width="63"></colgroup>
		<tr>
			<td style="border-top: 2px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=3 rowspan=3 height="99" align="center" valign=bottom>
				<font face="Arial Narrow"><img src="img/logo_m.png" width=255 hspace=35 vspace=16>
				</font>
			</td>
			<td style="border-top: 2px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=9 rowspan=3 align="center" valign=middle><b>
					<font face="Arial Narrow" size=4>REGISTRO CONTROL DE ACTIVIDADES DE AISLAMIENTO Y CONTINUIDAD CABLES
						POTENCIA</font>
				</b></td>
			<td style="border-top: 2px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>FRM-BCA-19.370.3.OS175</font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3 color="#000000">Fecha: 30/06/2021</font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>Versión: 0</font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=16 height="33" align="center" valign=middle>
				<font face="Arial Narrow" size=3 color="#000000">Contrato: Mantenimiento con parada de Planta y en
					operación de las Unidades de la Refinería de Barrancabermeja</font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=16 height="33" align="center" valign=middle bgcolor="#D9D9D9"><b>
					<font face="Arial Narrow" size=3>1. INFORMACIÓN GENERAL</font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				height="33" align="center" valign=middle bgcolor="#D9D9D9"><b>
					<font face="Arial Narrow" size=3>UNIDAD</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=3 align="center" valign=middle bgcolor="#FFFFFF"><b>
					<font face="Arial Narrow" size=3><span id="unidad"></span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=2 align="center" valign=middle bgcolor="#D9D9D9"><b>
					<font face="Arial Narrow" size=3>PLANTA </font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=3 align="center" valign=middle bgcolor="#FFFFFF"><b>
					<font face="Arial Narrow" size=3><span id="planta"></span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=3 align="center" valign=middle bgcolor="#D9D9D9"><b>
					<font face="Arial Narrow" size=3>ORDEN DE SERVICIO:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=middle bgcolor="#FFFFFF" sdnum="1033;0;@"><b>
					<font face="Arial Narrow" size=3><span id="ods"></span></font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				height="33" align="center" valign=middle bgcolor="#D9D9D9"><b>
					<font face="Arial Narrow" size=3>EQUIPO</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=3 align="center" valign=middle bgcolor="#FFFFFF"><b>
					<font face="Arial Narrow" size=3><span id="equipo"></span></font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=2 align="center" valign=middle bgcolor="#D9D9D9"><b>
					<font face="Arial Narrow" size=3>SISTEMA</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=10 align="center" valign=middle bgcolor="#FFFFFF"><b>
					<font face="Arial Narrow" size=3><span id="sistema"></span></font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=16 height="40" align="center" valign=middle bgcolor="#D9D9D9"><b>
					<font face="Arial Narrow" size=3> INFORMACIÓN GENERAL EQUIPO</font>
			</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=16 height="40" align="center" valign=middle bgcolor="#D9D9D9"><b>
					<font face="Arial Narrow" size=3>EQUIPO DE PRUEBA:</font>
			</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="48" align="center" valign=middle><b>
					<font face="Arial Narrow" size=3 color="#000000">Marca:</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=2 align="center" valign=bottom>
				<input type="text" id="marcaEP" onchange="actInfo()">
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=3 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3 color="#000000">Modelo :</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=2 align="center" valign=bottom>
				<input type="text" id="modeloEP" onchange="actInfo()">
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=3 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3 color="#000000">Escala :</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=bottom>
				<input type="text" id="escalaEP" onchange="actInfo()">
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=2 height="48" align="center" valign=middle><b>
					<font face="Arial Narrow" size=3 color="#000000">Fecha de calibracion :</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=2 align="center" valign=bottom sdnum="1033;0;MMM-YY">
				<input type="date" id="fechacalib" onchange="actInfo()">
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=3 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3 color="#000000">Tension de prueba :</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=2 align="center" valign=bottom>
				<input type="text" id="tensionEP" onchange="actInfo()">
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=3 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3 color="#000000">Tiempo prueba :</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=4 align="center" valign=bottom>
				<input type="text" id="tiempoEP" onchange="actInfo()">
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=17 align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">AISLAMIENTO (GΩ)</font>
				</b><button type="button" class="btn btn-info btn-sm oculto-impresion" id="btnagregarDatosaislamiento"
				onclick="agregarDatosaislamiento()">Agregar</button></td>
		</tr>

	 
		<tr>
			<td id="datosPrueba" colspan="17">

			</td>
		</tr>


		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=16 height="48" align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">REGISTRO FOTOGRÁFICO </font>
				</b><button type="button" class="btn btn-info btn-sm oculto-impresion" id="btnagregarFotos"
				onclick="foto()">Agregar</button></td>
		</tr>

		<tr>
			<td style="border-top: 2px solid #000000; border-left: 2px solid #000000" colspan=16 height="22"
				align="center">
				<span id="galeria">
				 
				</span>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=16 height="33" align="center" valign=bottom>
				<font face="Arial Narrow" size=3 color="#000000"><br></font>
			</td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=16 height="35" align="left" valign=middle bgcolor="#D9D9D9"><b>
					<font face="Arial Narrow" size=3 color="#000000">OBSERVACIONES: </font>
				</b><button type="button" class="btn btn-info btn-sm oculto-impresion" id="btnagregarObs"
				onclick="agregarObs()">Agregar Observación</button>
			<button type="button" class="btn btn-info btn-sm m-1 oculto-impresion" onclick="adjuntar()">Adjuntar
				archivo</button>
			<button type="button" class="btn btn-warning btn-sm m-1 oculto-impresion" onclick="verArchivos()">Ver
				archivos</button></td>
		</tr>


		<tr>

			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=35 align="left" valign=middle>
				<table id="tblobs" style="width: 100%;" class="oculto">
					<tr>
						<td colspan="4">
							<textarea id="obs100" style="width: 100%;" rows="3" class="activo"
								placeholder="Observaciones..."></textarea>
						</td>
					</tr>
					<tr>

						<td>
							<input type="text" id="nombre100" placeholder="Nombre" class="activo">
						</td>

						<td style="width: 200px;">
							<input type="text" id="registro100" placeholder="CC/REGISTRO" class="activo">
						</td>
						<td>
							<button type="button" class="btn btn-info btn-block" id="btnFirmar21"
								onclick="abrirFirma('100')">Firmar</button>
							<img src="" id="firma100" width="130px" height="50px" class="oculto">
						</td>
						<td>

						</td>
					</tr>
				</table>
			</td>

		</tr>
		<tr>

			<td style="border-top: 1px solid #000000; border-bottom: 2px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=35 height="42" align="left" valign=middle bgcolor="#FFFFFF" id="observaciones"><b>
					<font face="Arial Narrow"><br></font>
				</b></td>
		</tr>






		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 2px solid #000000"
				colspan=16 height="37" align="center" valign=top><b>
					<font face="Arial Narrow" size=3 color="#000000"><br></font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				colspan=6 height="40" align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3>UT ITALCO </font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=10 align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3>ECOPETROL SA </font>
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				height="40" align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>NOMBRE</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle>
				<input type="text" id="nombre1" class="ut">
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=2 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>NOMBRE </font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=8 align="center" valign=middle><b>
					<input type="text" id="nombre2" class="ecp">
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				height="40" align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>CARGO</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle>
				<input type="text" id="cargo1" class="ut">
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=2 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>CARGO </font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=8 align="center" valign=middle><b>
					<input type="text" id="cargo2" class="ecp">
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				height="40" align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>FIRMA </font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle>
				<button type="button" class="btn btn-info btn-block ut oculto-impresion" id="btnFirmar1"
						onclick="abrirFirma('1')">Firmar</button>
					<img src="" id="firma1" width="130px" height="50px" class="oculto">
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=2 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>FIRMA</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=8 align="center" valign=middle><b>
					<button type="button" class="btn btn-info btn-block ecp oculto-impresion" id="btnFirmar2"
						onclick="abrirFirma('2')">Firmar</button>
					<img src="" id="firma2" width="130px" height="50px" class="oculto">
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 2px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				height="40" align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>FECHA</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 2px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=5 align="center" valign=middle>
				<input type="date" id="fecha1" class="ut">
			</td>
			<td style="border-top: 1px solid #000000; border-bottom: 2px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=2 align="center" valign=middle><b>
					<font face="Arial Narrow" size=3>FECHA</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 2px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=8 align="center" valign=middle><b>
					<input type="date" id="fecha2" class="ecp">
				</b></td>
		</tr>
		<tr>
			<td style="border-top: 2px solid #000000" colspan=16 height="22" align="center" valign=bottom>
				<font face="Arial Narrow" color="#000000">Documento emitido por el servicio de calidad de la compañía.
					El documento es propiedad de UT ITALCO. La empresa protegerá sus propios derechos en los tribunales
					civiles y penales de acuerdo con la ley.</font>
			</td>
		</tr>
		<tr>
			<td colspan=16 height="22" align="center" valign=bottom>
				<font face="Arial Narrow" color="#000000">**Fin del formato**</font>
			</td>
		</tr>
	</table>
	<!-- Modal -->
	<div class="modal" id="modalFirma" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content" style="width: 600px;">
				<div class="modal-header">
					<h5 class="modal-title" id="exampleModalLabel">Firmar Documento</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<center><canvas id="canvas" style="border: 1px solid black;" width="560" height="320"></canvas>
						<br><input type="checkbox" id="poldatos" checked>
						Acepto las <a href="javascript::void(0)" onclick="mostraraviso()">políticas de protección de
							datos personales</a>
					</center>

				</div>
				<div class="modal-footer">

					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
					<button type="button" class="btn btn-danger" id="btnLimpiar">Limpiar</button>
					<button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="pasarFirma()">Pasar a
						documento</button>

				</div>
			</div>
		</div>

	<!-- ************************************************************************** -->

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2" crossorigin="anonymous"></script> -->

	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
		integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous">
	</script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
		integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous">
	</script>


	<script>
		function agregarObs() {
			$('#tblobs').removeClass("oculto")
			$('#btnagregarObs').addClass("oculto")
		}

		var imagencargada = null
		var idImagen = null
		var arrayDatosPrueba = []
		var html = ''

		var user = sessionStorage.getItem('usercal')
		var tipouser = sessionStorage.getItem('tipouser')

		if (tipouser == 'ecopetrol') {
			$("input, select,  textarea").prop('disabled', true);
			$('.ecp').prop('disabled', false)
			$('.ut').prop('disabled', true)
			//$("#info input").prop("disabled", true);
		}

		if (tipouser == 'italco') {
			// $("input, select,  textarea").prop('disabled', false);
			$('.ecp').prop('disabled', true)
			// $('.ut').prop('disabled', true)
			//$("#info input").prop("disabled", true);
		}

		$('.activo').prop('disabled', false)

		var items = []
		// Set up the canvas
		var canvas = document.querySelector("#canvas");
		var ctx = canvas.getContext("2d");
		ctx.strokeStyle = "#222222";
		ctx.lineWidth = 2;


		$btnDescargar = document.querySelector("#btnDescargar")
		$btnLimpiar = document.querySelector("#btnLimpiar")
		$btnGenerarDocumento = document.querySelector("#btnGenerarDocumento");



		// Get a regular interval for drawing to the screen
		window.requestAnimFrame = (function (callback) {
			return window.requestAnimationFrame ||
				window.webkitRequestAnimationFrame ||
				window.mozRequestAnimationFrame ||
				window.oRequestAnimationFrame ||
				window.msRequestAnimaitonFrame ||
				function (callback) {
					window.setTimeout(callback, 1000 / 60);
				};
		})();


		const limpiarCanvas = () => {
			// Colocar color blanco en fondo de canvas
			clearCanvas();
		};
		limpiarCanvas();
		$btnLimpiar.onclick = limpiarCanvas;
		// Escuchar clic del botón para descargar el canvas



		window.obtenerImagen = () => {
			return $canvas.toDataURL();
		};


		// Set up mouse events for drawing
		var drawing = false;
		var mousePos = {
			x: 0,
			y: 0
		};
		var lastPos = mousePos;
		canvas.addEventListener("mousedown", function (e) {
			drawing = true;
			lastPos = getMousePos(canvas, e);
		}, false);
		canvas.addEventListener("mouseup", function (e) {
			drawing = false;
		}, false);
		canvas.addEventListener("mousemove", function (e) {
			mousePos = getMousePos(canvas, e);
		}, false);

		// Set up touch events for mobile, etc
		canvas.addEventListener("touchstart", function (e) {
			mousePos = getTouchPos(canvas, e);
			var touch = e.touches[0];
			var mouseEvent = new MouseEvent("mousedown", {
				clientX: touch.clientX,
				clientY: touch.clientY
			});
			canvas.dispatchEvent(mouseEvent);
		}, false);
		canvas.addEventListener("touchend", function (e) {
			var mouseEvent = new MouseEvent("mouseup", {});
			canvas.dispatchEvent(mouseEvent);
		}, false);
		canvas.addEventListener("touchmove", function (e) {
			var touch = e.touches[0];
			var mouseEvent = new MouseEvent("mousemove", {
				clientX: touch.clientX,
				clientY: touch.clientY
			});
			canvas.dispatchEvent(mouseEvent);
		}, false);


		// Prevent scrolling when touching the canvas
		document.body.addEventListener("touchstart", function (e) {
			if (e.target == canvas) {
				e.preventDefault();
			}
		}, {
			passive: false
		});
		document.body.addEventListener("touchend", function (e) {
			if (e.target == canvas) {
				e.preventDefault();
			}
		}, false);
		document.body.addEventListener("touchmove", function (e) {
			if (e.target == canvas) {
				e.preventDefault();
			}
		}, false);

		// Get the position of the mouse relative to the canvas
		function getMousePos(canvasDom, mouseEvent) {
			var rect = canvasDom.getBoundingClientRect();
			return {
				x: mouseEvent.clientX - rect.left,
				y: mouseEvent.clientY - rect.top
			};
		}

		// Get the position of a touch relative to the canvas
		function getTouchPos(canvasDom, touchEvent) {
			var rect = canvasDom.getBoundingClientRect();
			return {
				x: touchEvent.touches[0].clientX - rect.left,
				y: touchEvent.touches[0].clientY - rect.top
			};
		}

		// Draw to the canvas
		function renderCanvas() {
			if (drawing) {
				ctx.moveTo(lastPos.x, lastPos.y);
				ctx.lineTo(mousePos.x, mousePos.y);
				ctx.stroke();
				lastPos = mousePos;
			}
		}

		// Clear the canvas
		function clearCanvas() {
			canvas.width = canvas.width;
		}

		// Allow for animation
		(function drawLoop() {
			requestAnimFrame(drawLoop);
			renderCanvas();
		})();


		function abrirFirma(id) {

			if (id == 100) {
				if ($('#obs100').val() == '' || $('#nombre100').val == "" || $('#registro100').val() == "") {
					Swal.fire({
						position: 'top-end',
						icon: 'info',
						title: 'Por favor registre primero la observación, nombre y registro...',
						showConfirmButton: false,
						timer: 2500
					})
				} else {
					idImagen = id;
					limpiarCanvas()
					var myModal = new bootstrap.Modal(document.getElementById('modalFirma'))
					myModal.show()
				}
			} else {

				if ($('#fecha' + id).val() == "" || $('#hora' + id).val() == "") {
					Swal.fire({
						position: 'top-end',
						icon: 'info',
						title: 'Por favor registre primero fecha y hora...',
						showConfirmButton: false,
						timer: 2500
					})
				} else {
					if ($('#nombre' + id).val() == "" || $('#registro' + id).val() == "") {
						Swal.fire({
							position: 'top-end',
							icon: 'info',
							title: 'Por favor registre primero nombre y registro...',
							showConfirmButton: false,
							timer: 2500
						})
					} else {



						idImagen = id;
						limpiarCanvas()
						var myModal = new bootstrap.Modal(document.getElementById('modalFirma'))
						myModal.show()



					}
				}

			}


		}

		function pasarFirma() {
			if ($('#poldatos').prop('checked')) {
				imagencargada = canvas.toDataURL("image/png");
				//document.querySelector("#firma").src = window.opener.obtenerImagen();
				document.querySelector("#firma" + idImagen).src = canvas.toDataURL("image/png");

				$('#firma' + idImagen).removeClass('oculto')
				$('#btnFirmar' + idImagen).hide()


				if (idImagen == 1 || idImagen == 2) {
					firmasverificacion()
				}

				 


				if (idImagen == 100) {
					guardarObs()
				}


			} else {
				Swal.fire({
					position: 'top-end',
					icon: 'info',
					title: 'Debe aceptar las políticas de protección de datos perasonales',
					showConfirmButton: false,
					timer: 1500
				})
			}


			//document.querySelector("#btnfirmar").style.display = 'none';

		}

		function getParameterByName(name) {
			name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
			var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
				results = regex.exec(location.search);
			return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
		}

		var tag = getParameterByName('tag');
		var arrayDatos = []
		var firmasItems = []
		var arrayInfo = []

		odsq = localStorage.getItem('odsq');
		equipos = sessionStorage.getItem('equipo')
		alcance = sessionStorage.getItem('servicio')
		esp = sessionStorage.getItem('esp')


		var server = "https://utitalco.com/calidad/027/server/";

		$.post(server + 'cargarRca175.php', {
				ods: odsq,
				tag: tag
			},
			function (resp) {
				arrayDatos = resp
				cargarDatos()
			})

		function cargarDatos() {
			$('#unidad').html(arrayDatos.unidad)
			$('#planta').html(arrayDatos.planta)
			$('#ods').html(arrayDatos.ods)
			$('#equipo').html(arrayDatos.equipo)
			$('#sistema').html(arrayDatos.sistema)
			

			if(arrayDatos.info != ""){
			  
				arrayDatosInfor = JSON.parse(arrayDatos.info)

				$('#marcaEP').val(arrayDatosInfor[0].marcaEP)
				$('#modeloEP').val(arrayDatosInfor[0].modeloEP)
				$('#escalaEP').val(arrayDatosInfor[0].escalaEP)
				$('#fechacalib').val(arrayDatosInfor[0].fechacalib)
				$('#tensionEP').val(arrayDatosInfor[0].tensionEP)
				$('#tiempoEP').val(arrayDatosInfor[0].tiempoEP)
			  
			}

			if(arrayDatos.datosaislamiento != ""){
			  
			  arrayDatosPrueba = JSON.parse(arrayDatos.datosaislamiento)
				cargarItems()
			
		  	}

			  if (arrayDatos.fotos != "") {
				listaFotos = JSON.parse(arrayDatos.fotos)
				cargarGaleria()
			}



			if (arrayDatos.firmas != "") {
				var arrayFirmasItems = JSON.parse(arrayDatos.firmas)

				//ecp

				$('#fecha2').val(arrayFirmasItems[0].fechaec)
				$('#hora2').val(arrayFirmasItems[0].horaec)
				$('#nombre2').val(arrayFirmasItems[0].nombreec)

				if (arrayFirmasItems[0].fechaec != "") {
					document.querySelector("#firma2").src = arrayFirmasItems[0].firmaec;
					$('#firma2').removeClass('oculto')
					$('#btnFirmar2').hide()
				}

				$('#registro2').val(arrayFirmasItems[0].registroec)

				//ut

				$('#fecha1').val(arrayFirmasItems[0].fechaut)
				$('#hora1').val(arrayFirmasItems[0].horaut)
				$('#nombre1').val(arrayFirmasItems[0].nombreut)

				if (arrayFirmasItems[0].fechaut != "") {
					document.querySelector("#firma1").src = arrayFirmasItems[0].firmaut;
					$('#firma1').removeClass('oculto')
					$('#btnFirmar1').hide()
				}

				$('#registro1').val(arrayFirmasItems[0].registrout)


			}



			//CARGUE DE OBSERVACIONES

			if (arrayDatos.observaciones != "") {
				var arrayObs = JSON.parse(arrayDatos.observaciones)
				var html = ''
				for (var i = 0; i < arrayObs.length; i++) {
					html = `<b>Nota ${i+1}: </b>
				${arrayObs[i].obs} | ${arrayObs[i].nombre} | Registro: ${arrayObs[i].registro} | Fecha: ${arrayObs[i].fecha} | Firma: <span id="firm${i}" style="width: 60px;"></span> <br>--------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>
				`
					$('#observaciones').append(html)
					const imagef = document.createElement('img')
					imagef.src = arrayObs[i].firma
					imagef.height = "60"
					document.querySelector('#firm' + i).appendChild(imagef)

				}
			}
			if (arrayDatos.doc != "") {
				listaArchivos = JSON.parse(arrayDatos.doc)

			}


			Swal.close()


		}


		//actualiza informacion

		function actInfo(){
            var marcaEP = $('#marcaEP').val()
            var modeloEP = $('#modeloEP').val()
            var escalaEP = $('#escalaEP').val()
            var fechacalib = $('#fechacalib').val()
			var tensionEP = $('#tensionEP').val()
			var tiempoEP = $('#tiempoEP').val()

            var arrayInfo = []

            arrayInfo.push({
                "marcaEP":marcaEP,
                "modeloEP":modeloEP,
                "escalaEP":escalaEP,
                "fechacalib":fechacalib,
				"tensionEP":tensionEP,
				"tiempoEP":tiempoEP
            })

            $.post(server + 'act175info.php', {
                    ods: odsq,
                    tag: tag,
                    datos: JSON.stringify(arrayInfo)
                },
                function (res) {
                        Swal.fire({
                            position: 'top-end',
                            icon: 'success',
                            width: 100,
                            showConfirmButton: false,
                            timer: 1500
                        })
                })



        }


		function agregarDatosaislamiento() {

			Swal.fire({
				title: 'AISLAMIENTO (GΩ)',
				html: `
				<div class="row" style="width: 100%">
					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;  text-align: right;">TAG CTO</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="tagcto" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>
					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;">L1-L2</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="l1l2" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>
					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;">L1-L3</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="l1l3" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>
					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;">L2-L3</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="l2l3" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>
					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;">L1-T</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="l1t" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>

					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;">L2-T</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="l2t" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>
					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;">L3-T</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="l3t" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>
					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;">L1-N</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="l1n" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>
					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;">L2-N</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="l2n" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>
					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;">L3-N</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="l3n" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>
					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;">T-N</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="tn" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>
					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;">Continuidad</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="continuidad" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>
					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;">Calibre</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="calibre" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>
					<div class="col-sm-2 text-right" style="padding-top: 20px;  text-align: right;"> 
						<span style="font-size: 16px;">Lontitud Mts</span>
					</div>
					<div class="col-sm-4">
						<input type="text" id="longitud" style="border-bottom-style: solid; border-bottom-width: 1px">
					</div>
					
				</div>
			 
				`,
				width: 700,
				showCancelButton: true,
				confirmButtonText: 'Guardar',
			}).then((result) => {
				/* Read more about isConfirmed, isDenied below */
				if (result.isConfirmed) {

					var tagcto = $('#tagcto').val()
					var l1l2 = $('#l1l2').val()
					var l1l3 = $('#l1l3').val()
					var l2l3 = $('#l2l3').val()
					var l1t = $('#l1t').val()
					var l2t = $('#l2t').val()
					var l3t = $('#l3t').val()
					var l1n = $('#l1n').val()
					var l2n = $('#l2n').val()
					var l3n = $('#l3n').val()
					var tn = $('#tn').val()
					var continuidad = $('#continuidad').val()
					var calibre = $('#calibre').val()
					var longitud = $('#longitud').val()

					arrayDatosPrueba.push({
						"tagcto": tagcto,
						"l1l2": l1l2,
						"l1l3": l1l3,
						"l2l3": l2l3,
						"l1t": l1t,
						"l2t": l2t,
						"l3t": l3t,
						"l1n": l1n,
						"l2n": l2n,
						"l3n": l3n,
						"tn": tn,
						"continuidad": continuidad,
						"calibre": calibre,
						"longitud": longitud
					})

					$.post(server + 'act175DatosAislamiento.php', {
							ods: odsq,
							tag: tag,
							datos: JSON.stringify(arrayDatosPrueba)
						},
						function (res) {
							Swal.fire({
								position: 'top-end',
								icon: 'success',
								width: 100,
								showConfirmButton: false,
								timer: 1500
							}).then(()=>{
								cargarItems()
							})
						})
				} 
			})


		}

		function cargarItems(){
			html = `<table id="" style="width: 100%;">
				<tr>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
				height="96" align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">TAG CTO </font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">L1-L2</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">L1-L3</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">L2-L3</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000"> L1-T</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">L2-T</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">L3-T</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">L1-N</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">L2-N</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">L3-N</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">T-N</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">CONTINUIDAD</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
				colspan=2 align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">CALIBRE</font>
				</b></td>
			<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
				colspan=2 align="center" valign=middle bgcolor="#BFBFBF"><b>
					<font face="Arial Narrow" size=3 color="#000000">LONGITUD EN MTS</font>
				</b></td>
		</tr>
				`

			for(var i=0; i<arrayDatosPrueba.length; i++){
				
			

				html += `
				<tr>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 2px solid #000000; border-right: 1px solid #000000"
						height="29" align="left" valign=bottom>
						<font face="Arial Narrow" size=3><span id="">	${arrayDatosPrueba[i].tagcto}</span></font>
					</td>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
						align="center" valign=middle>
						<font face="Arial Narrow" size=3><span id="">${arrayDatosPrueba[i].l1l2}</span></font>
					</td>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
						align="center" valign=middle>
						<font face="Arial Narrow" size=3><span id="">${arrayDatosPrueba[i].l1l3}</span></font>
					</td>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
						align="center" valign=middle>
						<font face="Arial Narrow" size=3><span id="">${arrayDatosPrueba[i].l2l3}</span></font>
					</td>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
						align="center" valign=middle>
						<font face="Arial Narrow" size=3><span id="">${arrayDatosPrueba[i].l1t}</span></font>
					</td>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
						align="center" valign=middle>
						<font face="Arial Narrow" size=3><span id="">${arrayDatosPrueba[i].l2t}</span></font>
					</td>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
						align="center" valign=middle>
						<font face="Arial Narrow" size=3><span id="">${arrayDatosPrueba[i].l3t}</span></font>
					</td>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
						align="center" valign=middle>
						<font face="Arial Narrow" size=3><span id="">${arrayDatosPrueba[i].l1n}</span></font>
					</td>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
						align="center" valign=middle>
						<font face="Arial Narrow" size=3><span id="">${arrayDatosPrueba[i].l2n}</span></font>
					</td>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
						align="center" valign=middle>
						<font face="Arial Narrow" size=3><span id="">${arrayDatosPrueba[i].l3n}</span></font>
					</td>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
						align="center" valign=middle>
						<font face="Arial Narrow" size=3><span id="">${arrayDatosPrueba[i].tn}</span></font>
					</td>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
						align="center" valign=middle>
						<font face="Arial Narrow" size=3><span id="">${arrayDatosPrueba[i].continuidad}</span></font>
					</td>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000"
						colspan=2 align="center" valign=middle>
						<font face="Arial Narrow" size=3><span id="">${arrayDatosPrueba[i].calibre}</span></font>
					</td>
					<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 2px solid #000000"
						colspan=2 align="center" valign=middle>
						<font face="Arial Narrow" size=3><span id="">${arrayDatosPrueba[i].longitud}</span></font>
					</td>
				</tr>
				`
			}

			html += `</table>`

			$('#datosPrueba').html(html)
		}

		function firmasverificacion() {

			var fechaec = $('#fecha2').val()
			var horaec = $('#hora2').val()
			var nombreec = $('#nombre2').val()

			var img = document.getElementById("firma2");
			var firmaec = img.src

			if (fechaec == '') {
				firmaec = ''
			}

			var registroec = $('#registro2').val()

			var fechaut = $('#fecha1').val()
			var horaut = $('#hora1').val()
			var nombreut = $('#nombre1').val()

			var img = document.getElementById("firma1");
			var firmaut = img.src

			if (fechaut == '') {
				firmaut = ''
			}

			var registrout = $('#registro1').val()

			var arrayFirmasItems = []

			arrayFirmasItems.push({
				'fechaec': fechaec,
				'horaec': horaec,
				'nombreec': nombreec,
				'firmaec': firmaec,
				'registroec': registroec,
				'fechaut': fechaut,
				'horaut': horaut,
				'nombreut': nombreut,
				'firmaut': firmaut,
				'registrout': registrout,
			})

			$.post(server + 'act175Firmas.php', {
					ods: odsq,
					tag: tag,
					datos: JSON.stringify(arrayFirmasItems)
				},
				function (res) {
					Swal.fire({
						position: 'top-end',
						icon: 'success',
						width: 100,
						showConfirmButton: false,
						timer: 1500
					})
				})

		}

	 

		function mostraraviso() {
			let timerInterval
			Swal.fire({
				title: 'Políticas de protección de datos personales',
				text: 'En cumplimiento con la Ley 1581 de protección de datos personales, se le informa que los datos suministrados serán incorporados a una base de datos cuya finalidad es el registro de control de actividades RCA y las actuaciones que se deriven de dicha gestión, cuyo responsable del tratamiento es UT ITALCO. Mediante el registro de sus datos  a través de este formato usted autoriza a UT ITALCO, a tratar los datos con la finalidad descrita arriba.  Como Titular se le informa que podrá ejercer sus derechos de acceso y reclamos a través del correo de contacto pqrsbca@utitalco.com.',
				timer: 20000,
				timerProgressBar: true,
				didOpen: () => {
					Swal.showLoading()
					const b = Swal.getHtmlContainer().querySelector('b')
					timerInterval = setInterval(() => {
						b.textContent = Swal.getTimerLeft()
					}, 100)
				},
				willClose: () => {
					clearInterval(timerInterval)
				}
			}).then((result) => {
				/* Read more about handling dismissals below */
				if (result.dismiss === Swal.DismissReason.timer) {
					console.log('I was closed by the timer')
				}
			})
		}

		function cargando() {
			let timerInterval
			Swal.fire({
				title: 'Cargando formato...!',
				timer: 20000,
				timerProgressBar: true,
				didOpen: () => {
					Swal.showLoading()
					const b = Swal.getHtmlContainer().querySelector('b')
					timerInterval = setInterval(() => {
						// b.textContent = Swal.getTimerLeft()
					}, 100)
				},
				willClose: () => {
					clearInterval(timerInterval)
				}
			}).then((result) => {
				/* Read more about handling dismissals below */
				if (result.dismiss === Swal.DismissReason.timer) {
					console.log('I was closed by the timer')
				}
			})
		}

		function verArchivos() {
			var htmltexto = ''
			for (var i = 0; i < listaArchivos.length; i++) {
				htmltexto += `
				<a href='https://utitalco.com/calidad/027/server/archivos/${listaArchivos[i].archivo}' target='_blank'>${listaArchivos[i].archivo}</a> <br>
			`
			}

			Swal.fire({
				title: '<strong>Lista de adjuntos</strong>',
				icon: 'info',
				html: `
			Pulse click sobre el archivo que desea descargar... <br>
			${htmltexto}
			`

			})
		}

		function adjuntar() {
			Swal.fire({
				title: 'Adjuntar archivo',
				html: `
			<input type="file" id="archivo" class="form-control" placeholder="Buscar...">
			`,
				showCancelButton: true,
				confirmButtonText: 'Adjuntar'
			}).then((result) => {
				/* Read more about isConfirmed, isDenied below */
				if (result.isConfirmed) {

					var formData = new FormData();
					var files = $('#archivo')[0].files[0];
					formData.append('archivo', files);
					formData.append('ods', odsq);
					formData.append('tag', tag);
					$.ajax({
						url: server + 'guardarArchivo175.php',
						type: 'post',
						data: formData,
						contentType: false,
						processData: false,
						success: function (response) {
							console.log(response)

							if (response.msn == "Ok") {
								Swal.fire({
									position: 'top-end',
									icon: 'success',
									title: 'Archivo cargado correctamente...',
									showConfirmButton: false,
									timer: 1500
								}).then(() => {

									location.reload();
								})
							} else {
								Swal.fire({
									icon: 'error',
									title: 'Oops...',
									text: 'Formato de archivo incorrecto...!',
								})
							}
						}
					});

				}
			})
		}

		function foto() {
			Swal.fire({
				title: 'Adjuntar Foto',
				html: `
			<input type="file" id="foto" class="form-control" placeholder="Buscar...">
			`,
				showCancelButton: true,
				confirmButtonText: 'Adjuntar'
			}).then((result) => {
				/* Read more about isConfirmed, isDenied below */
				if (result.isConfirmed) {

					var formData = new FormData();
					var files = $('#foto')[0].files[0];
					formData.append('archivo', files);
					formData.append('ods', odsq);
					formData.append('tag', tag);
					$.ajax({
						url: server + 'guardarFoto175.php',
						type: 'post',
						data: formData,
						contentType: false,
						processData: false,
						success: function (response) {
							console.log(response)

							if (response.msn == "Ok") {
								Swal.fire({
									position: 'top-end',
									icon: 'success',
									title: 'Foto cargada correctamente...',
									showConfirmButton: false,
									timer: 1500
								}).then(() => {

									location.reload();
								})
							} else {
								Swal.fire({
									icon: 'error',
									title: 'Oops...',
									text: 'Formato de archivo incorrecto...!',
								})
							}
						}
					});

				}
			})
		}

		function cargarGaleria(){
			var html = ''
			for(var i=0; i<listaFotos.length; i++){
				html += `
				<a href="https://utitalco.com/calidad/027/server/archivos/${listaFotos[i].archivo}" target="_blank" rel="noopener noreferrer">
						<img src="https://utitalco.com/calidad/027/server/archivos/${listaFotos[i].archivo}" width="280px"  style="margin: 10px; border-radius: 10px;" >
					</a>
				`
					$('#galeria').html(html)
			}

		}

		function guardarObs() {
			var observacion = $('#obs100').val()
			var nombreobs = $('#nombre100').val()
			var registroobs = $('#registro100').val()
			var img = document.getElementById("firma100");

			// crea un nuevo objeto `Date`
			var today = new Date();

			// obtener la fecha y la hora
			var now = today.toLocaleString();
			var firmaobs = img.src

			if (arrayDatos.observaciones != "") {

				var arrayLmp = JSON.parse(arrayDatos.observaciones)
			} else {
				var arrayLmp = []
			}



			arrayLmp.push({
				"obs": observacion,
				"nombre": nombreobs,
				"registro": registroobs,
				"firma": firmaobs,
				"fecha": now
			})


			$.post(server + 'actOs175Obs.php', {
					ods: odsq,
					tag: tag,
					datos: JSON.stringify(arrayLmp)
				},
				function (res) {
					console.log(res)
					location.reload()
				})

		}
	</script>
</body>

</html>
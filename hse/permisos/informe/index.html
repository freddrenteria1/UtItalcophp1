<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INFORME DIARIO GESTIÓN DE PERMISOS - UT ITALCO </title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.6.0/dist/umd/popper.min.js" integrity="sha384-KsvD1yqQ1/1+IA7gi3P0tyJcT3vR+NdBTt13hSJ2lnve8agRGXTTyNaBYmCR/Nwi" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.min.js" integrity="sha384-nsg8ua9HAw1y0W1btsyWgBklPnCUAFLuTMS2G72MMONqmOymq585AcH49TLBQObG" crossorigin="anonymous"></script>

    <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">

    <script type="text/javascript" src="https://code.highcharts.com/highcharts.js"></script>
    <!--<link rel="stylesheet" href="https://code.highcharts.com/css/themes/dark-unica.css"> -->
    <script src="https://code.highcharts.com/highcharts-3d.js"></script>
    <script src="https://code.highcharts.com/modules/cylinder.js"></script>
    <script src="https://code.highcharts.com/modules/funnel3d.js"></script>
    <script src="https://code.highcharts.com/modules/pyramid3d.js"></script>
    <!-- <script src="https://code.highcharts.com/modules/exporting.js"></script>
	<script src="https://code.highcharts.com/modules/export-data.js"></script>
	<script src="https://code.highcharts.com/modules/accessibility.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.2.61/jspdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.svg.js"></script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/amstockchart/3.13.0/exporting/canvg.js"></script>
    <script type="text/javascript" src="https://unpkg.com/stackblur-canvas@2.3.0/dist/stackblur.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highstock/6.0.3/lib/rgbcolor.js"></script>

    <style>
        /* estilos de pagina */
        
        body,
        html {
            height: 100%;
            width: 100%;
        }
        
        .salto {
            PAGE-BREAK-AFTER: always;
        }
        
        .cuerpo {
            width: 2000px;
            height: 100%;
        }
        
        .cab {
            background-color: #1f4e78;
            width: 100%;
            height: auto;
            color: white;
        }
        
        .titfecha {
            padding: 5px;
            border-style: solid;
            border-color: white;
            border-width: 0.7px;
            border-radius: 5px;
            text-align: center;
        }
        
        .central {
            height: 507px;
            width: 100%;
        }
        
        .oculto {
            display: none;
        }
        
        .diap {
            position: fixed;
            top: 80px;
            left: 0px;
            height: 500px;
            width: 100%;
            padding-left: 130px;
            padding-right: 130px;
            padding-top: 10px;
            display: table;
        }
        
        .anchomedio {
            width: 600px;
            left: 300px;
            height: 400px;
            margin: 0 auto;
        }
        
        #inicio {
            margin-top: 10px;
            margin-left: 50px;
            cursor: pointer;
            z-index: 999;
            position: absolute;
        }
        
        #sig {
            margin-top: 10px;
            right: 50px;
            cursor: pointer;
            z-index: 999;
            position: absolute;
        }
        
        #atraspiramide {
            margin-top: 10px;
            right: 50px;
            cursor: pointer;
            z-index: 999;
            position: absolute;
        }
        
        .footer {
            background-color: #b9d204;
            width: 100%;
            padding: 5px;
            text-align: center;
            position: fixed;
            bottom: 0px;
        }
        
        #divhidden {
            display: none;
        }
        /* fin estilos de pagina */
        /* estilos del menu */
        
        #mnu {
            width: 707px;
            height: 500px;
            background-image: url('img/mnu_1.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
            z-index: 999;
        }
        
        .mnu1 {
            position: relative;
            top: 50px;
            left: 390px;
            width: 120px;
            height: 65px;
            padding: 10px;
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
            font-weight: bold;
            font-size: 16px;
            text-align: center;
            cursor: pointer;
        }
        
        .mnu2 {
            position: relative;
            top: 103px;
            left: 480px;
            width: 120px;
            height: 65px;
            padding: 10px;
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
            font-weight: bold;
            font-size: 16px;
            text-align: center;
            cursor: pointer;
        }
        
        .mnu3 {
            position: relative;
            top: 158px;
            left: 485px;
            width: 120px;
            height: 65px;
            padding: 10px;
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
            font-weight: bold;
            font-size: 15px;
            text-align: center;
            cursor: pointer;
        }
        
        .mnu4 {
            position: relative;
            top: 213px;
            left: 384px;
            width: 120px;
            height: 65px;
            padding: 10px;
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
            font-weight: bold;
            font-size: 16px;
            text-align: center;
            cursor: pointer;
        }
        /* fin estilo de menu */
        /* estilo de graficas */
        
        .colpir {
            text-align: center;
            font-size: 10px;
            width: 100px;
            border-style: solid;
            border-width: 1px;
            border-color: #ffffff;
        }
        
        .filapir {
            background-color: #00c901;
            color: white;
        }
        
        .filatit {
            border-style: solid;
            border-width: 1px;
            border-color: #80af23;
        }
        
        .cabtit {
            text-align: center;
            font-size: 14px;
            width: 100px;
            border-style: solid;
            border-width: 1px;
            border-color: #1f4e78;
            background-color: white;
        }
        
        .card-header {
            background-color: #1f4e78;
            color: white;
        }
        
        .oculto {
            display: none;
        }
        
        .visible {
            display: contents;
        }
        
        #galeria {
            height: 400px;
            width: 400px;
            position: absolute;
            top: 0px;
            left: 20px;
            z-index: 999;
            overflow: hidden;
        }
        
        .imagen:hover {
            filter: opacity(.5);
        }
        
        #grafpiramide {
            width: 100%;
            height: 500px;
            background-image: url('img/piramide_n.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }
        
        .fig1 {
            width: 131px;
            height: 170px;
            background-image: url('img/infogvr1.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
            float: left;
        }
        
        #fig2 {
            width: 131px;
            height: 170px;
            background-image: url('img/infog2.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
            float: left;
        }
        
        #fig3 {
            width: 131px;
            height: 170px;
            background-image: url('img/infog3.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
            float: left;
        }
        
        #infoverde1 {
            width: 200px;
            height: 200px;
            background-image: url('img/infogv1.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }
        
        #infoverde2 {
            width: 200px;
            height: 200px;
            background-image: url('img/infogv2.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }
        
        #inforojo {
            width: 200px;
            height: 200px;
            background-image: url('img/infog4.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }
        
        .textopira {
            display: table-cell;
            vertical-align: middle;
        }
        
        .hijo {
            display: table-cell;
            vertical-align: middle;
        }
        
        .padre {
            display: table;
        }
        
        .titinfovr {
            width: 100%;
            height: 29.41%;
            font-size: 14px;
            text-align: center;
        }
        
        .cifrainfovr {
            width: 100%;
            height: 70.59%;
            font-size: 44px;
            text-align: center;
        }
        
        #piso7 {
            width: 100%;
            height: 13.60%;
            display: table;
        }
        
        #piso6 {
            width: 100%;
            height: 10.39%;
            display: table;
        }
        
        #piso5 {
            width: 100%;
            height: 10.39%;
            display: table;
        }
        
        #piso4 {
            width: 100%;
            height: 10.39%;
            display: table;
        }
        
        #piso3 {
            width: 100%;
            height: 13.86%;
            display: table;
        }
        
        #piso2 {
            width: 100%;
            height: 13.86%;
            display: table;
        }
        
        #piso1 {
            width: 100%;
            height: 13.86%;
            display: table;
        }
        
        .tacomoda {
            width: 5%;
        }
        
        #flotante {
            height: 400px;
            width: 500px;
            position: absolute;
            left: 20px;
            top: 60px;
            z-index: 999;
        }
        
        #flotantefoto {
            height: 400px;
            width: 400px;
            position: absolute;
            left: 20px;
            top: 60px;
            z-index: 999;
        }
        
        .manito {
            cursor: pointer;
        }
        
        .titregfot {
            width: 100%;
            height: 50px;
            ;
            background-color: #1f4e78;
            color: white;
            padding: 10px;
            float: left;
            margin-top: 20px;
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        .titflot {
            background-color: rgb(255, 187, 0);
            color: rgba(20, 19, 19, 0.9);
            padding: 5px;
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
            font-size: 13px;
        }
        
        #regfotos {
            overflow-y: scroll;
            overflow-x: hidden;
            white-space: nowrap;
            position: fixed;
            top: 80px;
            left: 0px;
            height: 500px;
            width: 100%;
            padding-left: 130px;
            padding-right: 130px;
            padding-top: 10px;
        }
        
        .foto {
            width: 320px;
            height: 300px;
            padding: 10px;
            float: left;
        }
        
        .piefoto {
            background-color: #1f4e78;
            color: white;
            padding: 5px;
            height: 60px;
            width: 100%;
            text-align: center;
            width: 100%;
            word-wrap: break-word;
            font-size: 13px;
        }
        
        .titcatfotos {
            font-size: 16px;
            width: 90%;
            height: 40px;
            padding: 8px;
            margin-top: 20px;
            background-color: #1f4e78;
            color: white;
            float: left;
        }
        
        .verticalText {
            writing-mode: vertical-lr;
        }
        
        td {
            Word-wrap: break-Word;
        }
        
        .imglogop {
            width: 120px;
        }
        
        @media (max-width: 600px) {
            h4 {
                font-size: 15px;
            }
            h6 {
                font-size: 10px;
            }
            h5 {
                font-size: 10px;
            }
            .imglogop {
                width: 120px;
            }
            .foto {
                width: 90%;
                height: 90%;
            }
            #grafpiramide {
                width: 100%;
                height: 400px;
            }
            .tacomoda {
                width: 0%;
            }
        }
        /* fin estilo de graficas */
    </style>

    <style>
        .figuras {
            border-style: solid;
            border-width: 1px;
            border-radius: 10px;
            border-color: #1f4e78;
            margin: 10px;
        }
        
        th {
            text-align: center;
        }
        
        thead tr th {
            position: sticky;
            top: 0;
            z-index: 10;
            background-color: #1f4e78;
            text-align: center;
        }
        
        .oculto {
            display: none;
        }
        
        .visible {
            display: contents;
        }
        
        .table-responsive {
            height: 650px;
            overflow: scroll;
        }
    </style>
</head>

<body>

    <div>

        <div class="cab">
            <div class="container">
                <div class="row text-center">
                    <div class="col-sm-3 p-2 text-center">
                        <img src="img/logo_m.png" class="imglogop" alt="">
                    </div>
                    <div class="col-sm-7 p-2">
                        <h5>INFORME DIARIO DE GESTIÓN DE PERMISOS</h5>
                        <h6><span id="ods"></span></h6>
                    </div>
                    <div class="col-sm-2 mt-2">
                        <h5 class="titfecha" style="color: white;" id="fechainforme"></h5>
                    </div>

                </div>
            </div>
        </div>




        <table class="table">

            <tr>

                <th>
                    Cliente:
                </th>
                <td>
                    Ecopetrol S.A.
                </td>
                <th>
                    Total Personas:
                </th>
                <td>
                    <span id="totpersonas"></span>
                </td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>



        </table>

        <!-- Inicio Graficas -->


        <div class="card-header mb-2">
            GRAFICAS KPI's PERMISOS DE TRABAJO REALIZADOS
        </div>
        <div id="graficas">
            <hr>
            <div class="row m-2">

                <div class="col-sm-12 ">
                    <div class="figuras" id="figpermest">

                    </div>
                </div>

                <div class="col-sm-12 ">
                    <div class="figuras" id="figpertrabaesp2">

                    </div>
                </div>
                

                <div class="col-sm-12">
                    <div class="figuras" id="figmatrizram">

                    </div>
                </div>

                


                

            </div>
        </div>
        <!-- Fin de Graficas -->

        <div id="indicadoresgestion" style="margin-top: 10px;">


            <center class="p-2">
                <button type="button" class="btn btn-info" id="btnvista" onclick="verDetalles()">Ver Detalles</button>
            </center>


            <div id="detalles" class="oculto">

                <div id="tablapermisos" class="table-responsive">
                    <table class="table-bordered">
                        <thead class="" style="background-color: #1f4e78; color: #fff;">
                            <tr style="height: 150px;">
                                <th>
                                    # PERMISO
                                </th>
                                <th style="background-color: #fbff00; color: rgb(0, 0, 0);">
                                    <span class="verticalText">FRIO</span>
                                </th>
                                <th  style="background-color: #ff0303; color: #fff;">
                                    <span class="verticalText">CALIENTE</span>
                                </th>
                                <th  style="background-color: #f88f06; color: #fff;">
                                    <span class="verticalText">ELECTRICO</span>
                                </th>
                                <th>
                                    ACTIVIDAD
                                </th>
                                <th>
                                    ESPECIALIDAD
                                </th>
                                <th>
                                    SUPERVISOR
                                </th>
                                <th>
                                    ÁREA
                                </th>
                                <th>
                                    EQUIPO
                                </th>
                                <th>
                                    PLANTA
                                </th>
                                <th>
                                    TURNO
                                </th>
                                <th  style="background-color: #04a70d; color: #fff;">
                                    <span class="verticalText">BAJO</span>
                                </th>
                                <th style="background-color: #f3e355; color: rgb(31, 30, 30);">
                                    <span class="verticalText">MEDIO</span>
                                </th>
                                <th style="background-color: #f19d00; color: rgb(24, 23, 23);">
                                    <span class="verticalText">ALTO</span>
                                </th>
                                <th style="background-color: #ff0303; color: #fff;">
                                    <span class="verticalText">MUY ALTO</span>
                                </th>
                                <th>
                                    AR
                                </th>
                                <th>
                                    <span class="verticalText">CERT. AP. 1</span>
                                </th>
                                <th>
                                    <span class="verticalText">CERT. AP. 2</span>
                                </th>
                                <th>
                                    <span class="verticalText">CERT. AP. 3</span>
                                </th>
                                <th>
                                    <span class="verticalText">CERT. AP. 5</span>
                                </th>
                                <th>
                                    <span class="verticalText">CERT. AP. 6</span>
                                </th>
                                <th>
                                    <span class="verticalText">CERT. AP. 7</span>
                                </th>
                                <th>
                                    <span class="verticalText">SAS</span>
                                </th>
                                <th>
                                    <span class="verticalText">SAES</span>
                                </th>
                                <th>
                                    <span class="verticalText">PROC. RESC. ALTURA</span>
                                </th>
                                <th>
                                    <span class="verticalText">P.R. ESP. CONFINADO</span>
                                </th>
                                <th>
                                    <span class="verticalText">P.R. GASES TOX.</span>
                                </th>
                                <th>
                                    <span class="verticalText">CIERRE DE VIAS</span>
                                </th>
                                <th>
                                    <span class="verticalText">PLAN DE IZAJE</span>
                                </th>
                                <th>
                                    <span class="verticalText">AGUA CONTRAINC. </span>
                                </th>
                                <th style="background-color: #2b66bd; color: #fff;">
                                    <span class="verticalText">PERMISOS REVALIDADOS </span>
                                </th>
                                <th style="background-color: #2bbd63; color: #fff;">
                                    <span class="verticalText">PERMISOS NUEVOS</span>
                                </th>
                                <th style="background-color: #ffa32b; color: rgb(0, 0, 0);">
                                    <span class="verticalText">PERMISOS CERRADOS</span>
                                </th>
                                <th>
                                    # PERMISO CERRADO
                                </th>
                                <th>
                                    <span class="verticalText"># PERSONAS EJE.</span>
                                </th>
                                <th>
                                    <span class="verticalText">SEMANA</span>
                                </th>
                                <th>
                                    <span class="">ESTADO</span>
                                </th>
                            </tr>


                        </thead>
                        <tbody id="datostabla">

                        </tbody>
                    </table>


                </div>

            </div>

        </div>

        <div class="p-3"></div>

    </div>


    <script>
        var server = 'https://utitalco.com/server/';
        var user = sessionStorage.getItem('user');
        var ods = localStorage.getItem('ods')
        var numods = localStorage.getItem('numods')
        var arrayDatos = []
        var arrayTabla = []
        var arrayResp = []
        var html = ''
        var frep = ''

        var arrayAbierto = []
        var arrayCerrado = []
        var arrayNoEje = []

        var arrayTurnos = []
        var arrayFrentes = []
        var arrayPfrio = []
        var arrayPcaliente = []
        var arrayPelectrico = []
        var arraytotalp = []
        var arrayMraml = []
        var arrayMramm = []
        var arrayMramh = []
        var arrayMramvh = []
        var arraytotalmatriz = []

        var arrayCca1 = []
        var arrayCca2 = []
        var arrayCca3 = []
        var arrayCca5 = []
        var arrayCca6 = []
        var arrayCca7 = []
        var arraySsas = []
        var arraySsaes = []
        var arraytotalca = []

        var arrayPpra = []
        var arrayPprc = []
        var arrayPprg = []
        var arraytotalpr = []

        var arrayCca1n = []
        var arrayCca2n = []
        var arrayCca3n = []
        var arrayCca5n = []
        var arrayCca6n = []
        var arrayCca7n = []
        var arraySsasn = []
        var arraySsaesn = []
        var arraytotalcan = []

        var arrayPpran = []
        var arrayPprcn = []
        var arrayPprgn = []
        var arraytotalprn = []

        var arrayPpnuevos = []
        var arrayPprevalidados = []
        var arrayPpcerrados = []

        var vista = 0;

        function getParameterByName(name) {
            name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                results = regex.exec(location.search);
            return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }

        var numods = getParameterByName('ods');

        buscarOds()

        function buscarOds() {
            $.post(server + 'bodspermisos.php', {
                    ods: numods
                },
                function(resp) {
                    console.log(resp)
                    if (resp.msn == 'OK') {
                        ods = resp.ods

                        localStorage.setItem('numods', numods)
                        localStorage.setItem('ods', ods)

                        $('#ods').html(ods)


                        pedirfecha()

                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: 'No está registrada esta Orden de Servicio, por favor verifique el link suministrado...!'
                        }).then((result) => {
                            window.location = '../hse/index_404.html'
                        })
                    }
                })
        }


        function pedirfecha() {
            Swal.fire({
                title: 'Fecha de Informe',
                html: `
                    <div class="row">
                        <div class="col-sm-6 text-right pt-2">
                            Fecha Informe
                        </div>
                        <div class="col-sm-6 text-right">
                            <input type="date" id="fecha" class="form-control">
                        </div>
                    </div>
                `,
                showConfirmButton: true,
                confirmButtonText: 'Aceptar',
                showCancelButton: true,
                cancelButtonText: 'Cancelar'
            }).then((result) => {
                if (result.isConfirmed) {

                    fecha = $('#fecha').val()

                    localStorage.setItem('fecha', fecha)
                    frep = localStorage.getItem('fecha')

                    $('#fechainforme').html(fecha)

                    //busca la ods y carga sus datos
                    cargarDatos()


                }
            })
        }


        function cargarDatos() {

            $.post(server + 'infoPermisos.php', {
                    ods: numods,
                    fecha: frep
                },
                function(resp) {
                    arrayDatos = resp
                    console.log(resp.tabla)
                    arrayTabla = resp.tabla

                    for (var i = 0; i < arrayDatos.frentes.length; i++) {
                        arrayFrentes.push(arrayDatos.frentes[i].frente)
                    }

                    for (var i = 0; i < arrayDatos.datos.length; i++) {


                        arrayAbierto.push(arrayDatos.datos[i].abiertos)
                        arrayCerrado.push(arrayDatos.datos[i].cerrados)
                        arrayNoEje.push(arrayDatos.datos[i].noeje)

                        arrayPfrio.push(arrayDatos.datos[i].pfrio)
                        arrayPcaliente.push(arrayDatos.datos[i].pcaliente)
                        arrayPelectrico.push(arrayDatos.datos[i].pelectrico)
                        arraytotalp.push(arrayDatos.datos[i].totalp)

                        arrayMraml.push(arrayDatos.datos[i].raml)
                        arrayMramm.push(arrayDatos.datos[i].ramm)
                        arrayMramh.push(arrayDatos.datos[i].ramh)
                        arrayMramvh.push(arrayDatos.datos[i].ramvh)
                        arraytotalmatriz.push(arrayDatos.datos[i].totalmatriz)

                        arrayCca1.push(arrayDatos.datos[i].ca1)
                        arrayCca2.push(arrayDatos.datos[i].ca2)
                        arrayCca3.push(arrayDatos.datos[i].ca3)
                        arrayCca5.push(arrayDatos.datos[i].ca5)
                        arrayCca6.push(arrayDatos.datos[i].ca6)
                        arrayCca7.push(arrayDatos.datos[i].ca7)
                        arraySsas.push(arrayDatos.datos[i].sas)
                        arraySsaes.push(arrayDatos.datos[i].saes)
                        arraytotalca.push(arrayDatos.datos[i].totalca)

                        arrayPpra.push(arrayDatos.datos[i].pra)
                        arrayPprc.push(arrayDatos.datos[i].prc)
                        arrayPprg.push(arrayDatos.datos[i].prg)
                        arraytotalpr.push(arrayDatos.datos[i].totalpr)

                        arrayCca1n.push(arrayDatos.datos[i].ca1n)
                        arrayCca2n.push(arrayDatos.datos[i].ca2n)
                        arrayCca3n.push(arrayDatos.datos[i].ca3n)
                        arrayCca5n.push(arrayDatos.datos[i].ca5n)
                        arrayCca6n.push(arrayDatos.datos[i].ca6n)
                        arrayCca7n.push(arrayDatos.datos[i].ca7n)
                        arraySsasn.push(arrayDatos.datos[i].sasn)
                        arraySsaesn.push(arrayDatos.datos[i].saesn)
                        arraytotalcan.push(arrayDatos.datos[i].totalcan)

                        arrayPpran.push(arrayDatos.datos[i].pran)
                        arrayPprcn.push(arrayDatos.datos[i].prcn)
                        arrayPprgn.push(arrayDatos.datos[i].prgn)
                        arraytotalprn.push(arrayDatos.datos[i].totalprn)

                         

                        arrayPpnuevos.push(arrayDatos.datos[i].pnuevos)
                        arrayPprevalidados.push(arrayDatos.datos[i].prevalidados)
                        arrayPpcerrados.push(arrayDatos.datos[i].pcerrados)


                    }



                    $('#totpersonas').html(arrayDatos.personal)
                    $('#observaciones').html(arrayDatos.observaciones)

                    html = ''
                    for (var i = 0; i < arrayTabla.length; i++) {
                        html += `
                    <tr>
                        <td style="width: 90px;">
                            ${arrayTabla[i].num}
                        </td>
                        <td style="text-align: center;  width: 30px;">
                            ${arrayTabla[i].pfrio == 0 ? "" : arrayTabla[i].pfrio}
                        </td>
                        <td  style="text-align: center;  width: 30px;">
                            ${arrayTabla[i].pcaliente == 0 ? "" : arrayTabla[i].pcaliente} 
                        </td>
                        <td  style="text-align: center;  width: 30px;">
                            ${arrayTabla[i].pelectrico == 0 ? "" : arrayTabla[i].pelectrico}
                        </td>
                        <td style="width: 400px;">
                            ${arrayTabla[i].actividad}
                        </td>
                        <td style="width: 200px;">
                            ${arrayTabla[i].especialidad}
                        </td>
                        <td style="width: 200px;">
                            ${arrayTabla[i].supervisor}
                        </td>
                        <td style="width: 150px;">
                            ${arrayTabla[i].area}
                        </td>
                        <td style="width: 150px;">
                            ${arrayTabla[i].equipo}
                        </td>
                        <td style="width: 150px;">
                            ${arrayTabla[i].planta}
                        </td>
                        <td style="width: 150px;">
                            ${arrayTabla[i].turno}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].raml == 0 ? "" : arrayTabla[i].raml}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].ramm == 0 ? "" : arrayTabla[i].ramm}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].ramh == 0 ? "" : arrayTabla[i].ramh}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].ramvh == 0 ? "" : arrayTabla[i].ramvh}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            1
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].ca1 == 0 ? "" : arrayTabla[i].ca1}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].ca2 == 0 ? "" : arrayTabla[i].ca2}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].ca3 == 0 ? "" : arrayTabla[i].ca3}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].ca5 == 0 ? "" : arrayTabla[i].ca5}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].ca6 == 0 ? "" : arrayTabla[i].ca6}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].ca7 == 0 ? "" : arrayTabla[i].ca7}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].sas == 0 ? "" : arrayTabla[i].sas}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].saes == 0 ? "" : arrayTabla[i].saes}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].pra == 0 ? "" : arrayTabla[i].pra}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].prc == 0 ? "" : arrayTabla[i].prc}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].prg == 0 ? "" : arrayTabla[i].prg}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].cvias == 0 ? "" : arrayTabla[i].cvias}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].pizaje == 0 ? "" : arrayTabla[i].pizaje}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].agua == 0 ? "" : arrayTabla[i].agua}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].prevalidados == 0 ? "" : arrayTabla[i].prevalidados}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].pnuevos == 0 ? "" : arrayTabla[i].pnuevos}
                        </td>
                        <td style="text-align: center; width: 30px;">
                            ${arrayTabla[i].pcerrados == 0 ? "" : arrayTabla[i].pcerrados}
                        </td>
                        <td style="text-align: center;  width: 100px;">
                            ${arrayTabla[i].numpcerrado == 0 ? "" : arrayTabla[i].numpcerrado}
                        </td>
                        <td style="text-align: center;  width: 30px;">
                            ${arrayTabla[i].personas}
                        </td>
                        <td style="text-align: center;  width: 30px;">
                            ${arrayTabla[i].semana}
                        </td>
                        <td style="text-align: center;  width: 30px;">
                            ${arrayTabla[i].estado}
                        </td>
                    </tr>
                    `
                    }
                    $('#datostabla').html(html)
                    cargarGraficas()
                })
        }

        function cargarGraficas() {
            //GRAFICA PERMISOS DE TRABAJOS ELABORADOS 

            Highcharts.chart('figpermest', {
                colors: ['#1f4e78', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                credits: {
                    enabled: false
                },
                chart: {
                    type: 'column'
                },
                title: {
                    text: '<b>PERMISOS POR ESTADO</b>'
                },

                xAxis: {
                    categories: arrayFrentes,
                    crosshair: true,
                    labels: {
                        style: {
                            fontSize: '18px',
                        }
                    }
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: 'Cant',
                    },
                     
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                plotOptions: {
                    column: {
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                            style: {
                                fontWeight: 'bold',
                                fontSize: '24px'
                            }
                        }
                        
                     
                    }
                },
                series: [{
                    name: 'ABIERTOS',
                    data: arrayAbierto,
                    
                }, {
                    name: 'CERRADOS',
                    data: arrayCerrado
                }, {
                    name: 'NO EJECUTADOS',
                    data: arrayNoEje
                }, {
                    name: 'TOTAL',
                    data: arraytotalp
                }]
            });


            Highcharts.chart('figpertrabaesp2', {
                colors: ['#1f4e78', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                credits: {
                    enabled: false
                },
                chart: {
                    type: 'column'
                },
                title: {
                    text: '<b>PERMISOS REVALIDADOS POR CLASIFICACIÓN</b>'
                },

                xAxis: {
                    categories: arrayFrentes,
                    crosshair: true,
                    labels: {
                        style: {
                            fontSize: '18px',
                        }
                    }
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: 'Cant',
                    },
                     
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                plotOptions: {
                    column: {
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                            style: {
                                fontWeight: 'bold',
                                fontSize: '24px'
                            }
                        }
                        
                     
                    }
                },
                series: [{
                    name: 'P. FRÍO',
                    data: arrayPfrio,
                    
                }, {
                    name: 'P. CALIENTE',
                    data: arrayPcaliente
                }, {
                    name: 'P. ELÉCTRICO',
                    data: arrayPelectrico
                }, {
                    name: 'TOTAL',
                    data: arraytotalp
                }]
            });


            Highcharts.chart('figmatrizram', {
                colors: ['#00c901', '#1f4e78', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                credits: {
                    enabled: false
                },
                chart: {
                    type: 'column'
                },
                title: {
                    text: '<b>MATRIZ RAM PERMISOS REVALIDADOS</b>'
                },

                xAxis: {
                    categories: arrayFrentes,
                    crosshair: true
                },

                yAxis: {
                    min: 0,
                    title: {
                        text: 'Cant'
                    }
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                plotOptions: {
                    column: {
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                            style: {
                                fontWeight: 'bold',
                                fontSize: '24px'
                            }
                        }
                    }
                },
                series: [
                {
                    name: 'BAJO',
                    data: arrayMraml
                },
                {
                    name: 'MEDIO',
                    data: arrayMramm
                }, {
                    name: 'ALTO',
                    data: arrayMramh
                }, {
                    name: 'MUY ALTO',
                    data: arrayMramvh
                }, {
                    name: 'TOTAL',
                    data: arraytotalmatriz
                }]
            });


            // Highcharts.chart('figcertificados', {
            //     colors: ['#00c901', '#1f4e78', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
            //     credits: {
            //         enabled: false
            //     },
            //     chart: {
            //         type: 'column'
            //     },
            //     title: {
            //         text: '<b>CERTIFICADOS DE APOYO VIGENTES</b>'
            //     },

            //     xAxis: {
            //         categories: arrayFrentes,
            //         crosshair: true
            //     },

            //     yAxis: {
            //         min: 0,
            //         title: {
            //             text: 'Cant'
            //         }
            //     },
            //     tooltip: {
            //         headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            //         pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            //             '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
            //         footerFormat: '</table>',
            //         shared: true,
            //         useHTML: true
            //     },
            //     plotOptions: {
            //         column: {
            //             pointPadding: 0.2,
            //             borderWidth: 0,
            //             dataLabels: {
            //                 enabled: true,
            //                 style: {
            //                     fontWeight: 'bold',
            //                     fontSize: '24px'
            //                 }
            //             }
            //         }
            //     },
            //     series: [{
            //         name: 'CA 1',
            //         data: arrayCca1
            //     }, {
            //         name: 'CA 2',
            //         data: arrayCca2
            //     }, {
            //         name: 'CA 3',
            //         data: arrayCca3
            //     }, {
            //         name: 'CA 5',
            //         data: arrayCca5
            //     }, {
            //         name: 'CA 6',
            //         data: arrayCca6
            //     }, {
            //         name: 'CA 7',
            //         data: arrayCca7
            //     }, {
            //         name: 'SAS',
            //         data: arraySsas
            //     }, {
            //         name: 'SAES',
            //         data: arraySsaes
            //     }, {
            //         name: 'TOTAL',
            //         data: arraytotalca
            //     }]
            // });

            // Highcharts.chart('figcertificados2', {
            //     colors: ['#00c901', '#1f4e78', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
            //     credits: {
            //         enabled: false
            //     },
            //     chart: {
            //         type: 'column'
            //     },
            //     title: {
            //         text: '<b>CERTIFICADOS DE APOYO NUEVOS REALIZADOS</b>'
            //     },

            //     xAxis: {
            //         categories: arrayFrentes,
            //         crosshair: true
            //     },

            //     yAxis: {
            //         min: 0,
            //         title: {
            //             text: 'Cant'
            //         }
            //     },
            //     tooltip: {
            //         headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            //         pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            //             '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
            //         footerFormat: '</table>',
            //         shared: true,
            //         useHTML: true
            //     },
            //     plotOptions: {
            //         column: {
            //             pointPadding: 0.2,
            //             borderWidth: 0,
            //             dataLabels: {
            //                 enabled: true,
            //                 style: {
            //                     fontWeight: 'bold',
            //                     fontSize: '24px'
            //                 }
            //             }
            //         }
            //     },
            //     series: [{
            //         name: 'CA 1',
            //         data: arrayCca1n
            //     }, {
            //         name: 'CA 2',
            //         data: arrayCca2n
            //     }, {
            //         name: 'CA 3',
            //         data: arrayCca3n
            //     }, {
            //         name: 'CA 5',
            //         data: arrayCca5n
            //     }, {
            //         name: 'CA 6',
            //         data: arrayCca6n
            //     }, {
            //         name: 'CA 7',
            //         data: arrayCca7n
            //     }, {
            //         name: 'SAS',
            //         data: arraySsasn
            //     }, {
            //         name: 'SAES',
            //         data: arraySsaesn
            //     }, {
            //         name: 'TOTAL',
            //         data: arraytotalcan
            //     }]
            // });

           
           
           
           
            // Highcharts.chart('figrescate', {
            //     colors: ['#1f4e78', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
            //     credits: {
            //         enabled: false
            //     },
            //     chart: {
            //         type: 'column'
            //     },
            //     title: {
            //         text: '<b>PROCEDIMIENTOS DE RESCATE VIGENTES</b>'
            //     },

            //     xAxis: {
            //         categories: arrayFrentes,
            //         crosshair: true
            //     },

            //     yAxis: {
            //         min: 0,
            //         title: {
            //             text: 'Cant'
            //         }
            //     },
            //     tooltip: {
            //         headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            //         pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            //             '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
            //         footerFormat: '</table>',
            //         shared: true,
            //         useHTML: true
            //     },
            //     plotOptions: {
            //         column: {
            //             pointPadding: 0.2,
            //             borderWidth: 0,
            //             dataLabels: {
            //                 enabled: true,
            //                 style: {
            //                     fontWeight: 'bold',
            //                     fontSize: '24px'
            //                 }
            //             }
            //         }
            //     },
            //     series: [{
            //         name: 'ALTURAS',
            //         data: arrayPpra
            //     }, {
            //         name: 'ESP. CONFINADOS',
            //         data: arrayPprc
            //     }, {
            //         name: 'GASES TOXICOS',
            //         data: arrayPprg
            //     }, {
            //         name: 'TOTAL',
            //         data: arraytotalpr
            //     }]
            // });

            // Highcharts.chart('figrescate2', {
            //     colors: ['#1f4e78', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
            //     credits: {
            //         enabled: false
            //     },
            //     chart: {
            //         type: 'column'
            //     },
            //     title: {
            //         text: '<b>PROCEDIMIENTOS DE RESCATE NUEVOS REALIZADOS</b>'
            //     },

            //     xAxis: {
            //         categories: arrayFrentes,
            //         crosshair: true
            //     },

            //     yAxis: {
            //         min: 0,
            //         title: {
            //             text: 'Cant'
            //         }
            //     },
            //     tooltip: {
            //         headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            //         pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            //             '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
            //         footerFormat: '</table>',
            //         shared: true,
            //         useHTML: true
            //     },
            //     plotOptions: {
            //         column: {
            //             pointPadding: 0.2,
            //             borderWidth: 0,
            //             dataLabels: {
            //                 enabled: true,
            //                 style: {
            //                     fontWeight: 'bold',
            //                     fontSize: '24px'
            //                 }
            //             }
            //         }
            //     },
            //     series: [{
            //         name: 'ALTURAS',
            //         data: arrayPpran
            //     }, {
            //         name: 'ESP. CONFINADOS',
            //         data: arrayPprcn
            //     }, {
            //         name: 'GASES TOXICOS',
            //         data: arrayPprgn
            //     }, {
            //         name: 'TOTAL',
            //         data: arraytotalprn
            //     }]
            // });

            
            
            // Highcharts.chart('figpermisos', {
            //     colors: ['#1f4e78', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
            //     credits: {
            //         enabled: false
            //     },
            //     chart: {
            //         type: 'column'
            //     },
            //     title: {
            //         text: '<b>CONTROL DE PERMISOS DIARIOS</b>'
            //     },

            //     xAxis: {
            //         categories: arrayFrentes,
            //         crosshair: true
            //     },

            //     yAxis: {
            //         min: 0,
            //         title: {
            //             text: 'Cant'
            //         }
            //     },
            //     tooltip: {
            //         headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            //         pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            //             '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
            //         footerFormat: '</table>',
            //         shared: true,
            //         useHTML: true
            //     },
            //     plotOptions: {
            //         column: {
            //             pointPadding: 0.2,
            //             borderWidth: 0,
            //             dataLabels: {
            //                 enabled: true,
            //                 style: {
            //                     fontWeight: 'bold',
            //                     fontSize: '24px'
            //                 }
            //             }
            //         }
            //     },
            //     series: [{
            //         name: 'P. NUEVOS',
            //         data: arrayPpnuevos
            //     }, {
            //         name: 'P. REVALIDADOS',
            //         data: arrayPprevalidados
            //     }, {
            //         name: 'P. CERRADOS',
            //         data: arrayPpcerrados
            //     }]
            // });


            // Highcharts.setOptions({
            //     colors: Highcharts.map(Highcharts.getOptions().colors, function (color) {
            //         return {
            //             radialGradient: {
            //                 cx: 0.5,
            //                 cy: 0.3,
            //                 r: 0.7
            //             },
            //             stops: [
            //                 [0, color],
            //                 [1, Highcharts.color(color).brighten(-0.3).get('rgb')] // darken
            //             ]
            //         };
            //     })
            // });

            // Highcharts.chart('figpermisos', {
            //     colors: ['#1f4e78', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639','#537b35', '#a4c639', '#537b35'],
            //     credits: {
            //         enabled: false
            //     },
            //     chart: {
            //         plotBackgroundColor: null,
            //         plotBorderWidth: null,
            //         plotShadow: false,
            //         type: 'pie'
            //     },
            //     title: {
            //         text: '<b>CONTROL DE PERMISOS DIARIOS</b>'
            //     },

            //     xAxis: {
            //         categories: arrayTurnos,
            //         crosshair: true
            //     },
            //     yAxis: {
            //         min: 0,
            //         title: {
            //         text: 'Cant'
            //         }
            //     },
            //     tooltip: {

            //         headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            //         pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            //         '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
            //         footerFormat: '</table>',
            //         shared: true,
            //         useHTML: true
            //     },
            //     plotOptions: {
            //         pie: {
            //             allowPointSelect: true,
            //             cursor: 'pointer',
            //             dataLabels: {
            //                 enabled: true,
            //                 format: '<b>{point.name}</b>: {point.y:f}',
            //                 connectorColor: 'silver'
            //             }
            //         }
            //     },
            //     series: [{
            //         name: 'CANT',
            //             data: [
            //                 { name: 'P. NUEVOS', y: arrayPpnuevos },
            //                 { name: 'P. REVALIDADOS', y: arrayPprevalidados },
            //                 { name: 'P. CERRADOS', y: arrayPpcerrados }
            //             ]
            //         }
            //     ]
            // });


        }
    
        function verDetalles() {
            if (vista == 0) {
                vista = 1
                $('#detalles').removeClass('oculto');
                $('#detalles').addClass('visible');
                $('#btnvista').html('Ocultar Detalles')
            } else {
                vista = 0
                $('#detalles').removeClass('visible');
                $('#detalles').addClass('oculto');
                $('#btnvista').html('Ver Detalles')
            }
        }
    </script>
</body>

</html>
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administración Dashboard HSE</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">

    <!-- datatables -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.6.2/css/buttons.dataTables.min.css">
    <!-- datatables -->

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous">

    <style>
        .botones {
            box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
        }
        
        .botones:hover {
            box-shadow: rgba(0, 0, 0, 0.25) 0px 54px 55px, rgba(0, 0, 0, 0.12) 0px -12px 30px, rgba(0, 0, 0, 0.12) 0px 4px 6px, rgba(0, 0, 0, 0.17) 0px 12px 13px, rgba(0, 0, 0, 0.09) 0px -3px 5px;
        }
    </style>

</head>

<body>

    <div class="container">
        <div class="jumbotron">
            <img src="img/logo_m.png" height="80px" a lt="">
            <h2>Boletines HSE!</h2>

        </div>
        <div class="contenido">

        </div>
    </div>

    <footer>
        <div class="container">
            <hr>
            <a href="compendio.pdf" target="_blank">
                <img src="img/compendio.PNG" class="botones" height="220px" alt="">
            </a>
            <p class="text-center" style="font-weight: bold;">

            </p>
        </div>
    </footer>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2" crossorigin="anonymous"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!--  DataTables.net Plugin, full documentation here: https://datatables.net/  -->
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.7.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.7.1/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.7.1/js/buttons.print.min.js"></script>


    <script>
        var user = null
        var server = 'https://utitalco.com/hse/server/'
        var arrayDatosHse = []
        var arrayDatosPermisos = []
        var recargarhse = null
        var recargarpermiso = null




        function cargarTablas() {
            var html = ''
            for (var i = 0; i < arrayDatosHse.length; i++) {
                html += `
                <tr>
                    <td>${arrayDatosHse[i].nombres}</td>
                    <td>${arrayDatosHse[i].cargo}</td>
                    <td>${arrayDatosHse[i].email}</td>
                    <td>${arrayDatosHse[i].numods}</td>
                    <td>${arrayDatosHse[i].ods}</td>
                    <td>${arrayDatosHse[i].fase}</td>
                    <td>${arrayDatosHse[i].odsant}</td>
                    <td>
                        <div class="btn-group" role="group" aria-label="Basic example">
                            <button type="button" class="btn btn-warning" onclick="editarHse(${i})"><i class="fas fa-edit"></i></button>
                            <button type="button" class="btn btn-danger" onclick="borrarHse(${i})"><i class="fas fa-trash"></i></button>
                        </div>
                    </td>
                </tr>
                `
            }
            $('#datosTablaHse').html(html)

            if (recargarhse == null) {

                $('#tblData1').DataTable({
                    "language": {
                        "url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Spanish.json"
                    },
                    dom: 'Bfrtip',
                    buttons: [
                        'copyHtml5',
                        'excelHtml5',
                        'csvHtml5',
                        'pdfHtml5'
                    ]
                });
                recargarhse = 0;
            }
            var html = ''
            for (var i = 0; i < arrayDatosPermisos.length; i++) {
                html += `
                <tr>
                    <td>${arrayDatosPermisos[i].nombres}</td>
                    <td>${arrayDatosPermisos[i].cargo}</td>
                    <td>${arrayDatosPermisos[i].email}</td>
                    <td>${arrayDatosPermisos[i].numods}</td>
                    <td>${arrayDatosPermisos[i].ods}</td>
                    <td>${arrayDatosPermisos[i].fase}</td>
                    <td>${arrayDatosPermisos[i].odsant}</td>
                    <td>
                        <div class="btn-group" role="group" aria-label="Basic example">
                            <button type="button" class="btn btn-warning" onclick="editarPermisos(${i})"><i class="fas fa-edit"></i></button>
                            <button type="button" class="btn btn-danger" onclick="borrarPermisos(${i})"><i class="fas fa-trash"></i></button>
                        </div>
                    </td>
                </tr>
                `
            }
            $('#datosTablaPermisos').html(html)
            if (recargarpermiso == null) {
                $('#tblData2').DataTable({
                    "language": {
                        "url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Spanish.json"
                    },
                    dom: 'Bfrtip',
                    buttons: [
                        'copyHtml5',
                        'excelHtml5',
                        'csvHtml5',
                        'pdfHtml5'
                    ]
                });
                recargarpermiso = 0

            }
        }

        function nuevoHse() {

            Swal.fire({
                title: 'Registro Usuario HSE',
                html: `
                <input type="text" id="nombres" class="form-control" placeholder="Nombres">
                <input type="text" id="cargo" class="form-control" placeholder="Cargo">
                <input type="email" id="email" class="form-control" placeholder="Email">
                <input type="text" id="clave" class="form-control" placeholder="Contraseña">
                <input type="text" id="numods" class="form-control" placeholder="# ODS">
                <input type="text" id="ods" class="form-control" placeholder="Nombre ODS">
                <input type="text" id="fase" class="form-control" placeholder="Fase">
                <input type="text" id="odsant" class="form-control" placeholder="ODS Anterior">
                `,
                showCancelButton: true,
                confirmButtonText: 'Guardar',
                cancelButtonText: 'Cancelar',
                allowOutsideClick: false,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33'
            }).then((result) => {
                /* Read more about isConfirmed, isDenied below */
                if (result.isConfirmed) {
                    var nombres = $('#nombres').val()
                    var cargo = $('#cargo').val()
                    var email = $('#email').val()
                    var clave = $('#clave').val()
                    var numods = $('#numods').val()
                    var ods = $('#ods').val()
                    var fase = $('#fase').val()
                    var odsant = $('#odsant').val()

                    $.post(server + 'guardarUsuarioHse.php', {
                            nombres: nombres,
                            cargo: cargo,
                            email: email,
                            clave: clave,
                            numods: numods,
                            ods: ods,
                            fase: fase,
                            odsant: odsant
                        },
                        function(resp) {
                            Swal.fire({
                                position: 'top-end',
                                icon: 'success',
                                title: 'Registro completo',
                                showConfirmButton: false,
                                timer: 1500
                            }).then(() => {
                                cargarDatos()
                            })
                        })
                }
            })

        }

        function nuevoPermiso() {

            Swal.fire({
                title: 'Registro Usuario de Permisos',
                html: `
                <input type="text" id="nombres" class="form-control" placeholder="Nombres">
                <input type="text" id="cargo" class="form-control" placeholder="Cargo">
                <input type="email" id="email" class="form-control" placeholder="Email">
                <input type="text" id="clave" class="form-control" placeholder="Contraseña">
                <input type="text" id="numods" class="form-control" placeholder="# ODS">
                <input type="text" id="ods" class="form-control" placeholder="Nombre ODS">
                <input type="text" id="fase" class="form-control" placeholder="Fase">
                <input type="text" id="odsant" class="form-control" placeholder="ODS Anterior">
                `,
                showCancelButton: true,
                confirmButtonText: 'Guardar',
                cancelButtonText: 'Cancelar',
                allowOutsideClick: false,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33'
            }).then((result) => {
                /* Read more about isConfirmed, isDenied below */
                if (result.isConfirmed) {
                    var nombres = $('#nombres').val()
                    var cargo = $('#cargo').val()
                    var email = $('#email').val()
                    var clave = $('#clave').val()
                    var numods = $('#numods').val()
                    var ods = $('#ods').val()
                    var fase = $('#fase').val()
                    var odsant = $('#odsant').val()

                    $.post(server + 'guardarUsuarioPermiso.php', {
                            nombres: nombres,
                            cargo: cargo,
                            email: email,
                            clave: clave,
                            numods: numods,
                            ods: ods,
                            fase: fase,
                            odsant: odsant
                        },
                        function(resp) {
                            Swal.fire({
                                position: 'top-end',
                                icon: 'success',
                                title: 'Registro completo',
                                showConfirmButton: false,
                                timer: 1500
                            }).then(() => {
                                cargarDatos()
                            })
                        })
                }
            })

        }

        function borrarHse(i) {
            Swal.fire({
                title: 'Eliminar datos',
                html: `
                ¿Desea eliminar los datos de ${arrayDatosHse[i].nombres}?
                `,
                showCancelButton: true,
                confirmButtonText: 'Sí',
                cancelButtonText: 'No',
                allowOutsideClick: false,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33'
            }).then((result) => {
                /* Read more about isConfirmed, isDenied below */
                if (result.isConfirmed) {
                    var id = arrayDatosHse[i].id
                    $.post(server + 'borrarUsuarioHse.php', {
                            id: id
                        },
                        function(resp) {
                            Swal.fire({
                                position: 'top-end',
                                icon: 'success',
                                title: 'Datos de usuario eliminados',
                                showConfirmButton: false,
                                timer: 1500
                            })
                            location.reload()
                        })

                }
            })
        }


        function borrarPermisos(i) {
            Swal.fire({
                title: 'Eliminar datos',
                html: `
                ¿Desea eliminar los datos de ${arrayDatosPermisos[i].nombres}?
                `,
                showCancelButton: true,
                confirmButtonText: 'Sí',
                cancelButtonText: 'No',
                allowOutsideClick: false,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33'
            }).then((result) => {
                /* Read more about isConfirmed, isDenied below */
                if (result.isConfirmed) {
                    var id = arrayDatosPermisos[i].id
                    $.post(server + 'borrarUsuarioPermisos.php', {
                            id: id
                        },
                        function(resp) {
                            Swal.fire({
                                position: 'top-end',
                                icon: 'success',
                                title: 'Datos de usuario eliminados',
                                showConfirmButton: false,
                                timer: 1500
                            })
                            location.reload()
                        })

                }
            })
        }

        function editarHse(i) {

            Swal.fire({
                title: 'Editar datos de Usuario HSE',
                html: `
                <input type="text" id="nombres" class="form-control" placeholder="Nombres" value="${arrayDatosHse[i].nombres}">
                <input type="text" id="cargo" class="form-control" placeholder="Cargo" value="${arrayDatosHse[i].cargo}">
                <input type="email" id="email" class="form-control" placeholder="Email" value="${arrayDatosHse[i].email}">
                <input type="text" id="clave" class="form-control" placeholder="Contraseña" value="${arrayDatosHse[i].clave}">
                <input type="text" id="numods" class="form-control" placeholder="# ODS" value="${arrayDatosHse[i].numods}">
                <input type="text" id="ods" class="form-control" placeholder="Nombre ODS" value="${arrayDatosHse[i].ods}">
                <input type="text" id="fase" class="form-control" placeholder="Fase" value="${arrayDatosHse[i].fase}">
                <input type="text" id="odsant" class="form-control" placeholder="ODS Anterior" value="${arrayDatosHse[i].odsant}">
                `,
                showCancelButton: true,
                confirmButtonText: 'Actualizar',
                cancelButtonText: 'Cancelar',
                allowOutsideClick: false,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33'
            }).then((result) => {
                /* Read more about isConfirmed, isDenied below */
                if (result.isConfirmed) {
                    var nombres = $('#nombres').val()
                    var cargo = $('#cargo').val()
                    var email = $('#email').val()
                    var clave = $('#clave').val()
                    var numods = $('#numods').val()
                    var ods = $('#ods').val()
                    var fase = $('#fase').val()
                    var odsant = $('#odsant').val()
                    var id = arrayDatosHse[i].id

                    $.post(server + 'actUsuarioHse.php', {
                            nombres: nombres,
                            cargo: cargo,
                            email: email,
                            clave: clave,
                            numods: numods,
                            ods: ods,
                            fase: fase,
                            odsant: odsant,
                            id: id
                        },
                        function(resp) {
                            Swal.fire({
                                position: 'top-end',
                                icon: 'success',
                                title: 'Registro actualizado...',
                                showConfirmButton: false,
                                timer: 1500
                            }).then(() => {
                                cargarDatos()
                            })
                        })
                }
            })

        }

        function editarPermisos(i) {

            Swal.fire({
                title: 'Editar datos de Usuario Permisos',
                html: `
                <input type="text" id="nombres" class="form-control" placeholder="Nombres" value="${arrayDatosPermisos[i].nombres}">
                <input type="text" id="cargo" class="form-control" placeholder="Cargo" value="${arrayDatosPermisos[i].cargo}">
                <input type="email" id="email" class="form-control" placeholder="Email" value="${arrayDatosPermisos[i].email}">
                <input type="text" id="clave" class="form-control" placeholder="Contraseña" value="${arrayDatosPermisos[i].clave}">
                <input type="text" id="numods" class="form-control" placeholder="# ODS" value="${arrayDatosPermisos[i].numods}">
                <input type="text" id="ods" class="form-control" placeholder="Nombre ODS" value="${arrayDatosPermisos[i].ods}">
                <input type="text" id="fase" class="form-control" placeholder="Fase" value="${arrayDatosPermisos[i].fase}">
                <input type="text" id="odsant" class="form-control" placeholder="ODS Anterior" value="${arrayDatosPermisos[i].odsant}">
                `,
                showCancelButton: true,
                confirmButtonText: 'Actualizar',
                cancelButtonText: 'Cancelar',
                allowOutsideClick: false,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33'
            }).then((result) => {
                /* Read more about isConfirmed, isDenied below */
                if (result.isConfirmed) {
                    var nombres = $('#nombres').val()
                    var cargo = $('#cargo').val()
                    var email = $('#email').val()
                    var clave = $('#clave').val()
                    var numods = $('#numods').val()
                    var ods = $('#ods').val()
                    var fase = $('#fase').val()
                    var odsant = $('#odsant').val()
                    var id = arrayDatosPermisos[i].id

                    $.post(server + 'actUsuarioPermisos.php', {
                            nombres: nombres,
                            cargo: cargo,
                            email: email,
                            clave: clave,
                            numods: numods,
                            ods: ods,
                            fase: fase,
                            odsant: odsant,
                            id: id
                        },
                        function(resp) {
                            Swal.fire({
                                position: 'top-end',
                                icon: 'success',
                                title: 'Registro actualizado...',
                                showConfirmButton: false,
                                timer: 1500
                            }).then(() => {
                                cargarDatos()
                            })
                        })
                }
            })

        }
    </script>

</body>

</html>
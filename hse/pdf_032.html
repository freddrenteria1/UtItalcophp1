<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INFORME DIARIO DE GESTIÓN HSE - UT ITALCO </title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">

    <script type="text/javascript" src="https://code.highcharts.com/highcharts.js"></script>
    <!--<link rel="stylesheet" href="https://code.highcharts.com/css/themes/dark-unica.css"> -->
    <script src="https://code.highcharts.com/highcharts-3d.js"></script>
    <script src="https://code.highcharts.com/modules/cylinder.js"></script>
    <script src="https://code.highcharts.com/modules/funnel3d.js"></script>
    <script src="https://code.highcharts.com/modules/pyramid3d.js"></script>
    <!-- <script src="https://code.highcharts.com/modules/exporting.js"></script>
	<script src="https://code.highcharts.com/modules/export-data.js"></script>
	<script src="https://code.highcharts.com/modules/accessibility.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.2.61/jspdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.svg.js"></script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/amstockchart/3.13.0/exporting/canvg.js"></script>
    <script type="text/javascript" src="https://unpkg.com/stackblur-canvas@2.3.0/dist/stackblur.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highstock/6.0.3/lib/rgbcolor.js"></script>

    <style>
        /* estilos de pagina */
        
        @import url('https://fonts.googleapis.com/css2?family=Oswald&display=swap');
        #piramide {
            font-family: 'Oswald', sans-serif;
        }

        
        #figpiramide{
            width: 700px;
            height: 550px;
            background-image: url("informes/img/piramide_1.jpg");
            position: relative;
            background-repeat: no-repeat;
            margin: 0 auto;
            
        }
        #fatal{
            position: absolute;
            top: 55px;
            left: 230px;
            width: 35px;
            height: 35px;
            text-align: center;
            color: #FFF;
            font-weight: bold;
            font-size: large;
            text-shadow: 1px 1px 2px #181717;
            
        }
        #les{
            position: absolute;
            top: 120px;
            left: 230px;
            width: 35px;
            height: 35px;
            text-align: center;
            color: #FFF;
            font-weight: bold;
            font-size: large;
            text-shadow: 1px 1px 2px #181717;
        }

        #trtm{
            position: absolute;
            top: 180px;
            left: 230px;
            width: 35px;
            height: 35px;
            text-align: center;
            color: #FFF;
            font-weight: bold;
            font-size: large;
            text-shadow: 1px 1px 2px #181717;
        }

        #praux{
            position: absolute;
            top: 240px;
            left: 230px;
            width: 35px;
            height: 35px;
            text-align: center;
            color: #FFF;
            font-weight: bold;
            font-size: large;
            text-shadow: 1px 1px 2px #181717;
        }
        
        #cantcasiaccidentes{
            position: absolute;
            top: 305px;
            left: 230px;
            width: 35px;
            height: 50px;
            text-align: center;
            color: #FFF;
            font-weight: bold;
            font-size: large;
            text-shadow: 1px 1px 2px #181717;
        }

        

        #canthallazgos{
            position: absolute;
            top: 365px;
            left: 230px;
            width: 35px;
            height: 35px;
            text-align: center;
            color: #FFF;
            font-weight: bold;
            font-size: large;
            text-shadow: 1px 1px 2px #181717;
        }

        #phall2{
            position: absolute;
            top: 300px;
            left: 410px;
            width: 235px;
            height: 35px;
            text-align: center;
            color: #FFF;
            font-weight: bold;
            font-size: large;
            text-shadow: 1px 1px 2px #181717;
        }

        #phall{
            position: absolute;
            top: 365px;
            left: 410px;
            width: 235px;
            height: 35px;
            text-align: center;
            color: #FFF;
            font-weight: bold;
            font-size: large;
            text-shadow: 1px 1px 2px #181717;
        }

      

        #cantAC{
            position: absolute;
            top: 422px;
            left: 230px;
            width: 55px;
            height: 35px;
            text-align: center;
            color: #FFF;
            font-weight: bold;
            font-size: large;
        }

        .tabtit{
            background-color: #80af23;
            color: black;
        }

        
        body,
        html {
            height: 100%;
            width: 100%;
        }
        
        .cuerpo {
            width: 90%;
            height: 100%;
            margin: 0 auto;
        }
        
        .salto {
            PAGE-BREAK-AFTER: always;
        }
        
        .cab {
            background-color: #01005e;
            width: 100%;
            height: 80px;
            color: white;
        }
        
        .titfecha {
            padding: 5px;
            border-style: solid;
            border-color: white;
            border-width: 0.7px;
            border-radius: 5px;
            text-align: center;
        }
        
        .central {
            height: 507px;
            width: 100%;
        }
        
        .oculto {
            display: none;
        }
        
        .diap {
            position: fixed;
            top: 80px;
            left: 0px;
            height: 500px;
            width: 100%;
            padding-left: 130px;
            padding-right: 130px;
            padding-top: 10px;
            display: table;
        }
        
        .anchomedio {
            width: 600px;
            left: 300px;
            height: 400px;
            margin: 0 auto;
        }
        
        #inicio {
            margin-top: 10px;
            margin-left: 50px;
            cursor: pointer;
            z-index: 999;
            position: absolute;
        }
        
        #sig {
            margin-top: 10px;
            right: 50px;
            cursor: pointer;
            z-index: 999;
            position: absolute;
        }
        
        #atraspiramide {
            margin-top: 10px;
            right: 50px;
            cursor: pointer;
            z-index: 999;
            position: absolute;
        }
        
        .footer {
            background-color: #b9d204;
            width: 100%;
            padding: 5px;
            text-align: center;
            position: fixed;
            bottom: 0px;
        }
        
        #divhidden {
            display: none;
        }
        /* fin estilos de pagina */
        /* estilos del menu */
        
        #mnu {
            width: 707px;
            height: 500px;
            background-image: url('img/mnu_1.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
            z-index: 999;
        }
        
        .mnu1 {
            position: relative;
            top: 50px;
            left: 390px;
            width: 120px;
            height: 65px;
            padding: 10px;
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
            font-weight: bold;
            font-size: 16px;
            text-align: center;
            cursor: pointer;
        }
        
        .mnu2 {
            position: relative;
            top: 103px;
            left: 480px;
            width: 120px;
            height: 65px;
            padding: 10px;
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
            font-weight: bold;
            font-size: 16px;
            text-align: center;
            cursor: pointer;
        }
        
        .mnu3 {
            position: relative;
            top: 158px;
            left: 485px;
            width: 120px;
            height: 65px;
            padding: 10px;
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
            font-weight: bold;
            font-size: 15px;
            text-align: center;
            cursor: pointer;
        }
        
        .mnu4 {
            position: relative;
            top: 213px;
            left: 384px;
            width: 120px;
            height: 65px;
            padding: 10px;
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
            font-weight: bold;
            font-size: 16px;
            text-align: center;
            cursor: pointer;
        }
        /* fin estilo de menu */
        /* estilo de graficas */
        
        .colpir {
            text-align: center;
            font-size: 10px;
            width: 100px;
            border-style: solid;
            border-width: 1px;
            border-color: #000000;
            color: black;
        }
        
        .filapir {
            background-color: #00c901;
            color: white;
        }
        
        .filatit {
            border-style: solid;
            border-width: 1px;
            border-color: #80af23;
        }
        
        .cabtit {
            text-align: center;
            font-size: 14px;
            width: 100px;
            border-style: solid;
            border-width: 1px;
            border-color: #01005e;
            background-color: white;
        }
        
        .card-header {
            background-color: #01005e;
            color: white;
        }
        
        .oculto {
            display: none;
        }
        
        .visible {
            display: contents;
        }
        
        #galeria {
            height: 400px;
            width: 400px;
            position: absolute;
            top: 0px;
            left: 20px;
            z-index: 999;
            overflow: hidden;
        }
        
        .imagen:hover {
            filter: opacity(.5);
        }
        
        #grafpiramide {
            width: 40%;
            height: 500px;
            margin: 0 auto;
            background-image: url('img/piramide_4.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }
        
        .fig1 {
            width: 131px;
            height: 170px;
            background-image: url('img/infogvr1.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
            float: left;
        }
        
        #fig2 {
            width: 131px;
            height: 170px;
            background-image: url('img/infog2.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
            float: left;
        }
        
        #fig3 {
            width: 131px;
            height: 170px;
            background-image: url('img/infog3.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
            float: left;
        }
        
        #infoverde1 {
            width: 200px;
            height: 200px;
            background-image: url('img/infogv1.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }
        
        #infoverde2 {
            width: 200px;
            height: 200px;
            background-image: url('img/infogv2.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }
        
        #inforojo {
            width: 200px;
            height: 200px;
            background-image: url('img/infog4.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }
        
        .textopira {
            display: table-cell;
            vertical-align: middle;
        }
        
        .hijo {
            display: table-cell;
            vertical-align: middle;
        }
        
        .padre {
            display: table;
        }
        
        .titinfovr {
            width: 100%;
            height: 29.41%;
            font-size: 14px;
            text-align: center;
        }
        
        .cifrainfovr {
            width: 100%;
            height: 70.59%;
            font-size: 44px;
            text-align: center;
        }
        
        #piso7 {
            width: 100%;
            height: 13.60%;
            display: table;
        }
        
        #piso6 {
            width: 100%;
            height: 10.39%;
            display: table;
        }
        
        #piso5 {
            width: 100%;
            height: 10.39%;
            display: table;
        }
        
        #piso4 {
            width: 100%;
            height: 10.39%;
            display: table;
        }
        
        #piso3 {
            width: 100%;
            height: 13.86%;
            display: table;
        }
        
        #piso2 {
            width: 100%;
            height: 13.86%;
            display: table;
        }
        
        #piso1 {
            width: 100%;
            height: 13.86%;
            display: table;
        }
        
        .tacomoda {
            width: 5%;
        }
        
        #flotante {
            height: 400px;
            width: 500px;
            position: absolute;
            left: 20px;
            top: 60px;
            z-index: 999;
        }
        
        #flotantefoto {
            height: 400px;
            width: 400px;
            position: absolute;
            left: 20px;
            top: 60px;
            z-index: 999;
        }
        
        .manito {
            cursor: pointer;
        }
        
        .titregfot {
            width: 100%;
            height: 50px;
            ;
            background-color: #01005e;
            color: white;
            padding: 10px;
            float: left;
            margin-top: 20px;
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        .titflot {
            background-color: rgb(255, 187, 0);
            color: rgba(20, 19, 19, 0.9);
            padding: 5px;
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
            font-size: 13px;
        }
        
        #regfotos {
            overflow-y: scroll;
            overflow-x: hidden;
            white-space: nowrap;
            position: fixed;
            top: 80px;
            left: 0px;
            height: 500px;
            width: 100%;
            padding-left: 130px;
            padding-right: 130px;
            padding-top: 10px;
        }
        
        .foto {
            width: 320px;
            height: 300px;
            padding: 10px;
            float: left;
        }
        
        .fotogal {
            width: 320px;
            height: 300px;
            padding: 10px;
            float: left;
        }
        
        .piefoto {
            background-color: #01005e;
            color: white;
            padding: 5px;
            height: 60px;
            width: 100%;
            text-align: center;
            width: 100%;
            word-wrap: break-word;
            font-size: 13px;
        }
        
        .titcatfotos {
            font-size: 16px;
            width: 90%;
            height: 40px;
            padding: 8px;
            margin-top: 20px;
            background-color: #01005e;
            color: white;
            float: left;
        }
        
        @media (max-width: 600px) {
            .foto {
                width: 90%;
                height: 90%;
            }
            #grafpiramide {
                width: 100%;
                height: 400px;
            }
            .tacomoda {
                width: 0%;
            }
        }
        /* fin estilo de graficas */
    </style>

    <style>
        .figuraspareto {
            width: 50%;
            float: left;
            height: auto;
        }
        
        .clear {
            clear: both;
        }
    </style>
</head>

<body>

    <!-- INICIO CABECERA -->
    <div class="cab">
        <div class="container">
            <table>
                <tr>
                    <td style="width: 20%; padding: 10px;">
                        <img src="img/logo_m.png" width="200px" alt="">
                    </td>
                    <td style="width: 60%; padding: 10px;">
                        <h4 style="color: white;">INFORME DIARIO DE GESTIÓN HSE</h4>
                        <h6 style="color: white;" id="ods">
                        </h6>
                    </td>
                    <td style="width: 20%; padding: 10px;">
                        <h6 class="titfecha" style="color: white;" id="fechainforme">2021-00-00 </h6>
                    </td>
                </tr>
            </table>



        </div>
    </div>
    <!-- <button type="button" class="btn btn-primary btn-sm" onclick="imprimir()">IMP</button> -->
    <!-- FIN CABECERA -->

    <div class="cuerpo" id="contenido">



        <!-- inicio piramide -->

        <div id="piramide">

            <div class="mt-3">

                <div class="card p-2 mt-5 cuadro-p animate__bounceIn" id="piramide" >

                    <div class="card-header fazul mb-0">
                        <h4>
                            Pirámide de seguridad
                            <span class="float-right rojo" onClick="cerrarTodo()"></span>
                        </h4>
                    </div>
        
                    <div id="figpiramide">
                        <div id="fatal">
                            0
                        </div>
                        <div id="les">
                            0
                        </div>
        
                        <div id="trtm">
                            0
                        </div>
        
                        <div id="praux">
                            0
                        </div>
        
                        <div id="cantcasiaccidentes">
                            0-0
                        </div>
        
                        <div id="canthallazgos">
                            0
                        </div>
        
                        <div id="cantAC">
                            0
                        </div>

                        <div id="phall2">
                    
                            <span id="porcgestionInci"></span> gestión
                        
                        </div>
        
                        <div id="phall">
                            
                                <span id="porcgestion">0</span> gestión de Hallazgos
                            
                        </div>
                    </div>
        
                    <div style="width: 800px; margin: 0 auto;">
                        <table class="table table-striped table-bordered">
                            <tr>
                                <td class="tabtit">CONV. VISIBLES</td>
                                <td align="center"> <span id="cantCV">0</span></td>
                                <td class="tabtit">EVAL SAS</td>
                                <td align="center"> <span id="evasas"></span>%</td>
                                <td class="tabtit">CANT AUDITORIAS</td>
                                <td align="center"><span id="cantaudi">0</span></td>
                            </tr>
                        </table>
                    </div>
        
                </div>

            </div>


        </div>

        <div class="card-header mb-2">
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#acordACRev" aria-expanded="false" aria-controls="acordACRev">
                <i class="fas fa-arrow-circle-down"></i>
            </button> ASEGURAMIENTOS DE COMPORTAMIENTOS
            <button type="button" class="btn btn-warning" onclick="segurosAC()">
                AC Seguros
            </button>
        </div>

        <div class="" id="acordACRev">
            <div id="figactot">

            </div>
        </div>

        <div class="col-sm-12">
            <div class="card">
                <div class="card-header" style="background-color: #01005e;">
                    CONSOLIDADO CRONOGRAMA DE AC


                </div>
                <div class="card-body ">
                    <div class="row">
                        <div class="col-sm-12">
                            <div id="figcronoac">

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>


        <div class="card-header mb-2">
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#acordACRiesgo" aria-expanded="false" aria-controls="acordACRiesgo">
                <i class="fas fa-arrow-circle-down"></i>
            </button> ASEGURAMIENTOS DE COMPORTAMIENTOS POR MEJORAR
            <button type="button" class="btn btn-warning" onclick="planesAC()">
                AC Por Mejorar
            </button>
        </div>
        <div class="" id="acordACRiesgo">

            <div class="row">
                <div class="col-sm-12">
                    <div id="figacriesgoitalco">

                    </div>
                </div>

            </div>
        </div>

        <div class="card-header mb-2">
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#acordACRiesgo" aria-expanded="false" aria-controls="acordACRiesgo">
                <i class="fas fa-arrow-circle-down"></i>
            </button> ASEGURAMIENTOS DE COMPORTAMIENTOS POR MEJORAR POR ORIGEN DE REPORTE
             
        </div>
        <div class="" id="acordACRiesgo">

            <div class="row">
                <div class="col-sm-12">
                    <div id="figacriesgoitalco2">

                    </div>
                </div>

            </div>
        </div>



        <div class="card-header mb-2">
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#acordTipi" aria-expanded="false" aria-controls="acordTipi">
                <i class="fas fa-arrow-circle-down"></i>
            </button> TIPIFICACIÓN AC
        </div>

        <div class="" id="acordTipi">
            <div class="card-body">
                <div id="figactipi">

                </div>
            </div>
            <div>
                <div class="figuraspareto">
                    <div id="figtipacrsi" class="m-2">
                        a
                    </div>
                </div>

                <div class="figuraspareto">
                    <div id="figtipacrsi2" class="m-2">
                        a
                    </div>
                </div>
                <div class="figuraspareto">
                    <div id="figtipacrso" class="m-2">
                        b
                    </div>
                </div>

                <div class="figuraspareto">
                    <div id="figtipacrso2" class="m-2">
                        b
                    </div>
                </div>

                <div class="figuraspareto">
                    <div id="figtipacrma" class="m-2">
                        c
                    </div>
                </div>

                <div class="figuraspareto">
                    <div id="figtipacrma2" class="m-2">
                        c
                    </div>
                </div>

                <div class="figuraspareto">
                    <div id="figtipacrpc" class="m-2">
                        d
                    </div>
                </div>
                <div class="figuraspareto">
                    <div id="figtipacrpc2" class="m-2">
                        d
                    </div>
                </div>
            </div>


        </div>


        <br><br><br>


        <!-- AC RIESGO -->
        <div id="acriesgos" style="padding-top: 30px; width: 100%;">

        </div>
        <!-- AC RIESGO -->
        <h1 class="salto"></h1>

        <!-- AC RELEVANTES -->
        <div id="detacseguros" style="padding-top: 30px; width: 100%;">


        </div>
        <!-- AC RELEVANTES -->

        <div id="dethallazgos" style="padding-top: 30px; width: 100%;">

        </div>

        <div id="detIncidentes" style="padding-top: 30px; width: 100%;">
            <div class="card-header mb-2">
                <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseIncidentes" aria-expanded="false" aria-controls="collapseIncidentes">
                    <i class="fas fa-arrow-circle-down"></i>
                </button> INCIDENTES
            </div>

            <div class="collapse" id="collapseIncidentes">
                <div class="card card-body">
                    <div style="width: 100%; height: auto;">
                        <div class="table-responsive" id="tablaincidentes">
                            ...
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <!-- fin indicadores de gestion -->

        <!-- histograma de recursos -->
        <h1 class="salto"></h1>

        <div class="card-header mb-2">
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#acorper" aria-expanded="false" aria-controls="acorper">
                <i class="fas fa-arrow-circle-down"></i>
            </button> HISTOGRAMA DE PERSONAL
        </div>

        <div class="" id="acorper">
            <div class="row mt-3">

                <div class="col-sm-12">
                    <div class="card">
                        <div class="card-header" style="background-color: #01005e;">
                            PERSONAL POR FRENTES DIARIO
                        </div>
                        <div class="card-body ">
                            <div id="figpersturnos">

                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-header" style="background-color: #01005e;">
                            PERSONAL 
                        </div>
                        <div class="card-body ">
                            <div id="figpersplanta">

                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-header" style="background-color: #01005e;">
                            HHT 
                        </div>
                        <div class="card-body ">
                            <div id="figpershht">

                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-header" style="background-color: #01005e;">
                            ACUMULADO HHT
                        </div>
                        <div class="card-body ">
                            <div id="figacumhht">

                            </div>
                        </div>
                    </div>
                </div>



                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-header" style="background-color: #01005e;">
                            HORAS CAPACITACIÓN
                        </div>
                        <div class="card-body ">
                            <div id="fighcap">

                            </div>
                        </div>
                    </div>
                </div>





            </div>
        </div>

        <h1 class="salto"></h1>

        <div class="row">
            <div class="col-sm-12">
                <div class="card">
                    <div class="card-header" style="background-color: #01005e;">
                        CONSOLIDADO INSPECCIONES
                    </div>
                    <div class="card-body ">
                        <div id="figconsinsp">

                        </div>
                    </div>
                </div>
            </div>

            <div class="col-sm-12">
                <div class="card">
                    <div class="card-header" style="background-color: #01005e;">
                        KPI AUDITORIAS

                        <button type="button" class="btn btn-sm btn-danger" style="position: absolute; right: 10px" onclick="verAuditorias()">
                            Auditorias
                        </button>
                    </div>
                    <div class="card-body ">
                        <div id="figconsaudi">

                        </div>
                    </div>
                </div>
            </div>

            <div class="col-sm-12">
                <div class="card">
                    <div class="card-header" style="background-color: #01005e;">
                        PERMISOS DE TRABAJOS


                    </div>
                    <div class="card-body ">
                        <div class="row">
                            <div class="col-sm-12">
                                <div id="figpermisos">

                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12">
                <div class="card">
                    <div class="card-header" style="background-color: #01005e;">
                        CONSOLIDADO RESIDUOS SÓLIDOS

                    </div>
                    <div class="card-body ">
                        <div class="row">
                            <div class="col-sm-12">
                                <div id="figconsresi">

                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- <h1 class="salto"></h1> -->

        <div id="registrofotografico">

            <h5 class="titcatfotos" style="width: 100%;">Registro Fotográfico</h5>
            <div id="galeriafotosao"></div>

            <div id="galeriafotosma"></div>

            <div id="galeriafotossi"></div>

            <h1 class="salto"></h1>

            <h5 class="titcatfotos" style="width: 100%;">NOVEDADES</h5>
            <div id="novedades" style="clear: both;">

            </div>

            <!-- <h5 class="titcatfotos" style="width: 100%;">PERSONAL CON NOVEDADES</h5>
            <div>
                <table class="table" style="width: 100%;">
                    <thead>
                        <th>TRABAJADOR</th>
                        <th>CARGO</th>
                        <th>NOVEDAD</th>
                    </thead>
                    <tbody id="novedadpersonal">

                    </tbody>
                </table>
            </div> -->


        </div>




        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        <script>
            function getParameterByName(name) {
                name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
                var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                    results = regex.exec(location.search);
                return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
            }

            var fecha = getParameterByName('fecha');

            console.log('Fechaaaaa ' + fecha)

            function sumarDias(fechab, dias) {
                fechab.setDate(fechab.getDate() + dias);
                return fechab;
            }

            var hoy = new Date();
            hoy = sumarDias(hoy, -1);

            var dia = hoy.getDate();
            if (dia < 10) {
                dia = '0' + dia;
            }

            var fechahoy = hoy.getFullYear() + '-0' + (hoy.getMonth() + 1) + '-' + dia;
            var hora = hoy.getHours() + ':' + hoy.getMinutes() + ':' + hoy.getSeconds();
            var fechaYHora = fechahoy + ' ' + hora;

            var server = 'https://utitalco.com/server/';

            var numods = getParameterByName('ods');

            if (numods == '') {
                numods = '032'
            }
 

            if (fecha == '') {
                fecha = fechahoy;
            }

            var odsant = '';
            var fase = '';
            var novedades = ''

            var totacglobal = 0
            var totconversatoriosglobal = 0
            var tothallazgosglobal = 0

            var totacitalco = 0
            var totacdremec = 0
            var totaccliente = 0

            var totacitalcodia = 0
            var totacdremecdia = 0
            var totacclientedia = 0

            var tothallazgositalco = 0;
            var tothallazgosdremec = 0;

            var totacitalcobaja = 0;
            var totacitalcomedia = 0;
            var totacitalcoalta = 0;

            var totacitalcobajarep = 0;
        var totacitalcomediarep = 0;
        var totacitalcoaltarep = 0;

        var totacitalcobajarepec = 0;
        var totacitalcomediarepec = 0;
        var totacitalcoaltarepec = 0;

            var totacitalcobajadia = 0;
            var totacitalcomediadia = 0;
            var totacitalcoaltadia = 0;

            var totacdremecbaja = 0;
            var totacdremecmedia = 0;
            var totacdremecalta = 0;

            var totacdremecbajadia = 0;
            var totacdremecmediadia = 0;
            var totacdremecaltadia = 0;



            //se definen las variables array
            var arrayHallazgos = []
            var arrayDetallesHallazgos = []
            var arrayDetallesACS = []
            var arrayDetallesACR = []
            var arrayDatos = []
            var arrayKpiIG = []
            var arrayKpiIGA = []
            var arrayKpiPersonal = []
            var arrayDiasSemana = []
            var arrayTDirectos = []
            var arrayTIDirectos = []
            var arrayTTotal = []
            var arrayCronoAC = []
            var arrayCateCronoAC = []
            var arrayValPCronoAC = []
            var arrayValECronoAC = []

            var arrayHHAcum = []
            var arrayHCap = []
            var arrayPermisos = []
            var arrayPermisosEsp = []

            var arrayEspecialidadesPer = []
            var arrayEspCantPer = []
            var arrayGaleria = []

            var arrayPareto = []
            var arrayTitulosSI = []
            var arrayTitulosSO = []
            var arrayTitulosMA = []
            var arrayTitulosPC = []

            var arrayTitulosSI2 = []
            var arrayTitulosSO2 = []
            var arrayTitulosMA2 = []
            var arrayTitulosPC2 = []

            var arrayRiesgo = []

            var arrayPersonalTurnos = []
            var arrayPersonalDremec = []

            var dremecDirectos = 0
            var dremecIndirectos = 0
            var dremecTotal = 0;

            var hdremecDirectos = 0;
            var hdremecIndirectos = 0;
            var hdremecTotal = 0

            var totalPersonalDirectos = 0;
            var totalPersonalIndirectos = 0;
            var totalPersonalPlanta = 0;

            var totalHorasDirectos = 0;
            var totalHorasIndirectos = 0;
            var totalHoras = 0;

            var acumHDirectos = 0
            var acumHIndirectos = 0
            var acumHHTotal = 0

            var arrayTurnos = []
            var arrayDirectos = []
            var arrayIndirectos = []
            var arrayTotalPersonal = []
            var arrayTotalHorasHombreDirectos = []
            var arrayTotalHorasHombreIndirectos = []
            var arrayTotalHorasHombre = []

            var arrayConsRctGTit = []

            var totalHHDirectosD = 0
            var totalHHIndirectosD = 0
            var totalHHD = 0

            var totalHHDirectosA = 0
            var totalHHIndirectosA = 0
            var totalHHA = 0

            var hhfase1 = 0
            var hhfase2 = 0
            var hhfase3 = 0
            var hhconv = 0

            var arrayConsACGCant = []
            var arrayConsLid = []
            var arrayConsRctGCant = []

            var arrayConsInspGTit = []
            var arrayConsInspGCant = []

            var totalPerFe = 0
            var totalPerFr = 0
            var totalPerCe = 0
            var totalPerCr = 0
            var totalPerEe = 0
            var totalPerEr = 0
            var totalPerE = 0
            var totalPerR = 0
            var totalPerm = 0
            var totalPerh = 0

            var rbajoHallazgos = 0
            var rmedioHallazgos = 0
            var raltoHallazgos = 0
            var maHallazgos = 0
            var siHallazgos = 0
            var soHallazgos = 0

            var cantacstipma = 0
            var cantacstipsi = 0
            var cantacstipso = 0
            var cantacrtipma = 0
            var cantacrtipsi = 0
            var cantacrtipso = 0
            var cantacstippc = 0
            var cantacrtippc = 0

            var cantacrbajo = 0
            var cantacrmedio = 0
            var cantacralto = 0

            var totac = 0
            var totacdia = 0
            var totauditorias = 0
            var totcam = 0
            var totconversatorios = 0
            var tothallazgos = 0
            var totinsp = 0
            var totrct = 0

            var totacant = 0
            var totauditoriasant = 0
            var totcamant = 0
            var totconversatoriosant = 0
            var tothallazgosant = 0
            var totinspant = 0
            var totrctant = 0

            var totpersonalglobal = 0
            var totpersonalpxq = 0

            var tothhtglobal = 0
            var tothhtpxq = 0

            var tothhtdir = 0
            var tothhtindir = 0

            var tothhtdia = 0
            var arrayPersonal = [];
        var arrayPersonalTurnosHoras = [];

        var arrayPlantas = [];

            var tothhtacumdir = 0
            var tothhtacumindir = 0
            var tothhtparada = 0

            var arrayFrentesTit = [];
            var arrayFrentesDir = [];
            var arrayFrentesIndir = [];
            var arrayFrentesTot = [];

            var sumadirectos = null;
            var sumaindirectos = null;
            var sumtotal = null;

            var arrayFrenteshDir = [];
            var arrayFrenteshIndir = [];
            var arrayFrenteshTot = [];

            var sumahdirectos = null;
            var sumahindirectos = null;
            var sumhtotal = null;

            var arrayFrentesTrab = [];

        var arrayFrentesTotales = [];

        var arrayPlantas = [];

        var arrayPDirecto = [];
        var arrayPIndirecto = [];
        var arrayPtot = [];

        var arrayHDirecto = [];
        var arrayHIndirecto = [];
        var arrayHtot = [];

            var arrayCons = []
            var arrayConsAudiGTit = []
            var arrayConsAudiGPlan = []
            var arrayConsAudiGEje = []
            var arrayConsAudiGEjeCump = []
            var tosSumAuditorias = null

            var rbajoHallazgos = 0;
            var rmedioHallazgos = 0;
            var raltoHallazgos = 0;
            var maHallazgos = 0;
            var siHallazgos = 0;
            var soHallazgos = 0;
            var spHallazgos = 0;
            var cantHallAbiertos = 0;
            var cantHallCerrados = 0;
            var porcHall = 0;



            var arrayTurnos = []
            var arrayPfrio = []
            var arrayPcaliente = []
            var arrayPelectrico = []
            var arraytotalp = []
            var arrayMramm = []
            var arrayMramh = []
            var arrayMramvh = []
            var arraytotalmatriz = []

            var arrayConsACGTit = []

            var arrayCca1 = []
            var arrayCca2 = []
            var arrayCca3 = []
            var arrayCca5 = []
            var arrayCca6 = []
            var arrayCca7 = []
            var arraySsas = []
            var arraySsaes = []
            var arraytotalca = []

            var arrayPpra = []
            var arrayPprc = []
            var arrayPprg = []
            var arraytotalpr = []

            var arrayPpnuevos = []
            var arrayPprevalidados = []
            var arrayPpcerrados = []


            var arrayFrentesTit = []
            var arrayFrentesDir = []
            var arrayFrentesIndir = []
            var arrayFrentesTot = []

            var arrayFrentesTrab = []

            var arrayFrentesTotales = []

            var arrayCons = [];
            var arrayConsACGTit = [];
            var arrayConsACG = [];
            var arrayConsACGPlan = [];
            var arrayConsACGEje = [];
            var arrayConsACGCump = [];

            var arrayConsCamGTit = [];
            var arrayConsCamGPlan = [];
            var arrayConsCamGEje = [];
            var totCaminatas = 0;
            var arrayConsCamG = [];
            var arrayConsCamGCump = [];

            var arrayResiduosTitulos = []
            var arrayResiduosCant = []
            var arrayResiduos = []

            $('#cantincidentes').html('0')

            buscarOds()


            function buscarOds() {
                $.post(server + 'buscarods.php', {
                        ods: numods
                    },
                    function(resp) {
                        console.log(resp)
                        if (resp.msn == 'OK') {
                            ods = resp.ods

                            ods = resp.ods
                            odsant = resp.odsant
                            fase = parseInt(resp.fase)



                            $('#fechainforme').html(fecha)
                            $('#ods').html(ods)

                            pedirDatos()

                        } else {
                            Swal.fire({
                                icon: 'error',
                                title: 'Oops...',
                                text: 'No está registrada esta Orden de Servicio, por favor verifique el link suministrado...!'
                            }).then((result) => {
                                window.location = 'index_404.html'
                            })
                        }
                    })
            }

            function pedirDatos() {
                console.log('pedirdatos')
                obtenerdatosAC()
                cargando()
                bPersonal();
                obtenerNovedades()
                    //obtenerNovedadesPersonal()
                obtenerdatosHallazgos()
                obtenerKpiTotales()
                indicadoresGestion()
                    //obtenerKpiCronoAC()
                    //obtenerdatosConversatorios()
                detallesACSeguros()
                    //obtenerAudi()
                detallesACRiesgo()
                detallesIncidentes()
                obtenerKpiACRiesgoPareto()
                
                    //obtenerKpiPersonalAcumulado()
                obtenerKpiHorasCap()
                obtenerKpiPermisos()
                buscarHallazgos()
                obtenerKpiCons()
                    //obtenerKpiPermisosEsp()
                obtenerKpiResiduos()
                cargarAlturas()
                cargarPermisos()
                obtenerGaleria()

            }

            function detallesIncidentes() {
                $.post(server + 'buscarIncidentes.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {

                        arrayDetallesIncidentes = resp;

                        var html = `<div class="table-responsive">
                    <table class="table-responsive table-striped">
                        <thead class="thead-dark">
                            <th>Fecha Reporte</th>
                            <th>Item</th>
                            <th style="width: 300px;">Reporte</th>
                            <th>Nombre quien reporta</th>
                            <th>Criticidad</th>
                            <th>Afectación</th>
                            
                            <th>Estado</th>
                            <th>Valoración RAM</th>
                        </thead>
                        <tbody>
                    `
                        if (arrayDetallesIncidentes != null) {

                            for (var i = 0; i < arrayDetallesIncidentes.length; i++) {
                                html += `
                                <tr>
                                    <td>${arrayDetallesIncidentes[i].fecha}</td>
                                    <td>${arrayDetallesIncidentes[i].item}</td>
                                    <td>${arrayDetallesIncidentes[i].detalles}</td>
                                    <td>${arrayDetallesIncidentes[i].reporta}</td>
                                    <td>${arrayDetallesIncidentes[i].criticidad}</td>
                                    <td>${arrayDetallesIncidentes[i].tipificacion}</td>
                                    
                                    <td>${arrayDetallesIncidentes[i].estado}</td>
                                    <td>${arrayDetallesIncidentes[i].valoracion}</td>
                                </tr>
                            `;
                            }
                        }
                        html += `
                        </tbody>
                    </table></div>`
                        $('#tablaincidentes').html(html)
                        var cantInci = arrayDetallesIncidentes.length;
                        $('#cantincidentes').html(cantInci)
                    })
            }


            function cargarAlturas() {
                $.post(server + 'cargarAlturas.php', {},
                    function(resp) {
                        arrayAlturas = resp
                    })
            }

            function indicadoresGestion() {
                $.post(server + 'buscarIndicadores.php', {
                    ods: numods,
                    fecha: fecha
                }, function(resp) {
                    arrayIndicadores = resp
                    $('#cantaudi').html(arrayIndicadores.totauditorias)
                })

            }

            function cargarPermisos() {
                $.post(server + 'informePermisos.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {

                        if (resp.tabla == null) {

                        } else {
                            arrayDatos = resp
                            console.log(resp.tabla)
                            arrayTabla = resp.tabla

                            for (var i = 0; i < arrayDatos.turnos.length; i++) {
                                arrayTurnos.push(arrayDatos.turnos[i].turno)
                            }
                            arrayTurnos.push('TOTALES');

                            var sumaPfrio = 0;
                            var sumaPcaliente = 0;
                            var sumaPelectrico = 0;
                            var sumatotalp = 0;

                            var sumaPnuevos = 0;
                            var sumaPrevalidados = 0;
                            var sumaPcerrados = 0;

                            for (var i = 0; i < arrayDatos.datos.length; i++) {

                                arrayPfrio.push(arrayDatos.datos[i].pfrio)
                                sumaPfrio += parseInt(arrayDatos.datos[i].pfrio);

                                arrayPcaliente.push(arrayDatos.datos[i].pcaliente)
                                sumaPcaliente += arrayDatos.datos[i].pcaliente;

                                arrayPelectrico.push(arrayDatos.datos[i].pelectrico)
                                sumaPelectrico += arrayDatos.datos[i].pelectrico;

                                arraytotalp.push(arrayDatos.datos[i].totalp)
                                sumatotalp += arrayDatos.datos[i].totalp;

                                arrayMramm.push(arrayDatos.datos[i].ramm)
                                arrayMramh.push(arrayDatos.datos[i].ramh)
                                arrayMramvh.push(arrayDatos.datos[i].ramvh)
                                arraytotalmatriz.push(arrayDatos.datos[i].totalmatriz)

                                arrayCca1.push(arrayDatos.datos[i].ca1)
                                arrayCca2.push(arrayDatos.datos[i].ca2)
                                arrayCca3.push(arrayDatos.datos[i].ca3)
                                arrayCca5.push(arrayDatos.datos[i].ca5)
                                arrayCca6.push(arrayDatos.datos[i].ca6)
                                arrayCca7.push(arrayDatos.datos[i].ca7)
                                arraySsas.push(arrayDatos.datos[i].sas)
                                arraySsaes.push(arrayDatos.datos[i].saes)
                                arraytotalca.push(arrayDatos.datos[i].totalca)

                                arrayPpra.push(arrayDatos.datos[i].pra)
                                arrayPprc.push(arrayDatos.datos[i].prc)
                                arrayPprg.push(arrayDatos.datos[i].prg)
                                arraytotalpr.push(arrayDatos.datos[i].totalpr)

                                arrayPpnuevos.push(arrayDatos.datos[i].pnuevos)
                                sumaPnuevos += arrayDatos.datos[i].pnuevos

                                arrayPprevalidados.push(arrayDatos.datos[i].prevalidados)
                                sumaPrevalidados += arrayDatos.datos[i].prevalidados

                                arrayPpcerrados.push(arrayDatos.datos[i].pcerrados)
                                sumaPcerrados += (arrayDatos.datos[i].pcerrados)

                            }

                            arrayPfrio.push(sumaPfrio);
                            arrayPcaliente.push(sumaPcaliente);
                            arrayPelectrico.push(sumaPelectrico);
                            arraytotalp.push(sumatotalp);

                            arrayPpnuevos.push(sumaPnuevos)
                            arrayPprevalidados.push(sumaPrevalidados)
                        }



                    })

            }


            function obtenerAudi() {
                //obtener conversatorios

                $.post(server + 'obtenerAudi.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {
                        var arrayAuditorias = resp
                        if (arrayAuditorias.length != null) {
                            var html = `
                        <div class="table-responsive" style="background-color: white">
                            <table class="table table-striped" style="background-color: white;">
                                <thead class="thead-dark" >
                                    <th>AUDITORIA</th>
                                    <th>AUDITOR</th>
                                    <th>RESPONSABLE</th>
                                    <th>CAL</th>
                                    <th>OPORTUNIDAD</th>
                                    <th>PLAN DE ACCIÓN</th>
                                </thead>
                                <tbody>
                        `

                            for (var i = 0; i < arrayAuditorias.length; i++) {
                                html += `
                        <tr>
                            <td>${arrayAuditorias[i].auditoria}</td>
                            <td>${arrayAuditorias[i].auditor}</td>
                            <td>${arrayAuditorias[i].responsable}</td>
                            <td>${arrayAuditorias[i].cal}</td>
                            <td>${arrayAuditorias[i].oportunidad}</td>
                            <td>${arrayAuditorias[i].plan}</td>
                        </tr>
                    `
                            }
                            html += `
                        </tbody>
                    </table>
                </div>`

                            for (var a = 0; a < arrayAuditorias[0].fotos.length; a++) {
                                html += `
                    <div class="fotogal">
                            <img src="https://utitalco.com/server/${arrayAuditorias[0].fotos[a].foto}" class="imagen"  width="300px" height="220px" alt="" >
                             
                        </div>
                    `
                            }

                            html += `

                `
                            $('#tablaaudi').html(html)
                        }
                    })

            }

            function obtenerGaleria() {
                $.post(server + 'buscarGaleriaGen.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {

                        arrayGaleria = resp

                        var htmlso = '<table style="width: 100%; margin-top: 20px;">'
                        var htmlma = '<table style="width: 100%; margin-top: 20px;">'
                        var htmlsi = '<table style="width: 100%; margin-top: 20px;">'


                        for (var i = 0; i < arrayGaleria.length; i++) {

                            if (arrayGaleria[i].seccion == 'Salud Ocupacional') {


                                htmlso += `
                         
                            <div style="width: 305px; float: left;">
                                <div class="foto" style="height: 370px;" >
                                    <img src="https://utitalco.com/server/${arrayGaleria[i].foto}" class="imagen"  width="100%" height="220px" alt="" >
                                <div class="piefoto">
                                    ${arrayGaleria[i].detalles}
                                </div>
                                </div>
                            </div>
                            

                    `


                            }
                            if (arrayGaleria[i].seccion == 'Medio Ambiente') {


                                htmlma += `
                            <div style="width: 305px; float: left;">
                                <div class="foto" style="height: 370px;" >
                                    <img src="https://utitalco.com/server/${arrayGaleria[i].foto}" class="imagen"  width="100%" height="220px" alt="" >
                                <div class="piefoto">
                                    ${arrayGaleria[i].detalles}
                                </div>
                                </div>
                            </div>
                    `

                            }
                            if (arrayGaleria[i].seccion == 'Seguridad Industrial') {

                                htmlsi += `
                            <div style="width: 305px; float: left;">
                                <div class="foto" style="height: 370px;" >
                                    <img src="https://utitalco.com/server/${arrayGaleria[i].foto}" class="imagen"  width="100%" height="220px" alt="" >
                                <div class="piefoto">
                                    ${arrayGaleria[i].detalles}
                                </div>
                                </div>
                            </div>
                    `

                            }

                        }

                        htmlso += '</table>'
                        htmlma += '</table>'
                        htmlsi += '</table>'

                        $('#galeriafotosao').html(htmlso)
                        $('#galeriafotosma').html(htmlma)
                        $('#galeriafotossi').html(htmlsi)


                    })
            }



            function obtenerNovedades() {
                $.post(server + 'obtenerNovedadesGen.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {
                        console.log('Fecha novedades')
                        novedades = resp.nove
                        console.log('Respuesta de novedades')
                        console.log(resp)
                        var nove = resp.nove
                        var html = ''
                        if (nove != null) {

                            for (var i = 0; i < nove.length; i++) {
                                html += nove[i].novedad
                            }
                        }
                        $('#novedades').html(html)
                    })
            }

            function obtenerNovedadesPersonal() {
                $.post(server + 'obtenerNovedadesPersonal.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {
                        console.log('Respuesta de novedades')
                        console.log(resp)
                        var html = ''
                        for (var i = 0; i < resp.length; i++) {
                            html += `
                    <tr>
                        <td>${resp[i].nombre}</td>
                        <td>${resp[i].cargo}</td>
                        <td>${resp[i].novedad}</td>
                    </tr>
                `
                        }
                        $('#novedadpersonal').html(html)
                    })
            }

            function obtenerKpiCronoAC() {
                $.post(server + 'buscarKpiCronoAC.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {
                        arrayCronoAC = resp
                        for (var i = 0; i < arrayCronoAC.length; i++) {
                            arrayCateCronoAC.push(arrayCronoAC[i].cargo)
                            arrayValPCronoAC.push(parseInt(arrayCronoAC[i].plan))
                            arrayValECronoAC.push(parseInt(arrayCronoAC[i].eje))
                        }
                    })

            }

            function cargando() {
                let timerInterval
                Swal.fire({
                    title: 'Cargando indicadores!',
                    html: 'Un momento por favor...',
                    timer: 5000,
                    timerProgressBar: true,
                    didOpen: () => {
                        Swal.showLoading()
                        timerInterval = setInterval(() => {
                            const content = Swal.getContent()
                            if (content) {
                                const b = content.querySelector('b')
                            }
                        }, 1000)
                    },
                    willClose: () => {
                        clearInterval(timerInterval)
                    }
                }).then((result) => {
                    /* Read more about handling dismissals below */
                    if (result.dismiss === Swal.DismissReason.timer) {
                        hhtotal = parseInt(hhfase1) + parseInt(hhfase2) + parseInt(hhfase3) + parseInt(hhconv)
                        cargarGraficas()
                    }
                })

            }

            function obtenerKpiCons() {
                $.post(
                    server + "buscarkpiConsGen.php", {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {
                        console.log("Resultado kpi consolidado");
                        console.log(resp);

                        arrayCons = resp;

                        if (arrayCons.arrayConsAC != null) {
                            for (var i = 0; i < arrayCons.arrayConsAC.length; i++) {
                                arrayConsACGTit.push(arrayCons.arrayConsAC[i].cargo);
                            }
                        }

                        if (arrayCons.arrayConsAC != null) {
                            for (var i = 0; i < arrayCons.arrayConsAC.length; i++) {
                                arrayConsACGPlan.push(parseInt(arrayCons.arrayConsAC[i].plan));
                                arrayConsACGEje.push(parseInt(arrayCons.arrayConsAC[i].eje));
                                arrayConsACGTit.push(parseInt(arrayCons.arrayConsAC[i].cump));
                            }
                        }

                        if (arrayCons.arrayConsACLid != null) {

                            for (var i = 0; i < arrayCons.arrayConsACLid.length - 2; i++) {
                                arrayConsACGCant.push(parseInt(arrayCons.arrayConsACLid[i].eje));
                            }
                        }

                        if (arrayCons.arrayConsCaminata != null) {
                            for (var i = 0; i < arrayCons.arrayConsCaminata.length; i++) {
                                arrayConsCamGTit.push(arrayCons.arrayConsCaminata[i].cargo);
                            }

                        }
                        if (arrayCons.arrayConsCaminata != null) {

                            for (var i = 0; i < arrayCons.arrayConsCaminata.length; i++) {
                                arrayConsCamGPlan.push(
                                    parseInt(arrayCons.arrayConsCaminata[i].plan)
                                );
                                arrayConsCamGEje.push(
                                    parseInt(arrayCons.arrayConsCaminata[i].eje)
                                );

                                totCaminatas += parseInt(arrayCons.arrayConsCaminata[i].eje);

                                arrayConsCamGCump.push(
                                    parseInt(arrayCons.arrayConsCaminata[i].cump)
                                );
                            }
                            if (arrayCons.arrayConsCaminata != null) {

                                for (var i = 0; i < arrayCons.arrayConsCaminata.length - 1; i++) {
                                    arrayConsCamG.push(parseInt(arrayCons.arrayConsCaminata[i].eje));
                                }
                            }

                        }

                        if (arrayCons.arrayConsRct != null) {

                            for (var i = 0; i < arrayCons.arrayConsRct.length; i++) {
                                arrayConsRctGTit.push(arrayCons.arrayConsRct[i].cargo);
                            }
                        }

                        if (arrayCons.arrayConsCaminata != null) {
                            for (var i = 0; i < arrayCons.arrayConsCaminata.length - 1; i++) {
                                arrayConsLid.push(arrayCons.arrayConsCaminata[i].cargo);
                            }

                        }


                        // if (arrayCons.arrayConsRct != null) {
                        //     for (var i = 0; i < arrayCons.arrayConsRct.length; i++) {
                        //         arrayConsRctGPlan.push(parseInt(arrayCons.arrayConsRct[i].plan));
                        //         arrayConsRctGEje.push(parseInt(arrayCons.arrayConsRct[i].eje));
                        //         arrayConsRctCump.push(parseInt(arrayCons.arrayConsRct[i].cump));

                        //         totSumaRct += parseInt(arrayCons.arrayConsRct[i].eje);

                        //     }

                        //     for (var i = 0; i < arrayCons.arrayConsRct.length - 1; i++) {
                        //         arrayConsRctGCant.push(parseInt(arrayCons.arrayConsRct[i].eje));
                        //     }
                        // }

                        if (arrayCons.arrayConsAudi != null) {

                            for (var i = 0; i < arrayCons.arrayConsAudi.length; i++) {
                                arrayConsAudiGTit.push(arrayCons.arrayConsAudi[i].auditoria);
                            }

                            for (var i = 0; i < arrayCons.arrayConsAudi.length; i++) {
                                arrayConsAudiGPlan.push(
                                    parseInt(arrayCons.arrayConsAudi[i].plan)
                                );
                                arrayConsAudiGEje.push(parseInt(arrayCons.arrayConsAudi[i].eje));
                                arrayConsAudiGEjeCump.push(
                                    parseInt(arrayCons.arrayConsAudi[i].cump)
                                );
                                tosSumAuditorias += parseInt(arrayCons.arrayConsAudi[i].eje)
                            }

                        }

                        if (arrayCons.arrayConsInsp != null) {

                            for (var i = 0; i < arrayCons.arrayConsInsp.length; i++) {
                                arrayConsInspGTit.push(arrayCons.arrayConsInsp[i].inspeccion);
                            }

                            arrayConsInspGTit.push('TOTAL');

                            for (var i = 0; i < arrayCons.arrayConsInsp.length; i++) {
                                arrayConsInspGCant.push(
                                    parseInt(arrayCons.arrayConsInsp[i].cant)
                                );
                            }

                            arrayConsInspGCant.push(arrayCons.totinsp)
                        }



                    }
                );
            }


            function obtenerKpiACRiesgoPareto() {
                $.post(server + 'bPareto.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {
                        console.log('Resultado kpi pareto')
                        console.log(resp)
                        arrayPareto = resp

                        if (arrayPareto.arraySI != null) {
                            for (var i = 0; i < arrayPareto.arraySI.length; i++) {
                                arrayTitulosSI.push({
                                    name: arrayPareto.arraySI[i].nivel,
                                    data: [arrayPareto.arraySI[i].cant],
                                });
                            }
                        }

                        if (arrayPareto.arraySO != null) {
                            for (var i = 0; i < arrayPareto.arraySO.length; i++) {
                                arrayTitulosSO.push({
                                    name: arrayPareto.arraySO[i].nivel,
                                    data: [arrayPareto.arraySO[i].cant],
                                });
                            }
                        }

                        if (arrayPareto.arrayMA != null) {
                            for (var i = 0; i < arrayPareto.arrayMA.length; i++) {
                                arrayTitulosMA.push({
                                    name: arrayPareto.arrayMA[i].nivel,
                                    data: [arrayPareto.arrayMA[i].cant],
                                });
                            }
                        }

                        if (arrayPareto.arrayPC != null) {
                            for (var i = 0; i < arrayPareto.arrayPC.length; i++) {
                                arrayTitulosPC.push({
                                    name: arrayPareto.arrayPC[i].nivel,
                                    data: [arrayPareto.arrayPC[i].cant],
                                });
                            }
                        }

                        //NIVEL 2

                        if (arrayPareto.arraySI2 != null) {
                            for (var i = 0; i < arrayPareto.arraySI2.length; i++) {
                                arrayTitulosSI2.push({
                                    name: arrayPareto.arraySI2[i].nivel,
                                    data: [arrayPareto.arraySI2[i].cant],
                                });
                            }
                        }

                        if (arrayPareto.arraySO2 != null) {
                            for (var i = 0; i < arrayPareto.arraySO2.length; i++) {
                                arrayTitulosSO2.push({
                                    name: arrayPareto.arraySO2[i].nivel,
                                    data: [arrayPareto.arraySO2[i].cant],
                                });
                            }
                        }

                        if (arrayPareto.arrayMA2 != null) {
                            for (var i = 0; i < arrayPareto.arrayMA2.length; i++) {
                                arrayTitulosMA2.push({
                                    name: arrayPareto.arrayMA2[i].nivel,
                                    data: [arrayPareto.arrayMA2[i].cant],
                                });
                            }
                        }

                        if (arrayPareto.arrayPC2 != null) {
                            for (var i = 0; i < arrayPareto.arrayPC2.length; i++) {
                                arrayTitulosPC2.push({
                                    name: arrayPareto.arrayPC2[i].nivel,
                                    data: [arrayPareto.arrayPC2[i].cant],
                                });
                            }
                        }

                        //FIN NIVEL 2
                        if (arrayTitulosSI.length == 0) {
                            $('#figtipacrsi').addClass('oculto')
                        }
                        if (arrayTitulosSO.length == 0) {
                            $('#figtipacrso').addClass('oculto')
                        }
                        if (arrayTitulosMA.length == 0) {
                            $('#figtipacrma').addClass('oculto')
                        }
                        if (arrayTitulosPC.length == 0) {
                            $('#figtipacrpc').addClass('oculto')
                        }

                        if (arrayTitulosSI2.length == 0) {
                            $('#figtipacrsi2').addClass('oculto')
                        }
                        if (arrayTitulosSO2.length == 0) {
                            $('#figtipacrso2').addClass('oculto')
                        }
                        if (arrayTitulosMA2.length == 0) {
                            $('#figtipacrma2').addClass('oculto')
                        }
                        if (arrayTitulosPC2.length == 0) {
                            $('#figtipacrpc2').addClass('oculto')
                        }

                    })

            }


            function obtenerdatosHallazgos() {
                //obtener hallazgos
                $.post(server + 'buscarHallazgosKpi.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {
                        console.log(fecha)
                        console.log(resp)
                        arrayHallazgos = resp

                        $("#canthallazgos").html(arrayHallazgos.length);

                        if (arrayHallazgos != null) {

                            for (var i = 0; i < arrayHallazgos.length; i++) {
                                if (arrayHallazgos[i].criticidad.trim().toUpperCase() == "BAJA") {
                                    rbajoHallazgos++;
                                }
                                if (arrayHallazgos[i].criticidad.trim().toUpperCase() == "MEDIA") {
                                    rmedioHallazgos++;
                                }
                                if (arrayHallazgos[i].criticidad.trim().toUpperCase() == "ALTA") {
                                    raltoHallazgos++;
                                }
                                if (arrayHallazgos[i].tipificacion.trim().toUpperCase() == "MEDIO AMBIENTE") {
                                    maHallazgos++;
                                }
                                if (
                                    arrayHallazgos[i].tipificacion.trim().toUpperCase() == "SALUD OCUPACIONAL"
                                ) {
                                    soHallazgos++;
                                }
                                if (
                                    arrayHallazgos[i].tipificacion.trim().toUpperCase() == "SEGURIDAD INDUSTRIAL"
                                ) {
                                    siHallazgos++;
                                }
                                if (
                                    arrayHallazgos[i].tipificacion.trim().toUpperCase() == "SEGURIDAD DE PROCESOS"
                                ) {
                                    spHallazgos++;
                                }

                                if (arrayHallazgos[i].estado.trim().toUpperCase() == "CERRADO") {
                                    cantHallCerrados++;
                                } else {
                                    cantHallAbiertos++;
                                }
                            }
                            porcHall =
                                (cantHallCerrados * 100) /
                                (cantHallCerrados + cantHallAbiertos);

                            canthallazgos = cantHallCerrados + cantHallAbiertos
                            cantHallCerrados += tothallazgosant
                            var porcGestionHallazgos = (100 * cantHallCerrados) / canthallazgos

                            $('#porcgestion').html(Math.round(porcGestionHallazgos) + '%')

                            detallesHallazgos()
                        }
                    })
            }

            async function bPersonal() {

            var formData = new FormData();
            formData.append('ods', numods);
            formData.append('fecha', fecha);

            const response = await fetch(server + "bKpiPersonal.php", {
                method: 'POST', body: formData 
            });

            if (!response.ok) throw new Error("Sin Conexión");
            const data = await response.json();
            if (data == null) throw new Error("Sin Datos");

            var resp = data;

            arrayPersonal = resp

            arrayPersonalTurnos = resp;

            arrayFrentesTrab = arrayPersonal.personalfrentes;

            arrayFrentesTotales = arrayPersonal.personalfrentes;

            if (arrayFrentesTrab != null) {
                for (var i = 0; i < arrayFrentesTrab.length; i++) {
                    arrayFrentesTit.push(arrayFrentesTrab[i].frente);
                }
            }

            arrayFrentesTit.push('TOTALES');

            for (var i = 0; i < arrayFrentesTotales.length; i++) {

                arrayFrentesDir.push(
                    arrayFrentesTotales[i].directos
                );
                arrayFrentesIndir.push(
                    arrayFrentesTotales[i].indirectos
                );
                arrayFrentesTot.push(
                    arrayFrentesTotales[i].total
                );

                sumadirectos += arrayFrentesTotales[i].directos
                sumaindirectos += arrayFrentesTotales[i].indirectos
                sumtotal += arrayFrentesTotales[i].total


            }

            arrayFrentesDir.push(
                sumadirectos
            );
            arrayFrentesIndir.push(
                sumaindirectos
            );
            arrayFrentesTot.push(
                sumtotal
            );




            if (arrayPersonalTurnos != null) {
                for (var i = 0; i < arrayPersonalTurnos.arrayTurnos.length; i++) {
                    arrayTurnos.push(arrayPersonalTurnos.arrayTurnos[i].jornada);
                }

                for (
                    var i = 0; i < arrayPersonalTurnos.arrayPersonalTurnos.length; i++
                ) {
                    arrayDirectos.push(
                        arrayPersonalTurnos.arrayPersonalTurnos[i].directo
                    );
                    arrayIndirectos.push(
                        arrayPersonalTurnos.arrayPersonalTurnos[i].indirecto
                    );
                    arrayTotalPersonal.push(
                        arrayPersonalTurnos.arrayPersonalTurnos[i].totalpersonal
                    );
                }

                // for (var i = 0; i < arrayPersonal.arrayPersonalPlanta.length; i++) {
                //     if (arrayPersonal.arrayPersonalPlanta[i].planta == 'PXQ') {
                //         var plantasel = 'RECURSO PXQ'
                //     } 
                //     if (arrayPersonal.arrayPersonalPlanta[i].planta == 'GLOBAL') {
                //         var plantasel = 'RECURSO GLOBAL'
                //     } 
                //     if (arrayPersonal.arrayPersonalPlanta[i].planta == 'PXQ / GLB') {
                //         var plantasel = 'RECURSO PXQ / GLB'
                //     } 
                //     arrayPlantas.push(
                //         plantasel
                //     )
                // }

                arrayPlantas.push(
                    'RECURSO PXQ'
                )
                arrayPlantas.push(
                    'RECURSO GLOBAL'
                )
                arrayPlantas.push(
                    'RECURSO PXQ / GLB'
                )

                arrayPlantas.push(
                    'TOTAL'
                )

                var sumDir = 0;
                var sumIndir = 0;
                var sumTot = 0;

                var sumHDir = 0;
                var sumHIndir = 0;
                var sumHTot = 0;


                for (var i = 0; i < arrayPersonal.arrayPersonalPlanta.length; i++) {

                    sumDir += arrayPersonal.arrayPersonalPlanta[i].directo;
                    sumIndir += arrayPersonal.arrayPersonalPlanta[i].indirecto
                    sumTot += arrayPersonal.arrayPersonalPlanta[i].directo + arrayPersonal
                        .arrayPersonalPlanta[i].indirecto

                    arrayPDirecto.push(
                        arrayPersonal.arrayPersonalPlanta[i].directo
                    )
                    arrayPIndirecto.push(
                        arrayPersonal.arrayPersonalPlanta[i].indirecto
                    )
                    arrayPtot.push(
                        arrayPersonal.arrayPersonalPlanta[i].totalpersonal
                    )

                    sumHDir += arrayPersonal.arrayPersonalPlanta[i].hdir;
                    sumHIndir += arrayPersonal.arrayPersonalPlanta[i].hindir
                    sumHTot += arrayPersonal.arrayPersonalPlanta[i].hdir + arrayPersonal
                        .arrayPersonalPlanta[i].hindir


                    arrayHDirecto.push(
                        arrayPersonal.arrayPersonalPlanta[i].hdir
                    )
                    arrayHIndirecto.push(
                        arrayPersonal.arrayPersonalPlanta[i].hindir
                    )
                    arrayHtot.push(
                        arrayPersonal.arrayPersonalPlanta[i].toth
                    )
                }

                arrayPDirecto.push(
                    sumDir
                )
                arrayPIndirecto.push(
                    sumIndir
                )
                arrayPtot.push(
                    sumTot
                )

                arrayHDirecto.push(
                    sumHDir
                )
                arrayHIndirecto.push(
                    sumHIndir
                )
                arrayHtot.push(
                    sumHTot
                )


            }

                   
        }



            function obtenerKpiTotales() {
                $.post(server + 'bKpiTotalesP.php', {
                        ods: numods,
                        fecha: fecha,
                        fase: fase
                    },
                    function(resp) {
                        console.log('total kpis:')
                        console.log(resp)

                        arrayKpiIG = resp

                        totac = arrayKpiIG.totac
                        totacdia = arrayKpiIG.totacdia

                        totacitalco = arrayKpiIG.totacitalco
                        totaccliente = arrayKpiIG.totaccliente

                        totacitalcodia = arrayKpiIG.totacitalcodia
                        totacclientedia = arrayKpiIG.totacclientedia

                        totconversatorios = arrayKpiIG.totconversatorios;

                        tothallazgositalco = arrayKpiIG.tothallazgositalco

                        var totacglobal = totac
                        var tothallazgosglobal = tothallazgositalco
                        var totaudi = arrayKpiIG.totauditorias

                        $('#cantAC').html(totacglobal)
                            //$('#cantCV').html(totconversatoriosglobal)
                        $('#cantCV').html(totconversatorios)

                        //$('#canthallazgos').html(tothallazgositalco)

                        $('#poraudi').html(totaudi)

                        

                        if(arrayKpiIG.sas == null){
                            var sas = ''
                        }else{
                            var sas = arrayKpiIG.sas 
                        }
                        $('#evasas').html(sas)


                    })
            }



            function obtenerKpiHorasCap() {
                $.post(server + 'buscarKpiHorasCap.php', {
                        ods: numods
                    },
                    function(resp) {

                        arrayHCap = resp

                        if (arrayHCap != null) {

                            for (var i = 0; i < arrayHCap.length; i++) {
                                if (arrayHCap[i].fase == 'FASE I') {
                                    hhfase1 = parseInt(arrayHCap[i].horas)
                                }
                                if (arrayHCap[i].fase == 'FASE II') {
                                    hhfase2 = parseInt(arrayHCap[i].horas)
                                }
                                if (arrayHCap[i].fase == 'FASE III') {
                                    hhfase3 = parseInt(arrayHCap[i].horas)
                                }
                            }

                        }

                    })
            }

            function obtenerKpiPermisos() {
                $.post(server + 'buscarKpiPermisos.php', {
                        ods: numods
                    },
                    function(resp) {

                        arrayPermisos = resp

                        totalPerFe = parseInt(arrayPermisos.frioe)
                        totalPerFr = parseInt(arrayPermisos.frior)
                        totalPerCe = parseInt(arrayPermisos.calientee)
                        totalPerCr = parseInt(arrayPermisos.calienter)
                        totalPerEe = parseInt(arrayPermisos.electricoe)
                        totalPerEr = parseInt(arrayPermisos.electricor)
                        totalPerE = parseInt(arrayPermisos.totale)
                        totalPerR = parseInt(arrayPermisos.totalr)
                        totalPerm = parseInt(arrayPermisos.totalm)
                        totalPerh = parseInt(arrayPermisos.totalh)


                    })
            }




            function obtenerdatosConversatorios() {
                //obtener conversatorios
                $.post(server + 'buscarConvesatorios.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {
                        var arrayConversatorios = resp
                        if (arrayConversatorios.length != null) {
                            var html = `
                <div class="table-responsive" style="background-color: white">
                    <table class="table table-striped" style="background-color: white;">
                        <thead class="thead-dark" >
                            <th>FECHA</th>
                            <th>TEMA</th>
                            <th>RESPONSABLE</th>
                        </thead>
                        <tbody>
                `

                            for (var i = 0; i < arrayConversatorios.length; i++) {
                                html += `
                        <tr>
                            <td>${arrayConversatorios[i].fecha}</td>
                            <td>${arrayConversatorios[i].tema}</td>
                            <td>${arrayConversatorios[i].resp}</td>
                        </tr>
                        
                    `
                            }
                            html += `
                        </tbody>
                    </table>
                </div>
                `
                            $('#detallesConversatorios').html(html)
                        }
                    })

            }

            function verTodosConversatorios() {
                //obtener conversatorios
                $.post(server + 'buscarConvesatoriosTodos.php', {
                        ods: numods
                    },
                    function(resp) {
                        var arrayConversatorios = resp
                        if (arrayConversatorios.length != null) {
                            var html = `
                <div class="table-responsive" style="background-color: white">
                    <table class="table table-striped" style="background-color: white;">
                        <thead class="thead-dark" >
                            <th>FECHA</th>
                            <th>TEMA</th>
                            <th>RESPONSABLE</th>
                        </thead>
                        <tbody>
                `

                            for (var i = 0; i < arrayConversatorios.length; i++) {
                                html += `
                        <tr>
                            <td>${arrayConversatorios[i].fecha}</td>
                            <td>${arrayConversatorios[i].tema}</td>
                            <td>${arrayConversatorios[i].resp}</td>
                        </tr>
                        
                    `
                            }
                            html += `
                        </tbody>
                    </table>
                </div>
                `
                            $('#detallesConversatorios').html(html)
                        }
                    })

            }

            function obtenerdatosAC() {
                $.post(server + 'bACtipiP.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {
                        console.log('resultado kpi AC')
                        console.log(resp)

                        if (resp != null) {
                            arrayDatos = resp.datos
                            arrayRiesgo = resp.acriesgo

                            if (arrayDatos != null) {

                                for (var i = 0; i < arrayDatos.length; i++) {
                                    if (arrayDatos[i].criticidad != 'N/A') {
                                        if (arrayDatos[i].tipificacion == 'Seguridad Industrial y de procesos') {
                                            cantacrtipsi++
                                        }
                                        if (arrayDatos[i].tipificacion == 'Medio Ambiente') {
                                            cantacrtipma++
                                        }
                                        if (arrayDatos[i].tipificacion == 'Salud Ocupacional') {
                                            cantacrtipso++
                                        }
                                        if (arrayDatos[i].tipificacion == 'Principios culturales') {
                                            cantacrtippc++
                                        }
                                        if (arrayDatos[i].criticidad == 'Baja') {
                                            cantacrbajo++
                                        }
                                        if (arrayDatos[i].criticidad == 'Media') {
                                            cantacrmedio++
                                        }
                                        if (arrayDatos[i].criticidad == 'Alta') {
                                            cantacralto++
                                        }
                                    } else {
                                        if (arrayDatos[i].tipificacion == 'Seguridad Industrial y de procesos') {
                                            cantacstipsi++
                                        }
                                        if (arrayDatos[i].tipificacion == 'Medio Ambiente') {
                                            cantacstipma++
                                        }
                                        if (arrayDatos[i].tipificacion == 'Salud Ocupacional') {
                                            cantacstipso++
                                        }
                                        if (arrayDatos[i].tipificacion == 'Principios culturales') {
                                            cantacstippc++
                                        }

                                    }
                                }
                            }


                            totacitalcobaja = arrayRiesgo.totacitalcobaja
                            totacitalcomedia = arrayRiesgo.totacitalcomedia
                            totacitalcoalta = arrayRiesgo.totacitalcoalta

                            totacitalcobajarep = arrayRiesgo.totacitalcobajarep
                        totacitalcomediarep = arrayRiesgo.totacitalcomediarep
                        totacitalcoaltarep = arrayRiesgo.totacitalcoaltarep

                        totacitalcobajarepec = arrayRiesgo.totacitalcobajarepec
                        totacitalcomediarepec = arrayRiesgo.totacitalcomediarepec
                        totacitalcoaltarepec = arrayRiesgo.totacitalcoaltarepec

                            totacitalcobajadia = arrayRiesgo.totacitalcobajadia
                            totacitalcomediadia = arrayRiesgo.totacitalcomediadia
                            totacitalcoaltadia = arrayRiesgo.totacitalcoaltadia
                        }



                    })
            }

            function obtenerKpiResiduos() {
                $.post(
                    server + "obtenerKpiResiduos.php", {
                        ods: numods
                    },
                    function(resp) {
                        arrayResiduos = resp;

                        if (arrayResiduos != null) {
                            for (var i = 0; i < arrayResiduos.length; i++) {
                                arrayResiduosTitulos.push(arrayResiduos[i].tipo)
                            }
                            for (var i = 0; i < arrayResiduos.length; i++) {
                                arrayResiduosCant.push(parseInt(arrayResiduos[i].cant))
                            }
                        }


                    }
                );
            }

            function verTodosHallazgos() {
                $.post(server + 'buscarHallazgosRes.php', {
                        ods: numods
                    },
                    function(resp) {
                        var arrayDetallesHallazgos = resp
                        if (arrayDetallesHallazgos.length != null) {
                            var html = `
                <div class="table-responsive" style="background-color: white">
                    <table class="table" style="width: 1200px;">
                        <thead class="thead-dark">
                            <th>Fecha</th>
                            <th>Item</th>
                            <th style="width: 300px;">Reporte</th>
                            <th>Nombre quien reporta</th>
                            <th>Criticidad</th>
                            <th>Tipificación</th>
                            <th>Plan de acción</th>
                            <th>Fecha de Cierre</th>
                            <th>Estado</th>
                        </thead>
                        <tbody>
                `

                            for (var i = 0; i < arrayDetallesHallazgos.length; i++) {
                                html += `
                        <tr>
                            <td>${arrayDetallesHallazgos[i].fecha}</td>
                            <td>${arrayDetallesHallazgos[i].item}</td>
                            <td>${arrayDetallesHallazgos[i].detalles}</td>
                            <td>${arrayDetallesHallazgos[i].reporta}</td>
                            <td>${arrayDetallesHallazgos[i].criticidad}</td>
                            <td>${arrayDetallesHallazgos[i].tipificacion}</td>
                            <td>${arrayDetallesHallazgos[i].plan}</td>
                            <td>${arrayDetallesHallazgos[i].fcierre}</td>
                            <td>${arrayDetallesHallazgos[i].estado}</td>
                        </tr>
                    `
                            }

                            html += `
                        </tbody>
                    </table>
                </div>
                `
                            $('#detallesHallazgostabla').html(html)

                        }
                    })
            }

            function detallesHallazgos() {
                $.post(server + 'buscarHallazgos.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {
                        arrayDetallesHallazgos = resp
                        if (arrayDetallesHallazgos != null) {
                            var html = `
                <div class="table-responsive" style="background-color: white">
                    <table class="table" style="width: 1200px;">
                        <thead class="thead-dark">
                            <th>Fecha</th>
                            <th>Item</th>
                            <th style="width: 300px;">Reporte</th>
                            <th>Nombre quien reporta</th>
                            <th>Criticidad</th>
                            <th>Tipificación</th>
                            <th>Plan de acción</th>
                            <th>Fecha de Cierre</th>
                            <th>Estado</th>
                        </thead>
                        <tbody>
                `

                            for (var i = 0; i < arrayDetallesHallazgos.length; i++) {
                                html += `
                        <tr>
                            <td>${arrayDetallesHallazgos[i].fecha}</td>
                            <td>${arrayDetallesHallazgos[i].item}</td>
                            <td>${arrayDetallesHallazgos[i].detalles}</td>
                            <td>${arrayDetallesHallazgos[i].reporta}</td>
                            <td>${arrayDetallesHallazgos[i].criticidad}</td>
                            <td>${arrayDetallesHallazgos[i].tipificacion}</td>
                            <td>${arrayDetallesHallazgos[i].plan}</td>
                            <td>${arrayDetallesHallazgos[i].fcierre}</td>
                            <td>${arrayDetallesHallazgos[i].estado}</td>
                        </tr>
                    `
                            }
                            html += `
                        </tbody>
                    </table>
                </div>
                `
                            $('#detallesHallazgostabla').html(html)


                        }


                    })
            }

            function buscarHallazgos() {
                $.post(server + 'buscarHallazgosDiaP.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {

                        var fotosacr = ''

                        var arrayDetallesHallazgos = resp;

                        if (arrayDetallesHallazgos != null) {

                            var html = `
                 
                            <div class="card-header mb-2">
                                <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseHallazgos" aria-expanded="false" aria-controls="collapseHallazgos">
                                    <i class="fas fa-arrow-circle-down"></i>
                                </button>
                                HALLAZGOS
                            </div>

                            <div class="collapse" id="collapseHallazgos">
                            <div class="card card-body">
                                <div style="width: 100%; height: auto;">
                                    <table class="table">
                                    <thead class="thead-dark">
                                        <th>Fecha</th>
                                        <th>Item</th>
                                        <th style="width: 300px;">Reporte</th>
                                        <th>Nombre quien reporta</th>
                                        <th>Criticidad</th>
                                        <th>Tipificación</th>
                                        <th>Plan de acción</th>
                                        <th>Fecha de Cierre</th>
                                        <th>Estado</th>
                                    </thead>
                                    <tbody>
                        `

                            for (var i = 0; i < arrayDetallesHallazgos.length; i++) {
                                html += `
                                    <tr>
                                        <td>${arrayDetallesHallazgos[i].fecha}</td>
                                        <td>${arrayDetallesHallazgos[i].item}</td>
                                        <td>${arrayDetallesHallazgos[i].detalles}</td>
                                        <td>${arrayDetallesHallazgos[i].reporta}</td>
                                        <td>${arrayDetallesHallazgos[i].criticidad}</td>
                                        <td>${arrayDetallesHallazgos[i].tipificacion}</td>
                                        <td>${arrayDetallesHallazgos[i].plan}</td>
                                        <td>${arrayDetallesHallazgos[i].fcierre}</td>
                                        <td>${arrayDetallesHallazgos[i].estado}</td>
                                    </tr>
                                `;
                            }

                            html += `
                        </tbody>
                    </table>
                    </div>
                 </div></div>
                `
                            $('#dethallazgos').html(html)

                        }

                    })
            }

            function detallesACSeguros() {
                $.post(server + 'buscarACSegurosDiaParada.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {
                        console.log('Detalles AC SEguros dia')
                        console.log(resp)
                        arrayDetallesACS = resp

                        if (arrayDetallesACS != null) {

                            var html = `
                 
                <div class="card-header mb-2">
                    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseACRelevantes" aria-expanded="false" aria-controls="collapseACRelevantes">
                        <i class="fas fa-arrow-circle-down"></i>
                    </button>
                    ASEGURAMIENTO DE COMPORTAMIENTOS SEGUROS RELEVANTES
                </div>

                <div class="collapse" id="collapseACRelevantes">
                <div class="card card-body">
                    <div style="width: 100%; height: auto;">
                    <table class="table" style="width: 100%;">
                        <thead class="thead-dark">
                            <th>Fecha Reporte</th>
                            <th>Fecha Evento</th>
                            <th>Nombre quien reporta</th>
                            <th style="width: 300px;">Reporte</th>
                            <th>Tipificación</th>
                        </thead>
                        <tbody>
                `

                            for (var i = 0; i < arrayDetallesACS.length; i++) {
                                html += `
                            <tr>
                                <td>${arrayDetallesACS[i].fecharep}</td>
                                <td>${arrayDetallesACS[i].fechaevento}</td>
                                <td>${arrayDetallesACS[i].reporta} - ${arrayDetallesACS[i].ods}</td>
                                <td>${arrayDetallesACS[i].detalles}</td>
                                <td>${arrayDetallesACS[i].tipificacion}</td>
                            </tr>
                        `
                            }

                            html += `
                        </tbody>
                    </table>
                    </div>
                 </div></div>
                `
                            $('#detacseguros').html(html)

                        }

                    })
            }

            function detallesTodosACSeguros() {
                $.post(server + 'buscarACSegurosTodos.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {
                        console.log('Detalles AC SEguros dia')
                        console.log(resp)
                        arrayDetallesACS = resp
                        if (arrayDetallesACS.length != null) {
                            var html = `
                <div class="table-responsive" style="background-color: white">
                    <table class="table" style="width: 1200px;">
                        <thead class="thead-dark">
                            <th>Fecha Reporte</th>
                            <th>Fecha Evento</th>
                            <th>Nombre quien reporta</th>
                            <th style="width: 300px;">Reporte</th>
                            <th>Tipificación</th>
                        </thead>
                        <tbody>
                `

                            for (var i = 0; i < arrayDetallesACS.length; i++) {
                                html += `
                        <tr>
                            <td>${arrayDetallesACS[i].fecharep}</td>
                            <td>${arrayDetallesACS[i].fechaevento}</td>
                            <td>${arrayDetallesACS[i].reporta}</td>
                            <td>${arrayDetallesACS[i].detalles}</td>
                            <td>${arrayDetallesACS[i].tipificacion}</td>
                        </tr>
                    `
                            }
                            html += `
                        </tbody>
                    </table>
                </div>
                `
                            $('#detacseguros').html(html)

                        }

                    })
            }

            function planesAC() {
                window.open("planesAC.html?ods=" + numods, "_blank");
            }

            function segurosAC() {
                window.open("segurossAC.html?ods=" + numods + '&fecha=' + fecha, "_blank");
            }

            function detallesACRiesgo() {
                $.post(server + 'buscarACRiesgoDiaParada.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {

                        console.log('Detalles AC Riesgo dia')
                        console.log(resp)
                        arrayDetallesACR = resp
                        var fotosacr = ''
                        if (arrayDetallesACR != null) {
                            var html = `
                <h1 class="salto"></h1>
                <div class="card-header mb-2">
                    
                    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseACRiesgo" aria-expanded="false" aria-controls="collapseACRiesgo">
                        <i class="fas fa-arrow-circle-down"></i>
                    </button>

                    ASEGURAMIENTO DE COMPORTAMIENTOS EN RIESGO 
                    <button type="button" class="btn btn-warning" onclick="planesAC()">
                        Planes de acción AC
                    </button>
                    
                </div>
                
                <div class="collapse" id="collapseACRiesgo">
                <div class="card card-body">
                <div style="width: 100%; height: auto;">
                    <table class="table table-striped" style="background-color: white; width: 100%;">
                        <tbody>
                `

                            for (var i = 0; i < arrayDetallesACR.length; i++) {
                                if (arrayDetallesACR[i].fcierre != '') {
                                    var colorcelda = '#33FF6B';
                                    var colorcelda2 = '#FFF';
                                } else {
                                    var colorcelda = '#FFF';
                                    var colorcelda2 = '#FF8585';
                                }
                                html += `

                    <tr style="background-color: ${colorcelda2}">
                        <th>FECHA REPORTE</th>
                        <td>${arrayDetallesACR[i].fecharep}</td>

                        <th>ODS</th>
                        <td>${arrayDetallesACR[i].ods}</td>
                    </tr>
                    <tr>
                        <th>FECHA EVENTO</th>
                        <td>${arrayDetallesACR[i].fechaevento}</td>
                    </tr>
                    <tr>
                        <th>REPORTADO POR</th>
                        <td>${arrayDetallesACR[i].reporta}</td>
                    </tr>
                    <tr>
                        <th>REPORTE</th>
                         
                        <td width="800">
                            ${arrayDetallesACR[i].detalles}
                        </td>
                    </tr>
                    <tr>
                        <th>TIPIFICACIÓN</th>
                        <td>${arrayDetallesACR[i].tipificacion}</td>
                    </tr>
                    <tr>
                        <th>CRITICIDAD</th>
                        <td>${arrayDetallesACR[i].criticidad}</td>
                    </tr>
                    
                    <tr>
                        <th>NIVEL 1</th>
                        <td>${arrayDetallesACR[i].nivel1}</td>
                    </tr>
                    <tr>
                        <th>NIVEL 2</th>
                        <td>${arrayDetallesACR[i].nivel2}</td>
                    </tr> 
                    <tr>
                        <th>PLAN</th>
                        <td>${arrayDetallesACR[i].plan}</td>
                    </tr> 
                    <tr style="background-color: ${colorcelda}" >
                        <th>FECHA CIERRE</th>
                        <td>${arrayDetallesACR[i].fcierre}</td>
                    </tr> 
                    <tr>
                        <td colspan="2"><hr></td>
                    </tr>

                    `
                            }
                            html += `
                        </tbody>
                    </table>
                    
                        </div>
                    </div>
                </div>
                `
                            $('#acriesgos').html(html)


                        }

                    })
            }

            function detallesTodosACRiesgos() {
                $.post(server + 'buscarACRiesgoDiaTodos.php', {
                        ods: numods,
                        fecha: fecha
                    },
                    function(resp) {
                        console.log('Detalles AC Riesgo dia')
                        console.log(resp)
                        arrayDetallesACR = resp
                        if (arrayDetallesACR.length != null) {
                            var html = `
                <div class="table-responsive" style="background-color: white">
                    <table class="table" style="width: 1200px;">
                        <thead class="thead-dark">
                            <th>Fecha Reporte</th>
                            <th>Fecha Evento</th>
                            <th>Nombre quien reporta</th>
                            <th style="width: 300px;">Reporte</th>
                            <th>Tipificación</th>
                            <th>Criticidad</th>
                            <th>Nivel 1</th>
                            <th>Nivel 2</th>
                            <th>Plan</th>
                            <th>Fecha Cierre</th>

                        </thead>
                        <tbody>
                `

                            for (var i = 0; i < arrayDetallesACR.length; i++) {
                                html += `
                        <tr>
                            <td>${arrayDetallesACR[i].fecharep}</td>
                            <td>${arrayDetallesACR[i].fechaevento}</td>
                            <td>${arrayDetallesACR[i].reporta}</td>
                            <td>${arrayDetallesACR[i].detalles}</td>
                            <td>${arrayDetallesACR[i].tipificacion}</td>
                            <td>${arrayDetallesACR[i].criticidad}</td>
                            <td>${arrayDetallesACR[i].nivel1}</td>
                            <td>${arrayDetallesACR[i].nivel2}</td>
                            <td>${arrayDetallesACR[i].plan}</td>
                            <td>${arrayDetallesACR[i].fcierre}</td>
                        </tr>
                    `
                            }
                            html += `
                        </tbody>
                    </table>
                </div>
                `
                            $('#detacriesgo').html(html)

                        }

                    })
            }

            function cargarGraficas() {



                Highcharts.chart('fighcap', {
                    colors: ['#01005e', '#00c901', '#537b35', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#a4c639',
                        '#537b35'
                    ],
                    credits: {
                        enabled: false
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: '<b>HORAS CAPACITACIÓN</b>'
                    },

                    xAxis: {
                        categories: ['CANT'],
                        crosshair: true
                    },

                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Cant'
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    series: [{
                        name: 'INST. INICIO DE TURNO',
                        data: [arrayPersonal.hcap]
                    }, {
                        name: 'FASE I',
                        data: [arrayPersonal.fase1]
                    }, {
                        name: 'FASE II',
                        data: [arrayPersonal.fase2]
                    }, {
                        name: 'FASE III',
                        data: [arrayPersonal.fase3]
                    }, {
                        name: 'TOTAL',
                        data: [arrayPersonal.hcap + arrayPersonal.fase3 + arrayPersonal.fase2 + arrayPersonal.fase1]
                    }]
                });



                //grafica totales ac cliente e italco
                Highcharts.chart('figactot', {
                    colors: ['#01005e', '#00c901', '#efd520', '#537b35', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                    credits: {
                        enabled: false
                    },
                    chart: {
                        type: 'column',
                        height: '300'
                    },
                    title: {
                        text: '<b>TOTALES AC </b>'
                    },

                    xAxis: {
                        categories: [
                            'Día', 'Acumulado'
                        ],
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Cant '
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    series: [{
                        name: 'ITALCO',
                        data: [totacitalcodia, totacitalco]

                    }, {
                        name: 'CLIENTE',
                        data: [totacclientedia, totaccliente]
                    }, {
                        name: 'TOTAL',
                        data: [totacdia, totac]
                    }]
                });

                //tipificacion ac en riesgo N1 Seguridad Industrial
                Highcharts.chart('figtipacrsi', {
                    colors: ['#01005e', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                    credits: {
                        enabled: false
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: '<b>TIPIFICACIÓN NIVEL 1 SEGURIDAD INDUSTRIAL </b>'
                    },

                    xAxis: {
                        categories: [
                            'CANT'
                        ],
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Cant'
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    series: arrayTitulosSI
                });

                //tipificacion ac en riesgo N2 Seguridad Industrial
                Highcharts.chart('figtipacrsi2', {
                    colors: ['#01005e', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                    credits: {
                        enabled: false
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: '<b>TIPIFICACIÓN NIVEL 2 SEGURIDAD INDUSTRIAL </b>'
                    },

                    xAxis: {
                        categories: [
                            'CANT'
                        ],
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Cant'
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    series: arrayTitulosSI2
                });

                //tipificacion ac en riesgo N1 Medio Ambiente
                Highcharts.chart('figtipacrma', {
                    colors: ['#01005e', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                    credits: {
                        enabled: false
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: '<b>TIPIFICACIÓN NIVEL 1 MEDIO AMBIENTE </b>'
                    },

                    xAxis: {
                        categories: [
                            'CANT'
                        ],
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Cant'
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    series: arrayTitulosMA
                });

                //tipificacion ac en riesgo N2 Medio Ambiente
                Highcharts.chart('figtipacrma2', {
                    colors: ['#01005e', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                    credits: {
                        enabled: false
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: '<b>TIPIFICACIÓN NIVEL 2 MEDIO AMBIENTE </b>'
                    },

                    xAxis: {
                        categories: [
                            'CANT'
                        ],
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Cant'
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    series: arrayTitulosMA2
                });

                //tipificacion ac en riesgo N1 Salud Ocupacional
                Highcharts.chart('figtipacrso', {
                    colors: ['#01005e', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                    credits: {
                        enabled: false
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: '<b>TIPIFICACIÓN NIVEL 1 SALUD OCUPACIONAL </b>'
                    },

                    xAxis: {
                        categories: [
                            'CANT'
                        ],
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Cant'
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    series: arrayTitulosSO
                });

                //tipificacion ac en riesgo N2 Salud Ocupacional
                Highcharts.chart('figtipacrso2', {
                    colors: ['#01005e', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                    credits: {
                        enabled: false
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: '<b>TIPIFICACIÓN NIVEL 2 SALUD OCUPACIONAL </b>'
                    },

                    xAxis: {
                        categories: [
                            'CANT'
                        ],
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Cant'
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    series: arrayTitulosSO2
                });

                //tipificacion ac en riesgo N1 Principios culturales
                Highcharts.chart('figtipacrpc', {
                    colors: ['#01005e', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                    credits: {
                        enabled: false
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: '<b>TIPIFICACIÓN NIVEL 1 PRINCIPIOS CULTURALES </b>'
                    },

                    xAxis: {
                        categories: [
                            'CANT'
                        ],
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Cant '
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    series: arrayTitulosPC
                });

                Highcharts.chart("figconsresi", {
                    colors: [
                        "#01005e",
                        "#00c901",
                        "#efd520",
                        "#bfbfbf",
                        "#537b35",
                        "#a4c639",
                        "#537b35",
                        "#a4c639",
                        "#537b35",
                    ],
                    credits: {
                        enabled: false,
                    },
                    chart: {
                        type: "column",
                    },
                    title: {
                        text: null,
                    },

                    xAxis: {
                        categories: arrayResiduosTitulos,
                        crosshair: true,
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: "Cant ",
                        },
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: "</table>",
                        shared: true,
                        useHTML: true,
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                            },
                        },
                    },

                    series: [{
                        name: 'Cant',
                        data: arrayResiduosCant
                    }]
                });


                Highcharts.chart("figconsinsp", {
                    colors: [
                        "#01005e",
                        "#00c901",
                        "#efd520",
                        "#bfbfbf",
                        "#537b35",
                        "#a4c639",
                        "#537b35",
                        "#a4c639",
                        "#537b35",
                    ],
                    credits: {
                        enabled: false,
                    },
                    chart: {
                        type: "column",
                    },
                    title: {
                        text: "<b>CONSOLIDADO INSPECCIONES</b>",
                    },

                    xAxis: {
                        categories: arrayConsInspGTit,
                        crosshair: true,
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: "Cant ",
                        },
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: "</table>",
                        shared: true,
                        useHTML: true,
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                            },
                        },
                    },

                    series: [{
                        name: "Cantidad",
                        data: arrayConsInspGCant,
                    }],
                });


                //tipificacion ac en riesgo N2 Principios culturales
                Highcharts.chart('figtipacrpc2', {
                    colors: ['#01005e', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                    credits: {
                        enabled: false
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: '<b>TIPIFICACIÓN NIVEL 2 PRINCIPIOS CULTURALES </b>'
                    },

                    xAxis: {
                        categories: [
                            'CANT'
                        ],
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Cant '
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    series: arrayTitulosPC2
                });




                Highcharts.chart('figactipi', {
                    colors: ['#01005e', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                    credits: {
                        enabled: false
                    },
                    chart: {
                        type: 'column',
                        height: '200'
                    },
                    title: {
                        text: '<b>TIPIFICACIÓN AC</b>'
                    },

                    xAxis: {
                        categories: [
                            'MEDIO AMBIENTE',
                            'SEGURIDAD INDUSTRIAL',
                            'SALUD OCUPACIONAL',
                            'PRINCIPIOS CULTURALES'
                        ],
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Cant '
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    series: [{
                        name: 'SEGUROS',
                        data: [cantacstipma, cantacstipsi, cantacstipso, cantacstippc]

                    }, {
                        name: 'EN RIESGO',
                        data: [cantacrtipma, cantacrtipsi, cantacrtipso, cantacrtippc]
                    }]
                });

                Highcharts.chart('figacriesgoitalco', {
                    colors: ['#00c901', '#01005e', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                    credits: {
                        enabled: false
                    },
                    chart: {
                        type: 'column',
                        height: '300'
                    },
                    title: {
                        text: '<b>AC EN RIESGO ITALCO</b>'
                    },

                    xAxis: {
                        categories: [
                            'DÍA',
                            'ACUMULADO'
                        ],
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Cant '
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    series: [{
                        name: 'BAJA',
                        data: [totacitalcobajadia, totacitalcobaja]

                    }, {
                        name: 'MEDIA',
                        data: [totacitalcomediadia, totacitalcomedia]

                    }, {
                        name: 'ALTA',
                        data: [totacitalcoaltadia, totacitalcoalta]

                    }]
                });

                Highcharts.chart('figacriesgoitalco2', {
                    colors: ['#00c901', '#01005e', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                    credits: {
                        enabled: false
                    },
                    chart: {
                        type: 'column',
                        height: '300'
                    },
                    title: {
                        text: '<b>AC EN RIESGO</b>'
                    },

                    xAxis: {
                        categories: [
                            'REP ITALCO',
                            'REP ECOPETROL'
                        ],
                        crosshair: true
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Cant '
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    series: [{
                        name: 'BAJA',
                        data: [totacitalcobajarep, totacitalcobajarepec]

                    }, {
                        name: 'MEDIA',
                        data: [totacitalcomediarep, totacitalcomediarepec]

                    }, {
                        name: 'ALTA',
                        data: [totacitalcoaltarep, totacitalcoaltarepec]

                    }]
                });


                //grafica consolidado cronograma ac
                var chart9 = Highcharts.chart("figcronoac", {
                    colors: [
                        "#01005e",
                        "#00c901",
                        "#efd520",
                        "#bfbfbf",
                        "#537b35",
                        "#a4c639",
                        "#537b35",
                        "#a4c639",
                        "#537b35",
                    ],
                    credits: {
                        enabled: false,
                    },
                    chart: {
                        type: "column",
                    },
                    title: {
                        text: null,
                    },

                    xAxis: {
                        categories: arrayConsACGTit,
                        crosshair: true,
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: "Cant ",
                        },
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: "</table>",
                        shared: true,
                        useHTML: true,
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                            },
                        },
                    },

                    series: [{
                        name: "PLANEADO",
                        data: arrayConsACGPlan,
                    }, {
                        name: "EJECUTADO",
                        data: arrayConsACGEje,
                    }, {
                        name: "%Cump",
                        data: arrayConsACGCump,
                    }, ],
                });



                // Highcharts.chart("figalturas", {
                //     colors: [
                //         "#01005e",
                //         "#00c901",
                //         "#efd520",
                //         "#bfbfbf",
                //         "#537b35",
                //         "#a4c639",
                //         "#537b35",
                //         "#a4c639",
                //         "#537b35",
                //     ],
                //     credits: {
                //         enabled: false,
                //     },
                //     chart: {
                //         type: "column",
                //     },
                //     title: {
                //         text: 'CONSOLIDADO DE CERTIFICADOS DE ALTURAS',
                //     },

                //     xAxis: {
                //         categories: ['PERSONAL'],
                //         crosshair: true,
                //     },
                //     yAxis: {
                //         min: 0,
                //         title: {
                //             text: "Cant ",
                //         },
                //     },
                //     tooltip: {
                //         headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                //         pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                //             '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                //         footerFormat: "</table>",
                //         shared: true,
                //         useHTML: true,
                //     },
                //     plotOptions: {
                //         column: {
                //             pointPadding: 0.2,
                //             borderWidth: 0,
                //             dataLabels: {
                //                 enabled: true,
                //             },
                //         },
                //     },
                //     series: [{
                //         name: "VIGENTES",
                //         data: [arrayAlturas.cantvig],
                //     }, {
                //         name: "VENCIDOS",
                //         data: [arrayAlturas.cantvencido],
                //     }, {
                //         name: "POR VENCER",
                //         data: [arrayAlturas.cantxvencer],
                //     }, {
                //         name: "NO APLICA",
                //         data: [arrayAlturas.cantna],
                //     }],
                // });



                //PERSONAL POR TURNOS

                Highcharts.chart("figpersturnos", {
                    colors: [
                        "#01005e",
                        "#00c901",
                        "#efd520",
                        "#bfbfbf",
                        "#537b35",
                        "#a4c639",
                        "#537b35",
                        "#a4c639",
                        "#537b35",
                    ],
                    credits: {
                        enabled: false,
                    },
                    chart: {
                        type: "column",
                    },
                    title: {
                        text: "<b>PERSONAL POR FRENTES DIA</b>",
                    },

                    xAxis: {
                        categories: arrayFrentesTit,
                        crosshair: true,
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: "Cant ",
                        },
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: "</table>",
                        shared: true,
                        useHTML: true,
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                            },
                        },
                    },

                    series: [{
                        name: "DIRECTOS",
                        data: arrayFrentesDir,
                    }, {
                        name: "INDIRECTOS",
                        data: arrayFrentesIndir,
                    }, {
                        name: "TOTAL",
                        data: arrayFrentesTot,
                    }],
                });





                 //PERSONAL POR PLATA

            Highcharts.chart("figpersplanta", {
                colors: [
                    "#01005e",
                    "#00c901",
                    "#efd520",
                    "#bfbfbf",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",
                },
                title: {
                    text: null,
                },

                xAxis: {
                    categories: arrayPlantas,
                    crosshair: true,
                },
                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant ",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                    name: "DIRECTOS",
                    data: arrayPDirecto,
                }, {
                    name: "INDIRECTOS",
                    data: arrayPIndirecto,
                }, {
                    name: "TOTAL",
                    data: arrayPtot,
                }, ],
            });

            //PERSONAL POR HHT
            Highcharts.chart("figpershht", {
                colors: [
                    "#01005e",
                    "#00c901",
                    "#efd520",
                    "#bfbfbf",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",
                },
                title: {
                    text: null,
                },

                xAxis: {
                    categories: arrayPlantas,
                    crosshair: true,
                },
                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant ",
                    },
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                    name: "DIRECTOS",
                    data: arrayHDirecto,
                }, {
                    name: "INDIRECTOS",
                    data: arrayHIndirecto,
                }, {
                    name: "TOTAL",
                    data: arrayHtot,
                }, ],
            });

            //PERSONAL HHT ACUMNULADO
            Highcharts.chart("figacumhht", {
                colors: [
                    "#01005e",
                    "#00c901",
                    "#efd520",
                    "#bfbfbf",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                    "#a4c639",
                    "#537b35",
                ],
                credits: {
                    enabled: false,
                },
                chart: {
                    type: "column",

                },
                title: {
                    text: null,
                },

                xAxis: {
                    categories: ['TOTALES'],
                    crosshair: true,
                },
                yAxis: {
                    min: 0,
                    title: {
                        text: "Cant ",
                    },
                    stackLabels: {
                        enabled: true,
                        style: {
                            fontFamily: 'Lucida Grande',
                            fontWeight: 'bold',
                            fontSize: '24px'
                        }

                    }
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                        '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                    footerFormat: "</table>",
                    shared: true,
                    useHTML: true,
                },
                plotOptions: {
                    column: {
                        pointPadding: 0.2,
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                        },
                    },
                },
                series: [{
                    name: "DIRECTOS",
                    data: [arrayPersonal.acumHDirectos],
                }, {
                    name: "INDIRECTOS",
                    data: [arrayPersonal.acumHIndirectos],
                }, {
                    name: "TOTAL",
                    data: [arrayPersonal.acumHHTotal],
                }, ],
            });


            // FIN PERSONAL
               


                Highcharts.chart("figconsaudi", {
                    colors: [
                        "#01005e",
                        "#00c901",
                        "#efd520",
                        "#bfbfbf",
                        "#537b35",
                        "#a4c639",
                        "#537b35",
                        "#a4c639",
                        "#537b35",
                    ],
                    credits: {
                        enabled: false,
                    },
                    chart: {
                        type: "column",
                    },
                    title: {
                        text: "<b>CONSOLIDADO AUDITORIAS</b>",
                    },

                    xAxis: {
                        categories: arrayConsAudiGTit,
                        crosshair: true,
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: "Cant ",
                        },
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                        footerFormat: "</table>",
                        shared: true,
                        useHTML: true,
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                            },
                        },
                    },

                    series: [{
                        name: "Planeado",
                        data: arrayConsAudiGPlan,
                    }, {
                        name: "Ejecutado",
                        data: arrayConsAudiGEje,
                    }],
                });


                if (arrayPprevalidados.length > 0) {
                    Highcharts.chart('figpermisos', {
                        colors: ['#01005e', '#00c901', '#efd520', '#bfbfbf', '#537b35', '#a4c639', '#537b35', '#a4c639', '#537b35'],
                        credits: {
                            enabled: false
                        },
                        chart: {
                            type: 'column'
                        },
                        title: {
                            text: '<b>CONTROL DE PERMISOS DIARIOS</b>'
                        },

                        xAxis: {
                            categories: arrayTurnos,
                            crosshair: true
                        },

                        yAxis: {
                            min: 0,
                            title: {
                                text: 'Cant'
                            }
                        },
                        tooltip: {
                            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                                '<td style="padding:0"><b>{point.y:f}</b></td></tr>',
                            footerFormat: '</table>',
                            shared: true,
                            useHTML: true
                        },
                        plotOptions: {
                            column: {
                                pointPadding: 0.2,
                                borderWidth: 0,
                                dataLabels: {
                                    enabled: true
                                }
                            }
                        },
                        series: [{
                            name: 'P. NUEVOS',
                            data: arrayPpnuevos
                        }, {
                            name: 'P. REVALIDADOS',
                            data: arrayPprevalidados
                        }, {
                            name: 'P. CERRADOS',
                            data: arrayPpcerrados
                        }]
                    });

                }





            }

            function verRepRiesgo() {
                $('#flotanteEnRiesgo').removeClass('oculto');
                $('#flotanteEnRiesgo').removeClass('magictime spaceOutDown');
            }

            function verRepSeguro() {
                $('#flotanteSeguros').removeClass('oculto');
                $('#flotanteSeguros').removeClass('magictime spaceOutDown');
            }




            // cargarGraficas()
            // imprimir()

            var realizado = 0;
            var printContent = ''
            var printWindow = ''


            function verAuditorias() {
                window.open("planesAuditorias.html?ods=" + numods, "_blank");
            }



            function imprimirHoja() {
                window.print();
            }
        </script>
</body>

</html>